(()=>{var qe=Object.defineProperty;var o=(s,r)=>qe(s,"name",{value:r,configurable:!0});(globalThis.webpackChunkwebapp=globalThis.webpackChunkwebapp||[]).push([["rollup-secondary_a_required","TS.enterprise","TS.utility"],{9300289889:()=>{(function(){TS.registerModule("api",{})})()},4706726993:()=>{(function(){TS.registerModule("automount",{onStart:function(){var s=TS.redux.getStoreInstance();setTimeout(()=>{TS.interop.automount.mountAllWithStore(s)},0)}})})()},9331508771:()=>{(function(){TS.registerModule("bots",{legacyEnsureBotsInDataArePresent:function(s){var r=TS.interop.utility.extractAllBotIds(s);return TS.interop.bots.ensureBotsArePresent(r)}})})()},2442635577:()=>{(function(){TS.registerModule("click",{onStart:function(){i(),r()},addHandler:function(a,d,m){_.isFunction(a)&&(m=d,d=a,a=null),s.push({selector:a,fn:d,prevent_on_drag:m||!1})},test:function(){return{addAll:r,setupBinding:i,handlers:function(){return s},resetHandlers:function(){s=[]},unbind:function(){$("body").off("click.ts_dot_click"),$("body").off("mousedown.ts_dot_click_mousedown")}}}});var s=[],r=o(function(){TS.click.addHandler(".inline_attachment.clickable, .inline_attachment.clickable + .reply_broadcast_rule",function(a,d){var m=["a",".media_caret",".msg_inline_video_buttons_div"].join(",");if(!$(a.target).closest(m).length){var u;d.is(".reply_broadcast")||d.closest(".reply_broadcast_rule").length?u=d.closest(".message_body").find('[data-action="open_conversation"]'):u=d.find(".attachment_from_url_link"),u[0]&&u[0].click()}},!0)},"_addAll"),i=o(function(){var a={};$("body").on("mousedown.ts_dot_click_mousedown",function(d){a.x=d.clientX,a.y=d.clientY}),$("body").on("click.ts_dot_click",function(d){if(!d.isDefaultPrevented()){var m=$(d.target);if(!(m.parents("[data-reactroot]").length||m.parents(".ReactModalPortal").length)){for(var u=t(d),f,p,S=0;S<s.length;S+=1)if(f=s[S],p=null,!(f.prevent_on_drag&&(d.clientX!=a.x||d.clientY!=a.y))){if(f.selector){if(p=m.closest(f.selector),!p.length)continue;f.fn(d,p,u),d.isDefaultPrevented()&&TS.has_pri[n]&&TS.log(n,`click on ${f.selector}`)}else f.fn(d,u);if(d.isDefaultPrevented())return}}}})},"_setupBinding"),t=o(function(a){var d=$(a.target);if(d.closest("#member_stars_list").length)return"starred_items";if(d.closest("#member_mentions").length)return"mentions";if(d.closest("#file_list").length)return"file_list";if(d.closest("#file_preview_scroller").length)return"file_preview";if(d.closest("#member_preview_scroller").length)return"member_preview";if(d.closest("#convo_scroller").length)return"conversation";if(d.closest("#groups_tab").length)return"groups";if(d.closest("#threads_msgs_scroller_div").length)return"threads";if(d.closest("#channel_page_scroller").length){var m=TS.shared.legacyGetActiveModelOb(),u="channel_page";return m.is_group&&!m.is_mpim?u="group_page":(m.is_im||m.is_mpim)&&(u="im_page"),u}return null},"_getPreviewOrigin"),n=2003})()},4260148387:()=>{(function(){TS.registerModule("compression",{compress:function(d,m,u,f){var p=Date.now();if(u){var S=LZString.compress(m),v=Date.now()-p;return TS.has_pri[a]&&TS.log(a,`${d} took ${v}ms to _compress immediately str.length: ${m.length}`),f({k:d,str:S})}t(d,m,function(P,C){var D=Date.now()-p;TS.has_pri[a]&&TS.log(a,`${d} took ${D}ms for the compression worker to callback (${C}ms spent within the worker) result.length: ${P.length}`),f({k:d,str:P})})},terminate:function(){s&&s.terminate(),s=null}});var s=null,r=0,i={},t=o(function(d,m,u){s||n(),r+=1;var f=`job_key${r}`;i[f]=function(p,S){u(p,S),delete i[f]},s.postMessage({request:"compress",input:m,job_key:f,k:d})},"_doCompressionJob"),n=o(function(){if(s){TS.error("_makeWorker but there is a _worker");return}var d=_.get(TS,"boot_data.vvv_paths.lz_string","/js/libs/lz-string-1.4.4.js"),m=TS.environment.is_dev;(TS.qs_args.local_assets||m)&&d.indexOf("http")!==0&&(d=`${location.protocol}//${location.host}${d}`),s=TS.utility.makeWebWorker(`function() {			self.importScripts('${d}');			self.onmessage = function(e) {				var start = Date.now();				var result;				if (e.data.request === 'compress') {					result = LZString.compress(e.data.input)				}				var elapsed = Date.now() - start;				postMessage({					request: e.data.request,					result: result,					job_key: e.data.job_key,					k: e.data.k,					elapsed: elapsed				});			}		}`,function(u){var f=i[u.data.job_key];if(!f){TS.error(`e.data.job_key:${u.data.job_key} had no record in _callbacks??`);return}f(u.data.result,u.data.elapsed)})},"_makeWorker"),a=488})()},6940318340:()=>{(function(){TS.registerModule("enterprise",{})})()},8377622078:()=>{(function(){TS.registerModule("enterprise.workspaces",{onStart:function(){},showRequestDialog:function(){let{displayModernToast:s=_.noop}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var r="#generic_dialog",i=".dialog_go",t="enterprise.teams.creationrequests.create",n="#input_ws_team_name",a="#textarea_ws_team_message",d,m;function u(){var f=$(r),p=f.find(i);return d&&m?(p.removeAttr("disabled"),!0):(p.attr("disabled",!0),!1)}o(u,"checkForm"),TS.generic_dialog.start({title:TS.interop.i18n.t("Request creation of a new workspace","enterprise_workspaces")(),body:TS.templates.ws_request_dialog(),show_cancel_button:!0,show_go_button:!0,go_button_text:TS.interop.i18n.t("Send Request","enterprise_workspaces")(),onGo:function(){var f=$(r),p=$(n),S=_.escape(p.val()),v=$(a),P=v.val(),C=f.find(i);C.addClass("ladda-button"),C.attr("data-style","expand-right");var D=Ladda.create(C[0]);D.start();var O={name:_.unescape(S),reason:P};return TS.boot_data.app==="client"&&(O.enterprise_token=TS.model.enterprise_api_token),TS.interop.api.callExpedited(t,O).then(function(){s({type:"success",teamName:S}),TS.generic_dialog.end(),TS.generic_dialog.cancel()}).catch(function(Q){if(!Q||!Q.data){TS.error(`WTF: error, but no response or data on ${t}?`,Q);return}var Y=Q.data;s({type:"error",errorType:Y.error,teamName:S}),TS.error(`${t} failed with error: ${Y.error||"undefined"}`),D.stop()}),!1}}),$(n).on("keyup change",function(){d=TS.ui.validation.validate($(n)),u()}),$(a).on("keyup change",function(){m=TS.ui.validation.validate($(a)),u()}),$(n).focus(),$(r).find(i).attr("disabled",!0)}})})()},2769613328:()=>{(function(){TS.registerModule("ims",{onStart:function(){TS.prefs.display_real_names_override_changed_sig.add(i),TS.prefs.team_display_real_names_changed_sig.add(i),TS.members.changed_profile_sig.add(r)},getDisplayNameOfUserForIm:function(n){return s(n)}});var s=o(function(n){if(n._display_name)return n._display_name;const a=TS.interop.members.getMemberById(n.user);if(!a)return n.name;const d=TS.interop.rules.members.getPrefCompliantMemberName(a);return d===n.user||d===a.id?n.name:(n._display_name=d,n._display_name)},"_getDisplayNameCached"),r=o(function(n){var a=_.find(TS.model.ims,{user:n.id});a&&t(a)},"_memberRealNameChanged"),i=o(function(){TS.model.ims.forEach(t)},"_realNamePrefChanged"),t=o(function(n){n._display_name=void 0},"_clearDisplayNameCache")})()},1136428304:()=>{(function(){TS.registerModule("members",{presence_changed_sig:new signals.Signal,user_color_changed_sig:new signals.Signal,changed_current_status_sig:new signals.Signal,changed_name_sig:new signals.Signal,changed_real_name_sig:new signals.Signal,changed_deleted_sig:new signals.Signal,changed_profile_sig:new signals.Signal,changed_tz_sig:new signals.Signal,changed_account_type_sig:new signals.Signal,changed_admin_perms_sig:new signals.Signal,changed_owner_perms_sig:new signals.Signal,changed_self_sig:new signals.Signal,lazily_added_sig:new signals.Signal,batch_upserted_sig:new signals.Signal,member_was_upserted_sig:new signals.Signal,legacy_is_in_bulk_upsert_mode:!1,legacyUpsertAndSignal:function(c){var x=TS.members.legacyUpsertMember(c);return ee(x,c)},legacyUpsertMember:function(c){var x=TS.redux.members.hasMemberWithId(c.id)&&TS.interop.members.getRawMemberById(c.id),re="NOOP",J=[];if(c=TS.interop.members.processMemberForUpserting(c),x){TS.has_pri[H]&&TS.log(H,`updating existing member "${c.id}"`);var te=O(x,c);if(re=te.status,J=te.what_changed,_.includes(J,"deleted")){var q=TS.redux.channels.getImByMemberId(c.id);q&&(q.is_archived=c.deleted)}}else c.id?(re="ADDED",_.includes(u,c.id)&&J.push("is_unknown"),Q(c),TS.has_pri[H]&&TS.log(H,`adding member "${c.id}" color:${c.color} member_color:${c.member_color}`)):TS.error("bad error, no member.id");if(c.is_self&&c.deleted){TS.reload(null,"member.is_self && member.deleted");return}TS.members.legacy_is_in_bulk_upsert_mode||(TS.members.invalidateMembersUserCanSeeArrayCaches(),TS.members.invalidateActiveMembersArrayCaches()),TS.members.member_was_upserted_sig.dispatch(),TS.members.legacy_is_in_bulk_upsert_mode||(re!=="NOOP"&&(TS.interop.members.dangerouslyAddMember(c),TS.redux.dispatch(TS.interop.redux.features.presence.updatePresence({memberId:c.id,presence:c.presence||"away"}))),TS.interop.members.markObjectsAsFresh([c.id]),TS.interop.members.setCanMembersInteract([c]));var ne={status:re,member:c,what_changed:J};return TS.members.legacy_is_in_bulk_upsert_mode&&s.push(ne),ne},getActiveMembersWithSelfAndNotSlackbot:function(){return r.length||(r=f(r,{include_self:!0,include_slackbot:!1,include_bots:!0})),r},getMembersWithOptions:function(c){var x=TS.members.getMembersForUser(),re=_.filter(x,function(J){return J.is_stranger?!1:c.only_admins?J.is_admin&&!J.deleted:!(c.only_local_team&&!TS.interop.rules.members.isMemberOnTeam(J,TS.model.team.id)||!c.include_deleted&&J.deleted||!c.include_slackbot&&TS.interop.rules.members.isSlackbot(J)||!c.include_self&&J.is_self||!c.include_bots&&J.is_bot)});return re},getMembersForUser:function(){return m.length||(m=_.filter(TS.redux.members.getAllMembers(),function(c){return c.is_stranger!==!0&&!!c.name})),m},legacyGetPrefCompliantMemberNameLowerCase:function(c,x){if(!c)return"";var re=function(){var J=TS.interop.rules.members.getMemberRealNameLowerCase(c);return!TS.interop.members.shouldDisplayRealNames()&&TS.interop.rules.members.getMemberProfileFieldDisplayNameLowerCase(c)&&(J=TS.interop.rules.members.getMemberProfileFieldDisplayNameLowerCase(c)),J}();return x?_.escape(re):re},memberSorterByName:function(c,x){return TS.interop.i18n.sorter(TS.members.legacyGetPrefCompliantMemberNameLowerCase(c),TS.members.legacyGetPrefCompliantMemberNameLowerCase(x))},invalidateMembersUserCanSeeArrayCaches:function(){if(TS.model.user){var c=m.length;c&&(m.length=0,TS.members.invalidateActiveMembersArrayCaches())}},invalidateActiveMembersArrayCaches:function(){r.length=0,i.length=0,t.length=0,n.length=0,a.length=0,d.length=0},legacyEnsureMembersInDataArePresent:function(c,x){var re=TS.interop.utility.extractAllMemberIds(c);if(_.get(TS,"model.team.id")==="T02J3DPUE"&&!_.isEmpty(re)){var J=_.some(re,function(q){return q[0]==="U"});if(J){var te={message:`Fetching U users on W team from source: ${x}`,stack:TS.console.getStackTrace()};$.post(TS.boot_data.beacon_error_url,{description:"fetch_u_on_w_team",error_json:JSON.stringify(te),team:_.get(TS,"model.team.id","none"),user:TS.boot_data.user_id,version:TS.boot_data.version_ts})}}return TS.interop.members.ensureMembersArePresent(re)},fetchAndUpsertMembersWithQuery:function(c){return TS.interop.members.fetchAndUpsertMembersWithQuery({query:c}).then(x=>{let{members:re,next_marker:J}=x;return{objects:re,next_marker:J}})},legacyStartBatchUpsert:function(){return TS.members.legacy_is_in_bulk_upsert_mode?!1:(TS.members.legacy_is_in_bulk_upsert_mode=!0,!0)},legacyFinishBatchUpsert:function(){if(!TS.members.legacy_is_in_bulk_upsert_mode)return!1;TS.members.legacy_is_in_bulk_upsert_mode=!1,TS.members.invalidateMembersUserCanSeeArrayCaches(),TS.members.invalidateActiveMembersArrayCaches(),TS.interop.members.dangerouslyBulkAddMembers(s.map(x=>x.member));var c=s.reduce((x,re)=>{var J=re.member;return J.presence&&(x[J.id]=x[J.presence]),x},{});return TS.redux.dispatch(TS.interop.redux.features.presence.bulkUpdatePresence(c)),TS.members.batch_upserted_sig.dispatch(s),TS.interop.members.markObjectsAsFresh(_.map(s,"member.id")),TS.interop.members.setCanMembersInteract(s.map(x=>x.member)),s=[],!0},legacyAllocateTeamListMembers:function(c){var x,re=[],J=[],te=[],q=[],ne=[],ce=[];c.sort(function(z,j){var X=z._real_name_lc||z._name_lc,N=j._real_name_lc||j._name_lc;return X>N?1:N>X?-1:0});for(var L=0;L<c.length;L+=1)x=c[L],x.deleted?x.is_bot?te.push(x):J.push(x):x.is_ultra_restricted?ce.push(x):x.is_restricted?ne.push(x):x.is_bot||TS.interop.rules.members.isSlackbot(x)?q.push(x):re.push(x);return{members:re,disabled_members:J,deleted_bots:te,bots:q,restricted_members:ne,ultra_restricted_members:ce}},promiseToSearchMembers:function(c){return Promise.resolve(c).then(function(x){return x?(x.query=x.query&&x.query.trim()||"",x.include_org=!!TS.boot_data.page_needs_enterprise&&!!x.include_org,x.org_team_ids=x.include_org&&Array.isArray(x.org_team_ids)?x.org_team_ids:[],x=S(x,TS.interop.searcher.isNewMemberSearch(x)),x._is_new||x.num_remaining>0?v(x):Promise.resolve(x)):Promise.reject(new Error("No search parameters provided"))})},legacySetMemberUnknown:function(c){u.push(c)},test:function(){var c={};return Object.defineProperty(c,"_accessible_user_ids_last_fetched_ts",{get:function(){return Y},set:function(x){Y=x}}),Object.defineProperty(c,"_processNewMemberForUpserting",{get:function(){return Q},set:function(x){Q=x}}),Object.defineProperty(c,"_processExistingMemberForUpserting",{get:function(){return O},set:function(x){O=x}}),Object.defineProperty(c,"_fillMembersWithOptions",{get:function(){return f},set:function(x){f=x}}),Object.defineProperty(c,"_members_for_user",{get:function(){return m},set:function(x){m=x}}),c}});var s=[],r=[],i=[],t=[],n=[],a=[],d=[],m=[],u=[],f=o(function(c,x){if(!_.isArray(c))throw new TypeError("members passed to _fillMembersWithOptions is not an array!");c.length=0;var re=TS.members.getMembersWithOptions(x);return _.each(re,function(J){c.push(J)}),c},"_fillMembersWithOptions"),p=o(function(c){var x=c?c.is_unknown:!1;return c&&c.is_unknown&&(c.is_unknown=!1),_.pull(u,c.id),x},"_maybeSetMemberKnown"),S=o(function(c,x){return c=c||{},c.hasOwnProperty("_searcher_p")&&x&&c._searcher_p.cancel(),(!c.hasOwnProperty("_cursor_mark")||x)&&(c._cursor_mark=""),c.hasOwnProperty("full_profile_filter")||(c.full_profile_filter=!0),c.hasOwnProperty("include_bots")||(c.include_bots=!0),c.hasOwnProperty("include_deleted")||(c.include_deleted=!1),c.hasOwnProperty("include_self")||(c.include_self=!1),c.hasOwnProperty("include_slackbot")||(c.include_slackbot=!0),c.hasOwnProperty("include_profile_only_users")||(c.include_profile_only_users=!1),c.hasOwnProperty("only_local_team")||(c.only_local_team=!1),c.hasOwnProperty("only_admins")||(c.only_admins=!1),(!c.hasOwnProperty("items")||x)&&(c.items=[]),c.hasOwnProperty("not_member_of")||(c.not_member_of=[]),c.hasOwnProperty("member_of")||(c.member_of=[]),(!c.hasOwnProperty("num_found")||x)&&(c.num_found=0),(!c.hasOwnProperty("num_remaining")||x)&&(c.num_remaining=0),(!c.hasOwnProperty("num_new")||x)&&(c.num_new=0),c.hasOwnProperty("max_api_results")||(c.max_api_results=100),x&&(c._last_query=c.query,c._last_include_org=c.include_org,c._last_org_team_ids=c.org_team_ids),c._is_new=!!x,c},"_readyMemberSearcher"),v=o(function(c){var x=o(function(){return C(c)},"promiseToSearch");return c._is_new?c._searcher_p=x():c._searcher_p=c._searcher_p.then(x),c._searcher_p},"_promiseToSearchMembers"),P=o(function(c){var x=[TS.utility.search.makeClause("is","user")];if(c._last_query){var re=c._last_query.split(/\s*,\s*|\s+/).map(function(L){return L.charAt("0")==="@"?L.substring(1):L}).filter(function(L){return!!L}).map(function(L){return L.length===1||!c.full_profile_filter?TS.utility.search.makeConjunction("OR",[TS.utility.search.makeClause("real_name",L),TS.utility.search.makeClause("display_name",L)]):TS.utility.search.makeClause("fuzzy_with_email",L)});x=x.concat(re)}if(c.not_member_of&&c.not_member_of.length){var J=c.not_member_of.map(function(L){return TS.utility.search.makeClause("not_member_of",L)});x.push(J.length>1?TS.utility.search.makeConjunction("OR",J):J[0])}if(c.member_of&&c.member_of.length){var te=c.member_of.map(function(L){return TS.utility.search.makeClause("member_of",L)});x.push(te.length>1?TS.utility.search.makeConjunction("OR",te):te[0])}if(c._last_include_org&&c._last_org_team_ids.length){var q=c._last_org_team_ids.map(function(L){return TS.utility.search.makeClause("belongs_to_team_id",L)});x.push(q.length>1?TS.utility.search.makeConjunction("OR",q):q[0])}var ne=x.length>1?TS.utility.search.makeConjunction("AND",x):x[0],ce={query:ne,count:c.max_api_results,include_bots:c.include_bots,include_deleted:c.include_deleted,ignore_guest_accounts:c.ignore_guest_accounts,only_local_team:c.only_local_team,only_admins:c.only_admins,include_profile_only_users:c.include_profile_only_users,raw_query:c.query,solr:c.solr};return c._last_include_org&&(ce.all_of_org=c._last_include_org),c._cursor_mark&&(ce.cursor_mark=c._cursor_mark),c.determine_membership_for_channel&&(ce.determine_membership_for_channel=c.determine_membership_for_channel),ce},"_buildPromiseToSearchMembersArguments"),C=o(function(c){var x=P(c);return c.num_new=0,TS.utility.search.promiseToSearch(x).then(function(re){if(!re.data.items.length)return Promise.resolve(c);c.num_remaining||(c.num_remaining=re.data.num_found,c.num_found=re.data.num_found),c.num_remaining-=re.data.items.length,c._cursor_mark=re.data.next_cursor_mark;var J=re.data.items.map(function(te){var q=TS.interop.members.getMemberById(te.id);return q||(c._last_include_org&&te.team_id!==TS.model.team.id&&(te.is_primary_owner=!1,te.is_owner=!1,te.is_admin=!1),q=TS.members.legacyUpsertMember(te).member),q}).filter(function(te){return te.is_self&&!c.include_self||TS.interop.rules.members.isSlackbot(te)&&!c.include_slackbot?(c.num_found-=1,!1):c.limit_by_model_relevancy?TS.utility.members.isMemberRelevantToModel(te,c.limit_by_model_relevancy):!0});return c.num_new=J.length,c.items.push.apply(c.items,J),Promise.resolve(c)})},"_promiseToSearchMembersWorker"),D=o(function(c){return _.isObject(c)?_.omitBy(c,function(x,re){return re.indexOf("image_")===0}):c},"_omitImagesFromProfile"),O=o(function(c,x){var re="NOOP",J=[];return Object.keys(x).forEach(function(te){if(te==="profile"){var q=D(c.profile),ne=D(x.profile);if(_.isObject(ne)){(q.status_text!==ne.status_text||q.status_emoji!==ne.status_emoji)&&(re="CHANGED",J.push("current_status"));var ce=Object.keys(q).filter(function(N){return typeof ne[N]>"u"}).concat(["status_text","status_emoji"]);q=_.omit(q,ce),ne=_.omit(ne,ce),_.isEqual(q,ne)||(re="CHANGED",J.push(te))}}else if(te==="enterprise_user")if(c[te])for(var L in x[te])_.isEqual(c[te][L],x[te][L])||(re="CHANGED",J.push(te));else re="CHANGED",J.push(te);else if(te==="id"){var z=c.id!=x.id&&c.enterprise_user&&x.enterprise_user;if(z){var j=c.enterprise_user.id===c.id,X=x.id!=x.enterprise_user.id;j&&X&&(re="CHANGED",J.push(te))}}else te==="teams"?(re="CHANGED",J.push(te)):c[te]!=x[te]&&(te==="is_admin"&&TS.has_pri[F]&&(TS.warn(F,`${te}is changing from \`${c[te]}\` to \`${x[te]}\``),TS.console.trace(F)),x[te]&&!TS.utility.isScalar(x[te])?(c[te]=x[te],TS.warn(`${te} is not scalar! it needs to be handled by upsertMember specifically to test if it has changed! ${typeof x[te]}`)):(typeof x[te]!="boolean"||!x[te]!=!c[te])&&(J.push(te),re="CHANGED"))}),p(c)&&J.push("is_unknown"),{status:re,what_changed:J}},"_processExistingMemberForUpserting"),Q=o(function(c){TS.members.user_color_changed_sig.dispatch(c)},"_processNewMemberForUpserting"),Y=0,H=4,F=1975,ee=o(function(c,x){if(c.status==="ADDED")TS.members.lazily_added_sig.dispatch(c.member);else if(c.status==="CHANGED"){if(c.what_changed.indexOf("is_unknown")!==-1)return c;c.what_changed.indexOf("current_status")!==-1&&TS.members.changed_current_status_sig.dispatch(c.member),c.what_changed.indexOf("profile")!==-1&&TS.members.changed_profile_sig.dispatch(c.member),(c.what_changed.indexOf("is_restricted")!==-1||c.what_changed.indexOf("is_ultra_restricted")!==-1)&&TS.members.changed_account_type_sig.dispatch(c.member),c.what_changed.indexOf("real_name")!==-1&&TS.members.changed_real_name_sig.dispatch(c.member),(c.what_changed.indexOf("member_color")!==-1||c.what_changed.indexOf("color")!==-1)&&TS.members.user_color_changed_sig.dispatch(c.member),c.what_changed.indexOf("name")!==-1&&TS.members.changed_name_sig.dispatch(c.member),c.what_changed.indexOf("tz")!==-1&&TS.members.changed_tz_sig.dispatch(c.member),c.what_changed.indexOf("deleted")!==-1&&TS.members.changed_deleted_sig.dispatch(c.member),c.what_changed.indexOf("presence")!==-1&&TS.members.presence_changed_sig.dispatch(c.member),c.what_changed.indexOf("is_owner")!==-1&&TS.members.changed_owner_perms_sig.dispatch(c.member),c.what_changed.indexOf("is_admin")!==-1&&TS.members.changed_admin_perms_sig.dispatch(c.member),x.is_self&&TS.members.changed_self_sig.dispatch(c.member)}return c},"_signalUpsert")})()},6711515563:()=>{(function(){TS.registerModule("members.view",{team_filter_changed_sig:new signals.Signal,filter_timer:null,onStart:function(){var L=500;u=TS.utility.debounceWithPromise(ee,L),f=TS.utility.debounceWithPromise(ee,L),p=TS.utility.debounceWithPromise(ee,L)},switchTabs:function(L){$(`#${L}_members_tab`).trigger("click")},filterTeam:function(L,z,j,X){var N=P(j);return _.get(X,"full_profile_filter")||_.get(N,"full_profile_filter")?TS.team.ensureTeamProfileFields().then(function(){return v(N)?Q(L,z,j,N):(c(L,z,j,X),Promise.resolve())}):(c(L,z,j),Promise.resolve())},clearFilter:function(L,z){var j=P(z),X=$(L),N=X.find("input.member_filter"),y=X.find(".icon_close"),U=X.data("list-items-id"),h=$(U),w=h.find(".member_item");s="",TS.storage.storeFilterState(s),TS.members.view.filter_timer&&(window.clearTimeout(TS.members.view.filter_timer),TS.members.view.filter_timer=null),N.val(""),y.addClass("hidden"),v(j)?(O(z),TS.members.view.filterTeam(s,L,z,j)):($(".restricted_header, .bot_header, .ra_invite_prompt, .restricted_info").removeClass("hidden"),h.find(".no_results").addClass("hidden"),w.addClass("active"),r[z]&&(r[z].detachEvents(),delete r[z]),h.find(".member_item.clone").remove(),h.find(".filter_header").remove(),TS.members.view.team_filter_changed_sig.dispatch("",TS.members.getMembersForUser().length))}});var s="",r={},i={},t={},n={},a={members:{},restricted:{},deleted:{}},d=100,m=116,u,f,p,S=o(function(){return _.get(TS,"web.admin.view")==="list"&&TS.boot_data.page_needs_enterprise?!1:TS.boot_data.page_needs_enterprise},"_includeOrg"),v=o(function(L){if(TS.boot_data.page_needs_enterprise&&L&&L.is_long_list_view||_.get(TS,"web.admin.view")==="list")return!0},"_useSolrSearch"),P=o(function(L){var z=t[L];if(!z){TS.error("Missing arguments for a bound filter");return}return _.isFunction(z)&&(z=z()||{}),z.include_org=S(),z},"_getFilterArgumentsByScrollerId"),C=o(function(L){var z=$(L).find(".ts_icon_search");if(!z.next().is(`${L}_spinner`)){var j=TS.templates.loading_indicator({id:`${L.substring(1)}_spinner`});z.after(j),z.addClass("hidden")}},"_startSpinner"),D=o(function(L){$(L).find(".ts_icon_search").removeClass("hidden"),$(`${L}_spinner`).remove()},"_stopSpinner"),O=o(function(){a.filter_p&&a.filter_p.cancel(),a.filtered_items&&(a.filtered_items={}),a.filter_last_query=null,a.filter_last_include_org=null,a.members.filter_cursor_mark="",a.members.filter_num_remaining=0,a.members.filter_num_found=0,a.members.filter_scroll_mark=0,a.restricted.filter_cursor_mark="",a.restricted.filter_num_remaining=0,a.restricted.filter_num_found=0,a.restricted.filter_scroll_mark=0,a.deleted.filter_cursor_mark="",a.deleted.filter_num_remaining=0,a.deleted.filter_num_found=0,a.deleted.filter_scroll_mark=0,TS.web&&$(window).off("scroll.filter").scrollTop(0)},"_cleanUpPromiseToFilterTeam"),Q=o(function(L,z,j,X){var N=L.trim();s=N.toLocaleLowerCase(),TS.storage.storeFilterState(s);var y=a.filter_last_query!==s||a.filter_last_include_org!==X.include_org||a.filter_last_sort!==X.sort||a.filter_last_sort_dir!==X.sort_dir;y&&(O(j),a.filter_last_query=s,a.filter_last_include_org=X.include_org,X.sort&&(a.filter_last_sort=X.sort),X.sort_dir&&(a.filter_last_sort_dir=X.sort_dir)),C(z);var U=o(function(){return Promise.resolve().then(function(){return Y(a,y,s,X)}).then(function(h){return D(z),H(h,a,y,s,N,z,j,X)}).finally(function(){TS.utility.rAF(function(){})})},"promiseToFilter");return y?a.filter_p=U():a.filter_p=a.filter_p.then(U),a.filter_p},"_promiseToFilterTeam"),Y=o(function(L,z,j,X){var N=z||TS.model.ui_state.tab_name==="active_members"&&L.members.filter_num_remaining,y=z||TS.model.ui_state.tab_name==="restricted_members"&&L.restricted.filter_num_remaining,U=z||TS.model.ui_state.tab_name==="disabled_members"&&L.members.filter_num_remaining;if(!N&&!y&&!U)return Promise.resolve(L.filtered_items);var h=_.assign({},X,{restricted:!1});L.members.filter_p=N?u(L.members,j,h):Promise.resolve([]);var w=_.assign({},X,{restricted:!0});L.restricted.filter_p=y?f(L.restricted,j,w):Promise.resolve([]);var R=_.assign({},X,{include_deleted:2,include_restricted_and_full_members:!0});return L.deleted.filter_p=U?p(L.deleted,j,R):Promise.resolve([]),Promise.join(L.members.filter_p,L.restricted.filter_p,L.deleted.filter_p,function(E,B,G){var K=(X.sort?q:TS.members.legacyAllocateTeamListMembers)(E.concat(B,G));return K.members=_.uniqBy(K.members,function(ae){return ae.id}),K.disabled_members=_.uniqBy(K.disabled_members,function(ae){return ae.id}),K.restricted_members=_.uniqBy(K.restricted_members,function(ae){return ae.id}),K.ultra_restricted_members=_.uniqBy(K.ultra_restricted_members,function(ae){return ae.id}),z?L.filtered_items=K:(L.filtered_items.members.push.apply(L.filtered_items.members,K.members),L.filtered_items.disabled_members.push.apply(L.filtered_items.disabled_members,K.disabled_members),L.filtered_items.deleted_bots.push.apply(L.filtered_items.deleted_bots,K.deleted_bots),L.filtered_items.bots.push.apply(L.filtered_items.bots,K.bots),L.filtered_items.restricted_members.push.apply(L.filtered_items.restricted_members,K.restricted_members),L.filtered_items.ultra_restricted_members.push.apply(L.filtered_items.ultra_restricted_members,K.ultra_restricted_members)),ce([...L.filtered_items.restricted_members,...L.filtered_items.ultra_restricted_members]).then(()=>Promise.resolve(L.filtered_items))})},"_promiseToSearchAndCombineResults"),H=o(function(L,z,j,X,N,y,U,h){if(L){var w=!1;TS.model.ui_state.tab_name==="disabled_members"&&(a.deleted.filter_num_found||0)===0&&(w=!0),TS.model.ui_state.tab_name==="restricted_members"&&(a.restricted.filter_num_found||0)===0&&(w=!0);var R=TS.model.user_groups.filter(function(ie){return!ie.date_delete});TS.model.ui_state.tab_name==="user_groups"&&R.length===0&&(w=!0),w&&(TS.model.ui_state.tab_name="active_members",TS.storage.storeUIState(TS.model.ui_state),$("#active_members_tab").trigger("click"));var E=$("#active_members_list");E.length&&(E.longListView("setItems",n.active_members_list_items),j&&E.longListView("scrollToTop"));var B=$("#restricted_members_list");B.length&&(B.longListView("setItems",n.restricted_members_list_items),j&&B.longListView("scrollToTop"));var G=$("#deleted_members_list");G.length&&(G.longListView("setItems",n.deleted_members_list_items),j&&G.longListView("scrollToTop"));var K=L.members.concat(L.bots),ae=L.restricted_members.concat(L.ultra_restricted_members),ue=L.disabled_members.concat(L.deleted_bots),oe=[{name:"active",label:TS.interop.i18n.t("full members","members_view")(),matches:K},{name:"restricted",label:TS.interop.i18n.t("multi-channel guests","members_view")(),matches:ae},{name:"disabled",label:TS.interop.i18n.t("deactivated accounts","members_view")(),matches:ue}];if(oe.forEach(function(ie){var me=$(`#${ie.name}_no_results`);function I(){var l={query:N,tab:ie,active_matches:K,show_active_matches:ie.name!=="active"&&K.length>0,restricted_matches:ae,show_restricted_matches:ie.name!=="restricted"&&ae.length>0,disabled_matches:ue,show_disabled_matches:ie.name!=="disabled"&&ue.length>0},g=TS.templates.team_list_no_results(l);me.removeClass("hidden").html(g),me.find(".clear_members_filter").one("click",function(){TS.members.view.clearFilter(y,U)})}o(I,"noMatchesCase"),ie.matches.length>0||!X?me.addClass("hidden").empty():I()}),j){U==="#team_list_scroller"&&TS.web&&$(window).off("scroll.filter").on("scroll.filter",_.throttle(function(){var ie=0,me=0,I=0,l=null;TS.model.ui_state.tab_name==="active_members"&&(ie=_.parseInt($("#active_members_list > .list_items").css("height")),me=_.reject(n.active_members_list_items,{is_divider:!0}).length,I=z.members.filter_num_remaining,l=z.members.filter_p),TS.model.ui_state.tab_name==="restricted_members"&&(ie=_.parseInt($("#restricted_members_list > .list_items").css("height")),me=_.reject(n.restricted_members_list_items,{is_divider:!0}).length,I=z.restricted.filter_num_remaining,l=z.restricted.filter_p),TS.model.ui_state.tab_name==="disabled_members"&&(ie=_.parseInt($("#disabled_members_list > .list_items").css("height")),me=_.reject(n.deleted_members_list_items,{is_divider:!0}).length,I=z.deleted.filter_num_remaining,l=a.deleted.filter_p);var g=.9*Math.min(me,d);ie=_.isNaN(ie)?0:ie,ie-=g*m,ie&&I&&$(this).scrollTop()>ie&&l&&l.isResolved()&&Q(X,y,U,h)},50,{leading:!0}));var le=(z.members.filter_num_found||0)+(z.restricted.filter_num_found||0)+(z.deleted.filter_num_found||0);TS.members.view.team_filter_changed_sig.dispatch(N,le)}}},"_displayPromiseToSearchResults"),F=o(function(L,z,j){var X=[];if(z&&(X=z.split(/\s*,\s*|\s+/).map(function(w){return w.charAt("0")==="@"?w.substring(1):w}).filter(function(w){return!!w}).map(function(w){if(w.length===1||!j.full_profile_filter){var R=TS.utility.search.makeClause("real_name",w),E=TS.utility.search.makeClause("display_name",w),B=TS.utility.search.makeConjunction("OR",[R,E]);return B}return TS.utility.search.makeClause("fuzzy_with_email",w)})),X.push(TS.utility.search.makeClause("is","user")),j.restricted){var N=TS.utility.search.makeClause("level","restricted"),y=TS.utility.search.makeClause("level","ultra_restricted");X.push(TS.utility.search.makeConjunction("OR",[N,y]))}var U=X.length>1?TS.utility.search.makeConjunction("AND",X):X[0],h={query:U,count:d,include_bots:j.include_bots,exclude_slackbot:j.exclude_slackbot,include_deleted:j.include_deleted};return j.sort&&(h.sort=j.sort),j.sort_dir&&(h.sort_dir=j.sort_dir),j.include_org&&(h.all_of_org=j.include_org),L.filter_cursor_mark&&(h.cursor_mark=L.filter_cursor_mark),j.endpoint&&(h.endpoint=j.endpoint),TS.web&&(h.solr=!0),h},"_buildPromiseToSearchArguments"),ee=o(function(L,z,j){var X=F(L,z,j);return X.raw_query=z,TS.utility.search.promiseToSearch(X).then(function(N){if(L.filter_num_remaining||(L.filter_num_remaining=N.data.num_found,L.filter_num_found=N.data.num_found),L.filter_num_remaining-=N.data.items.length,L.filter_cursor_mark=N.data.next_cursor_mark,!N.data.items.length)return Promise.resolve([]);var y=N.data.items.map(function(U){var h=TS.interop.members.getMemberById(U.id);return(!h||!_.isEqual(h,U))&&(h=TS.members.legacyUpsertMember(U).member),h});return!j.restricted&&!j.include_restricted_and_full_members&&(y=y.filter(function(U){return!U.is_restricted})),y.length?Promise.resolve(y):L.filter_num_remaining?ee(L,z,j):Promise.resolve([])})},"_promiseToSearch"),c=o(function(L,z,j,X){var N=$(z),y=L.trim();s=y.toLocaleLowerCase();var U=N.data("list-items-id"),h=$(U),w=h.find(".member_item:not(.clone)"),R=w.filter(".active"),E=h.find(".member_item.clone"),B=h.find(".filter_header"),G=!TS.web&&z==="#team_filter",K={},ae,ue,oe;TS.storage.storeFilterState(s);var le=!1,ie;!ie&&!TS.web&&z==="#team_filter"&&(ie=$("#team_list_members")),ie&&ie.length&&ie.addClass("hidden"),le&&(ae=w.parent(),ue=document.activeElement?$(document.activeElement):null,w.detach()),r[j]&&(r[j].detachEvents(),delete r[j]),E.remove(),B.remove(),R.removeClass("active"),h.find(".no_results").addClass("hidden"),le&&(ae.append(w),ue&&ue.focus());var me,I,l=[],g=[],b=[];I=TS.members.getMembersForUser(),$(".restricted_header, .bot_header, .ra_invite_prompt, .restricted_info").toggleClass("hidden",!!s),$.each(w,function(_e,fe){var he;fe=$(fe),he=fe.data("member-id"),K[he]=fe});var M=ne(I,s,X.full_profile_filter),Z=Object.keys(M);if(Z.length>0){if(te(M,Z,K,b,g,l,G?j:""),j){var V=$(j);V.trigger("resize"),TS.ui.utility.updateClosestMonkeyScroller(V)}}else z==="#file_member_filter"&&(h.find(".query").text(y),h.find(".no_results").removeClass("hidden"));z==="#team_filter"&&(me=[{name:"active",label:TS.interop.i18n.t("full members","members_view")(),matches:l},{name:"restricted",label:TS.interop.i18n.t("multi-channel guests","members_view")(),matches:g},{name:"disabled",label:TS.interop.i18n.t("deactivated accounts","members_view")(),matches:b}],me.forEach(function(_e){var fe=$(`#${_e.name}_no_results`);function he(){var ye={query:y,tab:_e,active_matches:l,show_active_matches:_e.name!=="active"&&l.length>0,restricted_matches:g,show_restricted_matches:_e.name!=="restricted"&&g.length>0,disabled_matches:b,show_disabled_matches:TS.web&&_e.name!=="disabled"&&b.length>0},Te=TS.templates.team_list_no_results(ye);fe.removeClass("hidden").html(Te),fe.find(".clear_members_filter").on("click",function(){TS.members.view.clearFilter(z,j)})}if(o(he,"noMatchesCase"),_e.matches.length>0){fe.addClass("hidden").empty();return}he()})),oe=l.concat(g,b),ie&&ie.length&&ie.removeClass("hidden"),TS.ui.utility.updateClosestMonkeyScroller($(j)),TS.members.view.team_filter_changed_sig.dispatch(y,oe.length)},"_filterTeam"),x=o(function(L){return i[L]||L},"_getHeaderLabelForMatchKey"),re=o(function(L,z){var j=document.createElement("div"),X=document.createElement("strong");return j.classList.add("filter_header"),X.appendChild(document.createTextNode(L)),z.length&&X.appendChild(document.createTextNode(": ")),j.appendChild(X),z.forEach(function(N,y){j.appendChild(N),y<z.length-1&&j.appendChild(document.createTextNode(", "))}),j},"_getFilterHeader"),J=o(function(L,z){var j=document.createElement("span"),X=document.createElement("strong"),N=L.split(z);return X.appendChild(document.createTextNode(z)),j.appendChild(document.createTextNode(N.shift())),j.appendChild(X),j.appendChild(document.createTextNode(N.join(z))),j},"_getHighlightedValue"),te=o(function(L,z,j,X,N,y,U){var h=$(U),w=document.createDocumentFragment(),R=document.createDocumentFragment(),E=document.createDocumentFragment(),B,G,K;if(z.sort(function(ue,oe){return TS.interop.i18n.sorter(i[ue],i[oe])}).forEach(function(ue){var oe=document.createDocumentFragment(),le=document.createDocumentFragment(),ie=document.createDocumentFragment(),me=[],I=[],l=[],g={},b={},M={};L[ue].forEach(function(Z){var V=Z.member,_e,fe=!1;V&&V.id&&(_e=j[V.id],_e&&(ue==="name"&&!fe?_e.addClass("active"):V.deleted?(B||(B=_e.parent()),Z.value&&!g[Z.value]&&(g[Z.value]=me.push(J(Z.value,Z.match))),oe.appendChild(_e.clone().addClass("active clone").get(0))):V.is_restricted?(G||(G=_e.parent()),Z.value&&!b[Z.value]&&(b[Z.value]=I.push(J(Z.value,Z.match))),le.appendChild(_e.clone().addClass("active clone").get(0))):(K||(K=_e.parent()),Z.value&&!M[Z.value]&&(M[Z.value]=l.push(J(Z.value,Z.match))),ie.appendChild(_e.clone().addClass("active clone").get(0)))),V.deleted?X.push(V):V.is_restricted?N.push(V):y.push(V))}),oe.childNodes&&oe.childNodes.length&&(w.appendChild(re(x(ue),me)),w.appendChild(oe)),le.childNodes&&le.childNodes.length&&(R.appendChild(re(x(ue),I)),R.appendChild(le)),ie.childNodes&&ie.childNodes.length&&(E.appendChild(re(x(ue),l)),E.appendChild(ie)),oe=null,le=null,ie=null,me=null,I=null,l=null,g=null,b=null,M=null}),B&&B.append(w),G&&G.append(R),K&&K.append(E),h.length){var ae=h.find(".member_item.clone");r[U]=ae.find(".lazy").lazyload({container:h,ignore_when_hidden_element:h,all_images_same_size:!0}),ae.one("remove",function(){r[U]&&(r[U].detachEvents(),delete r[U])})}w=null,R=null,E=null,B=null,G=null,K=null},"_displayMatches"),q=o(function(L){return _.reduce(L,function(z,j){return j.deleted?j.is_bot?z.deleted_bots.push(j):z.disabled_members.push(j):j.is_ultra_restricted?z.ultra_restricted_members.push(j):j.is_restricted?z.restricted_members.push(j):j.is_bot||TS.interop.rules.members.isSlackbot(j)?z.bots.push(j):z.members.push(j),z},{members:[],disabled_members:[],deleted_bots:[],bots:[],restricted_members:[],ultra_restricted_members:[]})},"_legacyAllocateTeamListMembers"),ne=o(function(L,z,j){var X=new RegExp(`^${TS.utility.regexpEscape(z)}`,"i"),N=new RegExp(`(-|_|\\+|\\s|\\.|@)${TS.utility.regexpEscape(z)}`,"i"),y={},U=j&&z?TS.team.getVisibleTeamProfileFields():[];return i={title:"What I Do",name:"Name"},L.forEach(function(h){var w;w=h._real_name_lc&&(h._real_name_lc.match(X)||h._real_name_lc.match(N))||h.email&&(h.email.match(X)||h.email.match(N))||h.profile&&h.profile.email&&(h.profile.email.match(X)||h.profile.email.match(N))||h.profile&&h.profile.real_name_normalized&&(h.profile.real_name_normalized.match(X)||h.profile.real_name_normalized.match(N))||h.profile&&h.profile.real_name&&(h.profile.real_name.match(X)||h.profile.real_name.match(N))||h.profile&&h.profile.display_name_normalized&&(h.profile.display_name_normalized.match(X)||h.profile.display_name_normalized.match(N))||h.profile&&h.profile.preferred_name&&(h.profile.preferred_name.match(X)||h.profile.preferred_name.match(N)),w&&(y.name||(y.name=[]),y.name.push({member:h})),j&&z&&(w=h.profile&&h.profile.title&&(h.profile.title.match(X)||h.profile.title.match(N)),w&&(y.title||(y.title=[]),y.title.push({member:h}))),U.length&&h.profile&&h.profile.fields&&U.forEach(function(R){var E=h.profile.fields[R.id];if(E){if(w=null,R.type==="user"){if(E.value){var B="";E.value.split(/\s*,\s*/).some(function(G){return B=TS.interop.rules.members.getPrefCompliantMemberNameById(G,!1),B.match(X)||B.match(N)}),w&&(y[R.id]||(y[R.id]=[]),y[R.id].push({member:h,value:B,match:w[0]}))}}else w=E.value&&(E.value.match(X)||E.value.match(N)),w?(y[R.id]||(y[R.id]=[]),y[R.id].push({member:h,value:E.value,match:w[0]})):(w=E.alt&&(E.alt.match(X)||E.alt.match(N)),w&&(y[R.id]||(y[R.id]=[]),y[R.id].push({member:h,value:E.alt,match:w[0]})));w&&!i[R.id]&&(i[R.id]=R.label)}})}),y},"_findMatchesInMemberList"),ce=o(function(){return Promise.resolve()},"_maybeFetchGuestChannels")})()},1484214105:()=>{(function(){TS.registerModule("membership",{onStart:function(){var r=1/0;TS.members.changed_deleted_sig.add(s,this,r)}});var s=o(function(){TS.interop.memberCounts.markAllMemberCountsAsStale()},"_invalidateAllMemberCounts")})()},2693193630:()=>{(function(){TS.registerModule("menu.member",{member:null,onStart:function(){},startWithEnterpriseMemberHeader:function(r){var i=15;if(!TS.menu.isRedundantClick(r)&&!TS.model.menu_is_showing){TS.menu.buildIfNeeded(),TS.menu.clean();var t={enterprise_name:$("[data-enterprise-name]").val(),signout_url:TS.boot_data.signout_url};TS.menu.$menu_header.addClass("hidden").empty(),TS.menu.$menu_items.html(TS.templates.menu_enterprise_member_header(t)),TS.menu.$menu_items.on("click.menu","li",s),TS.kb_nav.setSubmitItemHandler(s),TS.menu.start(r,null,{menu_class:"member_menu"});var n=$("[data-header-menu-toggle]"),a=-TS.menu.$menu.outerWidth()+n.outerWidth(),d=n.outerHeight()+i;TS.menu.positionAt(n,a,d),r.preventDefault()}},end:function(){TS.menu.member.member=null,TS.menu.end(),TS.menu.clean()}});var s=o(function(r){var i=$(this).attr("id");i!=="sign_out"&&i!=="view_account"&&(r.preventDefault(),TS.warn(`not sure what to do with clicked element id:${i}`))},"_onEnterpriseMemberHeaderClick")})()},7164614212:()=>{(function(){TS.registerModule("menu",{$menu:null,$submenu:null,$submenu_origin:null,$submenu_parent:null,$menu_header:null,$menu_items:null,$menu_list_container:null,$menu_list:null,$menu_footer:null,menu_lazy_load:null,user_group:null,$target_element:null,$secondary_target_element:null,large_dom_trigger:500,menu_items_hidden:!0,has_submenu:!1,menu_closed_sig:new signals.Signal,onStart:function(){},buildIfNeeded:_.once(function(){TS.menu.$menu=$(TS.templates.menu());var t=TS.menu.$menu;if(TS.boot_data.app!=="mobile"&&TS.qs_args.new_scroll!="0"){if(t.appendTo($("body")),!TS.environment.supports_custom_scrollbar){var n=TS.qs_args.debug_scroll=="1";t.find("#menu_items_scroller").monkeyScroll({debug:n})}t.detach()}TS.menu.$menu_header=t.find("#menu_header"),TS.menu.$menu_body=t.find(".menu_body"),TS.menu.$menu_list_container=t.find("#menu_list_container"),TS.menu.$menu_list=t.find("#menu_list"),TS.menu.$menu_items=t.find("#menu_items"),TS.menu.$menu_footer=t.find("#menu_footer")}),startWithList:function(t,n,a){if(!(!n||!n.length)&&!TS.menu.isRedundantClick(t))if(a=a||{},TS.menu.buildIfNeeded(),TS.menu.clean(),TS.menu.$menu_header.addClass("hidden").empty(),TS.menu.$menu_items.html(n.html()),TS.menu.$menu.addClass(a.menu_class),(a.close_on_click||a.onClick)&&TS.menu.$menu_items.on("click.menu","li",function(m){typeof a.onClick=="function"&&a.onClick(m),a.close_on_click&&TS.menu.end()}),TS.menu.start(t,void 0,a),a.attach_to_target_at_full_width)TS.menu.$menu.css({width:"100%",top:"calc(100% + 3px)",left:"0"});else{var d=i(a.align_right);TS.menu.positionAt(TS.menu.$target_element,d.left,d.top)}},did_start_slack_menu_signal_listeners:!1,stopListeningForRebuildWorthiness:function(){TS.menu.did_start_slack_menu_signal_listeners=!1},startWithEditTeamProfileListActions:function(t,n,a){if(!TS.menu.isRedundantClick(t)&&!TS.model.menu_is_showing){TS.menu.buildIfNeeded();var d=$(t.target),m=TS.team.getTeamProfileFieldById(d.data("id")),u={id:m.id,hidden:!!(m&&m.is_hidden),is_scim:a.is_scim};TS.menu.clean(),TS.menu.$menu_header.addClass("hidden").empty(),TS.menu.$menu_items.html(TS.templates.admin_menu_edit_team_profile_list_action_items(u)),TS.menu.$menu_items.on("click.menu","li",n),TS.menu.start(t),TS.menu.positionAt(d.find('[data-action="edit_team_profile_list_menu"]'),-(TS.menu.$menu.width()+6),0),TS.menu.keepInBounds()}},positionAt:function(t,n,a){n=n||0,a=a||0;var d=t.offset(),m=d.left+n,u=d.top+a;TS.menu.$menu.css({top:u,left:m})},isRedundantClick:function(t){return!!(t&&TS.menu.last_e&&(t.target==TS.menu.last_e.target||t.currentTarget==TS.menu.last_e.currentTarget))},isLarge:function(){return TS.menu&&TS.menu.$menu&&TS.menu.$menu.find("li").length>TS.menu.large_dom_trigger},start:function(t,n,a){if(a=a||{},TS.menu.last_e=t,!r){var d=$(t.target).offset(),m=d.left+$(t.target).width()+10,u=d.top;n&&(m=t.pageX+10,u=t.pageY+10)}_.isFunction(a.needs_to_remain_open)&&(TS.menu.needs_to_remain_open=a.needs_to_remain_open),$(".tooltip").hide(),TS.tips.hideAll(),$(t.currentTarget).addClass("active"),TS.menu.$target_element=$(t.currentTarget),TS.model.menu_is_showing=!0;var f=TS.menu.$menu;a.onClose&&f.one("closed",a.onClose),a.menu_class&&f.addClass(a.menu_class);var p=TS.menu.isLarge();r||f.css({top:u,left:m});var S=f.find("#menu_items_scroller");S.scrollTop(0),a.attach_to_target_at_full_width?TS.menu.$target_element.after(f):f.appendTo($("body")),a.keep_menu_open_if_target_clicked_again&&TS.menu.$menu.addClass("keep_menu_open_if_target_clicked_again"),!p&&!r?(f.css("opacity",0),f.stop().transition({opacity:1},200)):f.css("opacity",1),f.find(".menu_close").on("click",TS.menu.end),a.ignore_bounds||TS.menu.keepInBounds(),TS.ui.utility.updateClosestMonkeyScroller(S,!0),TS.menu.menu_lazy_load&&TS.menu.menu_lazy_load.detachEvents&&TS.menu.menu_lazy_load.detachEvents(),TS.menu.menu_lazy_load=TS.menu.$menu_items.find(".lazy").lazyload({container:$("#menu_items_scroller"),all_images_same_size:!0,throttle:250}),a.ignore_bounds||$(window).bind("resize",TS.menu.keepInBounds),$(window.document).bind("keydown",TS.menu.onKeyDown),$("html").bind("mousedown touchstart",TS.menu.onMouseDown);var v=f.find(".menu_list"),P=v.length?v:f.find("#menu_items");TS.menu.has_submenu?TS.kb_nav.start(P,"li:not(.divider)",f,{onLeftKeyDownIfSubmenuExists:TS.menu.onLeftKeyDownIfSubmenuExists,onRightKeyDownIfSubmenuExists:TS.menu.onRightKeyDownIfSubmenuExists}):TS.kb_nav.start(P,"li:not(.divider)");var C=v.length?v.first().find("a, button").first():null;TS.ui&&TS.ui.a11y&&TS.ui.a11y.focusAndAddTabindex(C),r=!1,s=a.on_esc},clean:function(){TS.menu.$menu_footer.empty(),TS.menu.$menu_header.removeClass("hidden"),TS.menu.$menu.removeClass("no_min_width no_max_width profile_preview flex_menu search_filter_menu popover_menu no_icons team_menu member_menu file_menu all_unreads_sort_order_menu searchable_member_list_filter_menu selectable member_file_filter_menu app_card keep_menu_open_if_target_clicked_again member_file_filter_menu").css("max-height",""),TS.menu.$menu.removeAttr("data-qa"),TS.menu.$menu.find("#menu_items_scroller").css("max-height",""),TS.menu.$menu.find(".arrow, .arrow_shadow").remove(),TS.menu.$menu_items.off("mouseenter.section_header"),TS.menu.$menu.removeClass("narrow_menu"),TS.menu.$menu_body.off("mouseenter.section_header"),TS.menu.needs_to_remain_open=void 0,TS.menu.$menu.removeClass("date_picker"),TS.boot_data.page_needs_enterprise&&(TS.menu.$menu_list_container.html('<div id="menu_list" role="menu"></div>').removeClass("populated"),TS.menu.$menu_list=TS.menu.$menu.find("#menu_list"),TS.menu.$menu.off("keydown","#file_member_filter .member_filter")),TS.menu.$menu.removeAttr("data-model-ob-id"),TS.menu.$menu.removeAttr("data-thread-ts"),TS.menu.$menu.find(".member_item")&&(TS.menu.$menu.find(".member_item").remove(),TS.menu.$menu.find(".list_items").css("height",0)),s=null},end:function(){if(!(_.isFunction(TS.menu.needs_to_remain_open)&&TS.menu.needs_to_remain_open())){TS.menu.$submenu&&TS.menu.$submenu_parent&&TS.menu.$submenu_parent.submenu("destroy"),TS.menu.$menu.width(""),TS.model.menu_is_showing=!1,TS.menu.menu_items_hidden=!0,TS.menu.has_submenu=!1,TS.menu.$submenu_parent=null,TS.menu.submenu_template_args={},TS.menu.did_start_slack_menu_signal_listeners&&TS.menu.stopListeningForRebuildWorthiness();var t=TS.menu.$menu,n=o(function(){TS.model.menu_is_showing||(setTimeout(function(){TS.model.menu_is_showing||(TS.menu.last_e=null)},50),t.detach(),TS.menu.$menu_header.empty(),TS.menu.$menu_footer.empty(),TS.menu.$menu_items.empty(),TS.menu.$menu_items.removeClass("hidden"),TS.menu.$menu_body.empty(),TS.menu.clean())},"menu_end");!TS.menu.isLarge()&&!r?t.stop().transition({opacity:0},200,n):n(),t.trigger("closed"),TS.menu.$target_element&&(TS.menu.$target_element.removeClass("active"),TS.menu.$target_element=null),TS.menu.$secondary_target_element&&(TS.menu.$secondary_target_element.removeClass("active"),TS.menu.$secondary_target_element=null),TS.menu.user_group=null,TS.menu.$menu_header.unbind("click.menu"),TS.menu.$menu_items.off("click.menu"),TS.menu.$menu_body.off("click.menu"),$(window).unbind("resize",TS.menu.keepInBounds),$(window.document).unbind("keydown",TS.menu.onKeyDown),$("html").unbind("mousedown touchstart",TS.menu.onMouseDown),TS.members.view.team_filter_changed_sig.remove(TS.kb_nav.clearHighlightedItem),$(".file_list_item.active").removeClass("active"),TS.tips.unhideAll(),TS.menu.search_filter_is_showing=!1,$("#search_filter_menu_label").removeClass("active"),$("#mentions_filter_menu_label").removeClass("active"),$("#flex_menu_toggle").removeClass("menu_open"),$("#channel_actions_toggle").removeClass("active"),t.removeClass("narrow_menu"),TS.menu.menu_lazy_load&&TS.menu.menu_lazy_load.detachEvents&&(TS.menu.menu_lazy_load.detachEvents(),TS.menu.menu_lazy_load=null),TS.kb_nav.end(),TS.menu.menu_closed_sig.dispatch()}},onKeyDown:function(t){var n=TS.utility.keymap,a=t.which,d=t.metaKey||t.ctrlKey||t.altKey;a==n.esc?(t.stopPropagation(),t.preventDefault(),TS.menu.end(),s&&s()):!d&&!TS.utility.isArrowKey(a)&&a!=n.tab&&a!=n.enter&&a!=n.shift&&TS.kb_nav.clearHighlightedItem()},onLeftKeyDownIfSubmenuExists:function(){var t=!1;if(TS.menu.$submenu&&TS.menu.$submenu.hasClass("kb_active")){TS.menu.$submenu.removeClass("kb_active"),TS.kb_nav.end(),TS.kb_nav.highlightItemWithKey(TS.menu.$submenu_origin);var n=TS.menu.$menu.find(".menu_list"),a=n.length?n:TS.menu.$menu.find("#menu_items");TS.kb_nav.start(a,"li:not(.divider)",TS.menu.$menu,{onLeftKeyDownIfSubmenuExists:TS.menu.onLeftKeyDownIfSubmenuExists,onRightKeyDownIfSubmenuExists:TS.menu.onRightKeyDownIfSubmenuExists}),["member_current_status_item","switch_teams"].indexOf(TS.menu.$submenu_origin.attr("id"))===-1&&TS.menu.$submenu_origin.submenu("destroy"),t=!0}return t},onRightKeyDownIfSubmenuExists:function(){var t=!1;return TS.menu.$submenu&&(TS.menu.$submenu.hasClass("kb_active")?(TS.menu.$submenu.removeClass("kb_active"),TS.menu.end()):(TS.menu.$submenu.addClass("kb_active"),TS.kb_nav.end(),TS.kb_nav.highlightItemWithKey(TS.menu.$submenu.find("li:not(.divider)").first()),TS.kb_nav.start(TS.menu.$submenu.find("ul"),"li:not(.divider)",TS.menu.$submenu,{onLeftKeyDownIfSubmenuExists:TS.menu.onLeftKeyDownIfSubmenuExists,onRightKeyDownIfSubmenuExists:TS.menu.onRightKeyDownIfSubmenuExists})),t=!0),t},onMouseDown:function(t){var n=$(t.target);TS.menu.$menu&&TS.menu.$menu.hasClass("keep_menu_open_if_target_clicked_again")&&n.is(TS.menu.$target_element)||(n.closest("#menu, .submenu, .trap_menu_clicks").length===0||n.hasClass("popover_mask"))&&TS.menu.end()},keepInBounds:function(){window.requestAnimationFrame?TS.utility.rAF(TS.menu.keepInBoundsThrottled):TS.menu.keepInBoundsThrottled()},keepInBoundsThrottled:function(){var t=TS.menu.$menu,n=10,a=t.dimensions_rect(),d={top:0+n,right:$(window).width()-n,bottom:$(window).height()-(n+14),left:0+n};TS.utility.doesRectContainRect(d,a)||(a.left<d.left?t.css("left",d.left):a.right>d.right&&t.css("left",Math.max(d.left,d.right-a.width)),a.top<d.top?t.css("top",d.top):a.bottom>d.bottom&&t.css("top",Math.max(d.top,d.bottom-a.height+$(window).scrollTop())))}});var r=!1,i=o(function(t){var n=3,a=TS.menu.$target_element.outerHeight()+n,d=0;return t&&(d=TS.menu.$target_element.outerWidth()-TS.menu.$menu.outerWidth()),{left:d,top:a}},"_getOffsets");$.widget("TS.submenu",{_create:function(){this.element.data("has-submenu",!0);var t=TS.interop.i18n.t("submenu","menu_source")(),n=`<div class="menu submenu${this.options.help?" submenu_help":""}" data-origin-id="${this.element.attr("id")}" data-model-ob-id="${this.element.data("modelObId")}"><ul aria-hidden="true" aria-label="${t}">${this.options.items_html}</ul></div>`,a=-13,d=11,m=TS.menu.$menu.offset().left+TS.menu.$menu.width()+a,u=this.element.offset().top-d;if(this.$submenu=$(n),this.$submenu.appendTo("body"),TS.menu.$submenu=this.$submenu,TS.menu.$submenu_origin=this.element,m+this.$submenu.width()>window.innerWidth){var f=TS.menu.$menu.offset().left-a,p=window.innerWidth-m;f>p&&(m=TS.menu.$menu.offset().left-this.$submenu.width()-a)}if(u+this.$submenu.height()>window.innerHeight){var S=u,v=Math.abs(window.innerHeight-(u+this.$submenu.height()));S>v?u=window.innerHeight-this.$submenu.height()-d:u=d}this.$submenu.css({position:"absolute",left:`${m}px`,top:`${u}px`});var P=this.options.onclick;P&&this.$submenu.on("click",function(C){P.call(this,C)})},_destroy:function(){TS.menu.$submenu=null,TS.menu.$submenu_origin=null,this.options.ondestroy&&this.options.ondestroy(),this.$submenu.remove()}})})();var s},7004812553:()=>{(function(){TS.registerModule("mpims",{onStart:function(){TS.prefs.display_real_names_override_changed_sig.add(r),TS.prefs.team_display_real_names_changed_sig.add(r),TS.members.changed_profile_sig.add(s)},legacyGetMembersInDisplayOrder:function(a){if(a){var d=TS.model&&TS.model.user?TS.model.user.id:TS.boot_data.user_id;return _.chain(a.members).without(d).map(m=>TS.redux.members.getPotentiallyUnknownMemberById(m)).compact().value()}},legacyGetDisplayName:function(a,d,m,u,f){var p=_.isInteger(u);return a._display_name&&!d&&!m&&!p&&!f?a._display_name:a._display_name_truncated&&!d&&!m&&!f&&p?a._display_name_truncated:f?n(a):t(a,d)},getMemberCount:function(a){return a&&a.members?Math.min(Math.max((a.members.length||1)-1,2),9):null},checkMpimMatch:function(a,d,m){if(a){for(var u=!0,f=!0,p=TS.mpims.legacyGetMembersInDisplayOrder(a),S=0;S<d.length;S+=1){for(var v=!1,P=0;P<p.length;P+=1)(TS.utility.members.checkMemberMatch(p[P],d[S],u)||m&&TS.utility.members.checkMemberMatch(p[P],m[S],u))&&(v=!0);v||(f=!1)}return f}}});var s=o(function(a){TS.model.mpims.forEach(function(d){d.members.indexOf(a.id)!==-1&&i(d)})},"_memberRealNameChanged"),r=o(function(){TS.model.mpims.forEach(i)},"_realNamePrefChanged"),i=o(function(a){a._display_name=void 0},"_clearDisplayNameCache"),t=o(function(a){var d=TS.mpims.legacyGetMembersInDisplayOrder(a);if(_.find(d,"is_unknown"))return"";var u=_(d).map(function(p){var S=TS.interop.rules.members.getPrefCompliantMemberName(p);return S}).compact().value(),f=u.join(", ");return a._display_name=f,f},"_getDisplayTitle"),n=o(function(a){var d=TS.mpims.legacyGetMembersInDisplayOrder(a),m=d.map(function(f){return TS.interop.rules.members.getPrefCompliantMemberName(f)}),u=TS.interop.i18n.listify(m,{strong:!0}).join("");return u},"_getDmBadgeDisplayName")})()},1515948675:()=>{(function(){TS.registerModule("prefs",{all_notifications_prefs_changed_sig:new signals.Signal,highlight_words_changed_sig:new signals.Signal,seen_welcome_2_changed_sig:new signals.Signal,emoji_mode_changed_sig:new signals.Signal,obey_inline_img_limit_changed_sig:new signals.Signal,messages_theme_changed_sig:new signals.Signal,expand_inline_imgs_changed_sig:new signals.Signal,expand_internal_inline_imgs_changed_sig:new signals.Signal,expand_non_media_attachments_changed_sig:new signals.Signal,webapp_spellcheck_changed_sig:new signals.Signal,color_names_in_list_changed_sig:new signals.Signal,search_exclude_channels_changed_sig:new signals.Signal,box_enabled_changed_sig:new signals.Signal,dropbox_enabled_changed_sig:new signals.Signal,read_changed_sig:new signals.Signal,push_changed_sig:new signals.Signal,time24_changed_sig:new signals.Signal,sidebar_behavior_changed_sig:new signals.Signal,dtop_notif_changed_sig:new signals.Signal,muted_channels_changed_sig:new signals.Signal,mac_ssb_bullet_changed_sig:new signals.Signal,team_hide_referers_changed_sig:new signals.Signal,sidebar_theme_changed_sig:new signals.Signal,no_invites_widget_in_sidebar_changed_sig:new signals.Signal,k_key_omnibox_auto_hide_count_changed_sig:new signals.Signal,display_real_names_override_changed_sig:new signals.Signal,team_display_real_names_changed_sig:new signals.Signal,team_perms_pref_changed_sig:new signals.Signal,privacy_policy_seen_changed_sig:new signals.Signal,two_factor_update_seen_changed_sig:new signals.Signal,compliance_export_start_changed_sig:new signals.Signal,team_disallow_public_file_urls_changed_sig:new signals.Signal,mentions_exclude_at_channels_changed_sig:new signals.Signal,mentions_exclude_at_user_groups_changed_sig:new signals.Signal,team_auth_mode_changed_sig:new signals.Signal,team_sso_auth_restrictions_changed_sig:new signals.Signal,preferred_skin_tone_changed_sig:new signals.Signal,separate_private_channels_changed_sig:new signals.Signal,separate_shared_channels_changed_sig:new signals.Signal,whats_new_read_changed_sig:new signals.Signal,team_dnd_enabled_changed_sig:new signals.Signal,team_dnd_start_hour_changed_sig:new signals.Signal,team_dnd_end_hour_changed_sig:new signals.Signal,team_invites_only_admins_changed_sig:new signals.Signal,tz_changed_sig:new signals.Signal,keyboard_changed_sig:new signals.Signal,msg_input_send_btn_changed_sig:new signals.Signal,msg_input_send_btn_auto_set_changed_sig:new signals.Signal,team_allow_calls_changed_sig:new signals.Signal,team_calling_app_name_changed_sig:new signals.Signal,team_calling_app_id_changed_sig:new signals.Signal,frecency_jumper_changed_sig:new signals.Signal,jumbomoji_changed_sig:new signals.Signal,hide_hex_swatch_changed_sig:new signals.Signal,channel_sort_changed_sig:new signals.Signal,show_memory_instrument_changed_sig:new signals.Signal,enable_unread_view_changed_sig:new signals.Signal,enable_react_emoji_picker_changed_sig:new signals.Signal,team_disable_file_editing_changed_sig:new signals.Signal,team_disable_file_deleting_changed_sig:new signals.Signal,team_display_email_addresses_changed_sig:new signals.Signal,email_alerts_changed_sig:new signals.Signal,team_uses_customized_custom_status_presets_changed_sig:new signals.Signal,team_loud_channel_mentions_limit_changed_sig:new signals.Signal,locale_changed_sig:new signals.Signal,enable_shared_channels_changed_sig:new signals.Signal,prefs_loaded:!1,setPrefs:function(r){var i=TS.prefs.getPref("muted_channels");TS.redux.prefs.setUserPrefs(r),TS.prefs.prefs_loaded=!0,TS.prefs.mergeFrecencyJumper(TS.ui.frecency.isEnterprise()?TS.prefs.getPref("frecency_ent_jumper"):TS.prefs.getPref("frecency_jumper")),TS.prefs.setLoudChannels(TS.prefs.getPref("loud_channels")),TS.prefs.setSuppressedChannels(TS.prefs.getPref("at_channel_suppressed_channels")),TS.prefs.setPushSuppressedChannels(TS.prefs.getPref("push_at_channel_suppressed_channels")),TS.prefs.setNeverChannels(TS.prefs.getPref("never_channels")),TS.prefs.setMutedChannels(TS.prefs.getPref("muted_channels"),i),TS.prefs.setLoudChannelsSet(TS.prefs.getPref("loud_channels_set")),TS.prefs.setPushLoudChannels(TS.prefs.getPref("push_loud_channels")),TS.prefs.setPushMentionChannels(TS.prefs.getPref("push_mention_channels")),TS.prefs.setPushLoudChannelsSet(TS.prefs.getPref("push_loud_channels_set")),TS.prefs.setSearchExcludeChannels(TS.prefs.getPref("search_exclude_channels")),TS.prefs.setChannelSort(TS.prefs.getPref("channel_sort")),TS.prefs.setSidebarThemeCustomValues(TS.utility.parseJSONOrElse(TS.prefs.getPref("sidebar_theme_custom_values"),void 0)),TS.prefs.setTheme(),TS.prefs.setPrefLocal("emoji_autocomplete_big",!1)},setChannelSort:function(r){TS.model.channel_sort=r},setHighlightWords:function(r){TS.prefs.setPrefLocal("highlight_words",r)},setSuppressedChannels:function(r){let{skipSettingLocalPref:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i||TS.prefs.setPrefLocal("at_channel_suppressed_channels",r),TS.model.at_channel_suppressed_channels=[],r&&typeof r=="string"&&(TS.model.at_channel_suppressed_channels=TS.model.at_channel_suppressed_channels.concat(r.split(",")))},setPushSuppressedChannels:function(r){let{skipSettingLocalPref:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i||TS.prefs.setPrefLocal("push_at_channel_suppressed_channels",r),TS.model.push_at_channel_suppressed_channels=[],r&&typeof r=="string"&&(TS.model.push_at_channel_suppressed_channels=TS.model.push_at_channel_suppressed_channels.concat(r.split(",")))},setLoudChannels:function(r){let{skipSettingLocalPref:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i||TS.prefs.setPrefLocal("loud_channels",r),TS.model.loud_channels=[],r&&typeof r=="string"&&(TS.model.loud_channels=TS.model.loud_channels.concat(r.split(",")))},setNeverChannels:function(r){let{skipSettingLocalPref:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i||TS.prefs.setPrefLocal("never_channels",r),TS.model.never_channels=[],r&&typeof r=="string"&&(TS.model.never_channels=TS.model.never_channels.concat(r.split(",")))},setMutedChannels:function(r,i){var t;if(i||(i=TS.prefs.getPref("muted_channels")),i!==r||!s)t=TS.prefs.getPref("muted_channels")&&typeof TS.prefs.getPref("muted_channels")=="string"?TS.prefs.getPref("muted_channels").split(","):[],TS.prefs.setPrefLocal("muted_channels",r);else return;s=!0;var n,a,d=[],m=[];r&&typeof r=="string"&&(d=d.concat(r.split(",")),m=_.difference(t,d));const u=!1;for(n=0;n<d.length;n+=1)a=TS.redux.channels.getEntityById(d[n],u),a&&a.unread_cnt&&(a._show_in_list_even_though_no_unreads=!0);return TS.model.channels.forEach(function(f){TS.notifs.isCorGMuted(f.id)||(f._show_in_list_even_though_no_unreads=!1)}),TS.model.groups.forEach(function(f){TS.notifs.isCorGMuted(f.id)||(f._show_in_list_even_though_no_unreads=!1)}),TS.redux.channels.updateMutedChannels(d),m},setLoudChannelsSet:function(r){let{skipSettingLocalPref:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i||TS.prefs.setPrefLocal("loud_channels_set",r),TS.model.loud_channels_set=[],r&&typeof r=="string"&&(TS.model.loud_channels_set=TS.model.loud_channels_set.concat(r.split(",")))},setPushLoudChannels:function(r){let{skipSettingLocalPref:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i||TS.prefs.setPrefLocal("push_loud_channels",r),TS.model.push_loud_channels=[],r&&typeof r=="string"&&(TS.model.push_loud_channels=TS.model.push_loud_channels.concat(r.split(",")))},setPushMentionChannels:function(r){let{skipSettingLocalPref:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i||TS.prefs.setPrefLocal("push_mention_channels",r),TS.model.push_mention_channels=[],r&&typeof r=="string"&&(TS.model.push_mention_channels=TS.model.push_mention_channels.concat(r.split(",")))},setPushLoudChannelsSet:function(r){let{skipSettingLocalPref:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i||TS.prefs.setPrefLocal("push_loud_channels_set",r),TS.model.push_loud_channels_set=[],r&&typeof r=="string"&&(TS.model.push_loud_channels_set=TS.model.push_loud_channels_set.concat(r.split(",")))},setSearchExcludeChannels:function(r){let{skipSettingLocalPref:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i||TS.prefs.setPrefLocal("search_exclude_channels",r),TS.model.search_exclude_channels=[],r&&typeof r=="string"&&(TS.model.search_exclude_channels=TS.model.search_exclude_channels.concat(r.split(",")))},mergeFrecencyJumper:function(r){return(!r||typeof r!="object")&&(r=TS.utility.parseJSONOrElse(r||null)||{}),TS.model.frecency_jumper=r,!0},setTheme:function(){TS.prefs.getPref("messages_theme")==="default"&&TS.prefs.setPrefLocal("messages_theme","light_with_avatars"),TS.prefs.setPrefLocal("theme","light"),TS.prefs.setPrefLocal("avatars",!0),TS.prefs.getPref("messages_theme")==="dense"?(TS.prefs.setPrefLocal("theme","dense"),TS.prefs.setPrefLocal("avatars",!1)):TS.prefs.getPref("messages_theme")==="light"?(TS.prefs.setPrefLocal("theme","light"),TS.prefs.setPrefLocal("avatars",!1)):TS.prefs.getPref("messages_theme")==="light_with_avatars"&&(TS.prefs.setPrefLocal("theme","light"),TS.prefs.setPrefLocal("avatars",!0))},legacyOnTeamPrefChanged:function(r){r.name==="msg_edit_window_mins"?TS.prefs.setTeamPrefLocal("msg_edit_window_mins",r.value):r.name==="allow_message_deletion"?TS.prefs.setTeamPrefLocal("allow_message_deletion",!!r.value):r.name==="hide_referers"?(TS.prefs.setTeamPrefLocal("hide_referers",!!r.value),TS.prefs.team_hide_referers_changed_sig.dispatch()):r.name==="display_real_names"?(TS.prefs.setTeamPrefLocal("display_real_names",!!r.value),TS.prefs.team_display_real_names_changed_sig.dispatch()):r.name==="display_email_addresses"?(TS.prefs.setTeamPrefLocal("display_email_addresses",!!r.value),TS.prefs.team_display_email_addresses_changed_sig.dispatch()):r.name.indexOf("who_can_")===0?TS.prefs.getTeamPref(r.name)!=r.value&&(TS.prefs.setTeamPrefLocal(r.name,r.value),TS.prefs.team_perms_pref_changed_sig.dispatch(r.name)):r.name==="compliance_export_start"?TS.prefs.getTeamPref("compliance_export_start")!=r.value&&(TS.prefs.setTeamPrefLocal("compliance_export_start",r.value),TS.prefs.compliance_export_start_changed_sig.dispatch()):r.name==="disallow_public_file_urls"?(TS.prefs.setTeamPrefLocal("disallow_public_file_urls",!!r.value),TS.prefs.team_disallow_public_file_urls_changed_sig.dispatch()):r.name==="auth_mode"?(TS.prefs.setTeamPrefLocal("auth_mode",r.value),TS.prefs.team_auth_mode_changed_sig.dispatch()):r.name==="sso_auth_restrictions"?(TS.prefs.setTeamPrefLocal("sso_auth_restrictions",r.value),TS.prefs.team_sso_auth_restrictions_changed_sig.dispatch()):r.name==="dnd_enabled"?(TS.prefs.setTeamPrefLocal("dnd_enabled",r.value),TS.prefs.team_dnd_enabled_changed_sig.dispatch()):r.name==="dnd_start_hour"?(TS.prefs.setTeamPrefLocal("dnd_start_hour",r.value),TS.prefs.team_dnd_start_hour_changed_sig.dispatch()):r.name==="dnd_end_hour"?(TS.prefs.setTeamPrefLocal("dnd_end_hour",r.value),TS.prefs.team_dnd_end_hour_changed_sig.dispatch()):r.name==="invites_only_admins"?(TS.prefs.setTeamPrefLocal("invites_only_admins",r.value),TS.prefs.team_invites_only_admins_changed_sig.dispatch()):r.name==="allow_calls"?(TS.prefs.setTeamPrefLocal("allow_calls",r.value),TS.prefs.team_allow_calls_changed_sig.dispatch()):r.name==="calling_app_id"?(TS.prefs.setTeamPrefLocal("calling_app_id",r.value),TS.prefs.team_calling_app_id_changed_sig.dispatch()):r.name==="calling_app_name"?(TS.prefs.setTeamPrefLocal("calling_app_name",r.value),TS.prefs.team_calling_app_name_changed_sig.dispatch()):r.name==="disable_file_editing"?(TS.prefs.setTeamPrefLocal("disable_file_editing",r.value),TS.prefs.team_disable_file_editing_changed_sig.dispatch()):r.name==="disable_file_deleting"?(TS.prefs.setTeamPrefLocal("disable_file_deleting",r.value),TS.prefs.team_disable_file_deleting_changed_sig.dispatch()):r.name==="uses_customized_custom_status_presets"?(TS.prefs.setTeamPrefLocal(r.name,r.value),TS.prefs.team_uses_customized_custom_status_presets_changed_sig.dispatch()):r.name==="loud_channel_mentions_limit"?(TS.prefs.setTeamPrefLocal(r.name,r.value),TS.prefs.team_loud_channel_mentions_limit_changed_sig.dispatch()):r.name==="enable_shared_channels"?(TS.prefs.setTeamPrefLocal(r.name,r.value),TS.prefs.enable_shared_channels_changed_sig.dispatch()):r.name==="dropbox_legacy_picker"?(TS.prefs.setTeamPrefLocal(r.name,r.value),TS.prefs.dropbox_enabled_changed_sig.dispatch()):TS.prefs.setTeamPrefLocal(r.name,r.value)},getPref:function(r){return TS.redux.prefs.getUserPref(r)},setPrefLocal:function(r,i){TS.redux.prefs.setUserPref(r,i)},getTeamPref:function(r){return TS.redux.prefs.getTeamPref(r)},setTeamPrefLocal:function(r,i){TS.redux.prefs.setTeamPref(r,i)},legacyOnPrefChanged:function(r){switch(r.name){case"all_notifications_prefs":TS.prefs.setPrefLocal("all_notifications_prefs",r.value),TS.prefs.all_notifications_prefs_changed_sig.dispatch(r.value);break;case"locale":TS.prefs.setPrefLocal("locale",r.value),TS.prefs.locale_changed_sig.dispatch(r.value);break;case"flannel_server_pool":TS.prefs.setPrefLocal("flannel_server_pool",r.value);break;case"color_names_in_list":TS.prefs.setPrefLocal("color_names_in_list",!!r.value),TS.prefs.color_names_in_list_changed_sig.dispatch();break;case"display_real_names_override":TS.prefs.setPrefLocal("display_real_names_override",r.value),TS.prefs.display_real_names_override_changed_sig.dispatch();break;case"growls_enabled":TS.prefs.setPrefLocal("growls_enabled",!!r.value),TS.prefs.dtop_notif_changed_sig.dispatch();break;case"sidebar_theme":TS.prefs.getPref("sidebar_theme")!==r.value&&(TS.prefs.setPrefLocal("sidebar_theme",r.value),TS.prefs.sidebar_theme_changed_sig.dispatch());break;case"sidebar_theme_custom_values":TS.prefs.getPref("sidebar_theme_custom_values")!==r.value&&(TS.prefs.setSidebarThemeCustomValues(JSON.parse(r.value)),TS.prefs.sidebar_theme_changed_sig.dispatch());break;case"expand_inline_imgs":TS.prefs.setPrefLocal("expand_inline_imgs",!!r.value),TS.prefs.expand_inline_imgs_changed_sig.dispatch();break;case"webapp_spellcheck":TS.prefs.setPrefLocal("webapp_spellcheck",!!r.value),TS.prefs.webapp_spellcheck_changed_sig.dispatch();break;case"expand_internal_inline_imgs":TS.prefs.setPrefLocal("expand_internal_inline_imgs",!!r.value),TS.prefs.expand_internal_inline_imgs_changed_sig.dispatch();break;case"expand_non_media_attachments":TS.prefs.setPrefLocal("expand_non_media_attachments",!!r.value),TS.prefs.expand_non_media_attachments_changed_sig.dispatch();break;case"messages_theme":TS.prefs.setPrefLocal("messages_theme",r.value),TS.prefs.setTheme(),TS.prefs.messages_theme_changed_sig.dispatch();break;case"highlight_words":TS.prefs.setHighlightWords(r.value),TS.prefs.highlight_words_changed_sig.dispatch();break;case"at_channel_suppressed_channels":TS.prefs.setSuppressedChannels(r.value),TS.prefs.dtop_notif_changed_sig.dispatch();break;case"push_at_channel_suppressed_channels":TS.prefs.setPushSuppressedChannels(r.value),TS.prefs.push_changed_sig.dispatch();break;case"loud_channels":TS.prefs.setLoudChannels(r.value);break;case"never_channels":TS.prefs.setNeverChannels(r.value);break;case"muted_channels":TS.prefs.setMutedChannels(r.value),TS.prefs.muted_channels_changed_sig.dispatch();break;case"loud_channels_set":TS.prefs.setLoudChannelsSet(r.value),TS.prefs.dtop_notif_changed_sig.dispatch();break;case"push_loud_channels":TS.prefs.setPushLoudChannels(r.value);break;case"push_mention_channels":TS.prefs.setPushMentionChannels(r.value);break;case"push_loud_channels_set":TS.prefs.setPushLoudChannelsSet(r.value),TS.prefs.push_changed_sig.dispatch();break;case"emoji_use":break;case"user_colors":break;case"graphic_emoticons":TS.prefs.setPrefLocal("graphic_emoticons",r.value),TS.prefs.emoji_mode_changed_sig.dispatch();break;case"ss_emojis":TS.prefs.setPrefLocal("ss_emojis",r.value),TS.prefs.emoji_mode_changed_sig.dispatch();break;case"obey_inline_img_limit":TS.prefs.setPrefLocal("obey_inline_img_limit",r.value),TS.prefs.obey_inline_img_limit_changed_sig.dispatch();break;case"search_only_my_channels":case"search_only_current_team":case"search_exclude_bots":break;case"search_exclude_channels":TS.prefs.setSearchExcludeChannels(r.value),TS.prefs.search_exclude_channels_changed_sig.dispatch();break;case"has_uploaded":TS.prefs.setPrefLocal("has_uploaded",!!r.value);break;case"has_invited":TS.prefs.setPrefLocal("has_invited",!!r.value);break;case"has_created_channel":TS.prefs.setPrefLocal("has_created_channel",!!r.value);break;case"no_joined_overlays":TS.prefs.setPrefLocal("no_joined_overlays",!!r.value);break;case"no_created_overlays":TS.prefs.setPrefLocal("no_created_overlays",!!r.value);break;case"seen_welcome_2":TS.prefs.setPrefLocal("seen_welcome_2",!!r.value),TS.prefs.seen_welcome_2_changed_sig.dispatch();break;case"box_enabled":TS.prefs.setPrefLocal("box_enabled",!!r.value),TS.prefs.box_enabled_changed_sig.dispatch();break;case"dropbox_enabled":TS.prefs.setPrefLocal("dropbox_enabled",!!r.value),TS.prefs.dropbox_enabled_changed_sig.dispatch();break;case"mark_msgs_read_immediately":TS.prefs.getPref("mark_msgs_read_immediately")!==!!r.value&&(TS.prefs.setPrefLocal("mark_msgs_read_immediately",!!r.value),TS.prefs.read_changed_sig.dispatch());break;case"start_scroll_at_oldest":TS.prefs.getPref("start_scroll_at_oldest")!==!!r.value&&(TS.prefs.setPrefLocal("start_scroll_at_oldest",!!r.value),TS.prefs.read_changed_sig.dispatch());break;case"mac_ssb_bullet":TS.prefs.getPref("mac_ssb_bullet")!==!!r.value&&(TS.prefs.setPrefLocal("mac_ssb_bullet",!!r.value),TS.prefs.mac_ssb_bullet_changed_sig.dispatch());break;case"all_channels_loud":TS.prefs.getPref("all_channels_loud")!==!!r.value&&(TS.prefs.setPrefLocal("all_channels_loud",!!r.value),TS.prefs.dtop_notif_changed_sig.dispatch());break;case"push_everything":TS.prefs.getPref("push_everything")!==!!r.value&&(TS.prefs.setPrefLocal("push_everything",!!r.value),TS.prefs.push_changed_sig.dispatch());break;case"push_mention_alert":TS.prefs.getPref("push_mention_alert")!==!!r.value&&(TS.prefs.setPrefLocal("push_mention_alert",!!r.value),TS.prefs.push_changed_sig.dispatch());break;case"push_dm_alert":TS.prefs.getPref("push_dm_alert")!==!!r.value&&(TS.prefs.setPrefLocal("push_dm_alert",!!r.value),TS.prefs.push_changed_sig.dispatch());break;case"time24":TS.prefs.getPref("time24")!==!!r.value&&(TS.prefs.setPrefLocal("time24",!!r.value),TS.prefs.time24_changed_sig.dispatch());break;case"sidebar_behavior":TS.prefs.getPref("sidebar_behavior")!=r.value&&(TS.prefs.setPrefLocal("sidebar_behavior",r.value),TS.prefs.sidebar_behavior_changed_sig.dispatch());break;case"two_factor_update_seen":TS.model.two_factor_update_seen!=r.value&&(TS.mode.prefs.two_factor_update_seen=r.value,TS.prefs.two_factor_update_seen_changed_sig.dispatch());break;case"privacy_policy_seen":TS.prefs.getPref("privacy_policy_seen")!=r.value&&(TS.prefs.setPrefLocal("privacy_policy_seen",r.value),TS.prefs.privacy_policy_seen_changed_sig.dispatch());break;case"last_seen_at_channel_warning":TS.prefs.getPref("last_seen_at_channel_warning")!=r.value&&TS.prefs.setPrefLocal("last_seen_at_channel_warning",r.value);break;case"mentions_exclude_at_channels":TS.prefs.getPref("mentions_exclude_at_channels")!=r.value&&(TS.prefs.setPrefLocal("mentions_exclude_at_channels",r.value),TS.prefs.mentions_exclude_at_channels_changed_sig.dispatch());break;case"mentions_exclude_at_user_groups":TS.prefs.getPref("mentions_exclude_at_user_groups")!=r.value&&(TS.prefs.setPrefLocal("mentions_exclude_at_user_groups",r.value),TS.prefs.mentions_exclude_at_user_groups_changed_sig.dispatch());break;case"no_invites_widget_in_sidebar":TS.prefs.getPref("no_invites_widget_in_sidebar")!=r.value&&(TS.prefs.setPrefLocal("no_invites_widget_in_sidebar",r.value),TS.prefs.no_invites_widget_in_sidebar_changed_sig.dispatch());break;case"k_key_omnibox_auto_hide_count":TS.prefs.getPref("k_key_omnibox_auto_hide_count")!=r.value&&(TS.prefs.setPrefLocal("k_key_omnibox_auto_hide_count",r.value),TS.prefs.k_key_omnibox_auto_hide_count_changed_sig.dispatch());break;case"show_sidebar_quickswitcher_button":TS.prefs.getPref("show_sidebar_quickswitcher_button")!=r.value&&TS.prefs.setPrefLocal("show_sidebar_quickswitcher_button",r.value);break;case"preferred_skin_tone":TS.prefs.getPref("preferred_skin_tone")!=r.value&&(TS.prefs.setPrefLocal("preferred_skin_tone",r.value),TS.prefs.preferred_skin_tone_changed_sig.dispatch());break;case"separate_private_channels":TS.prefs.getPref("separate_private_channels")!=r.value&&(TS.prefs.setPrefLocal("separate_private_channels",r.value),TS.prefs.separate_private_channels_changed_sig.dispatch());break;case"separate_shared_channels":TS.prefs.getPref("separate_shared_channels")!=r.value&&(TS.prefs.setPrefLocal("separate_shared_channels",r.value),TS.prefs.separate_shared_channels_changed_sig.dispatch());break;case"whats_new_read":TS.prefs.getPref("whats_new_read")!=r.value&&(TS.prefs.setPrefLocal("whats_new_read",r.value),TS.prefs.whats_new_read_changed_sig.dispatch());break;case"tz":TS.prefs.getPref("tz")!=r.value&&(TS.prefs.setPrefLocal("tz",r.value),TS.prefs.tz_changed_sig.dispatch());break;case"keyboard":TS.prefs.getPref("keyboard")!=r.value&&(TS.prefs.setPrefLocal("keyboard",r.value),TS.prefs.keyboard_changed_sig.dispatch());break;case"msg_input_send_btn":TS.prefs.getPref("msg_input_send_btn")!=r.value&&(TS.prefs.setPrefLocal("msg_input_send_btn",r.value),TS.prefs.msg_input_send_btn_changed_sig.dispatch());break;case"msg_input_send_btn_auto_set":TS.prefs.getPref("msg_input_send_btn_auto_set")!=r.value&&(TS.prefs.setPrefLocal("msg_input_send_btn_auto_set",r.value),TS.prefs.msg_input_send_btn_auto_set_changed_sig.dispatch());break;case"frecency_jumper":if(TS.ui.frecency.isEnterprise())break;TS.prefs.conditionallyClogFrecencyDueToSizeChange("PREF_USER_TEAM_FRECENCY_SHRINKAGE",JSON.stringify(TS.model.frecency_jumper),r.value),TS.prefs.mergeFrecencyJumper(r.value)&&TS.prefs.frecency_jumper_changed_sig.dispatch();break;case"frecency_ent_jumper":TS.prefs.conditionallyClogFrecencyDueToSizeChange("PREF_USER_ORG_FRECENCY_SHRINKAGE",JSON.stringify(TS.model.frecency_jumper),r.value),TS.log(666,"Received a pref_change event for frecency_ent_jumper."),TS.prefs.mergeFrecencyJumper(r.value)&&TS.prefs.frecency_jumper_changed_sig.dispatch();break;case"jumbomoji":TS.prefs.getPref("jumbomoji")!=r.value&&(TS.prefs.setPrefLocal("jumbomoji",r.value),TS.prefs.jumbomoji_changed_sig.dispatch());break;case"hide_hex_swatch":TS.prefs.getPref("hide_hex_swatch")!=r.value&&(TS.prefs.setPrefLocal("hide_hex_swatch",r.value),TS.prefs.hide_hex_swatch_changed_sig.dispatch());break;case"a11y_animations":TS.prefs.getPref("a11y_animations")!==r.value&&TS.prefs.setPrefLocal("a11y_animations",r.value);break;case"show_memory_instrument":TS.prefs.getPref("show_memory_instrument")!==r.value&&(TS.prefs.setPrefLocal("show_memory_instrument",r.value),TS.prefs.show_memory_instrument_changed_sig.dispatch());break;case"channel_sort":TS.prefs.getPref("channel_sort")!==r.value&&(TS.prefs.setPrefLocal("channel_sort",r.value),TS.prefs.setChannelSort(TS.prefs.getPref("channel_sort")),TS.prefs.channel_sort_changed_sig.dispatch());break;case"enable_unread_view":TS.prefs.getPref("enable_unread_view")!==r.value&&(TS.prefs.setPrefLocal("enable_unread_view",r.value),TS.prefs.enable_unread_view_changed_sig.dispatch());break;case"enable_react_emoji_picker":TS.prefs.getPref("enable_react_emoji_picker")!==r.value&&(TS.prefs.setPrefLocal("enable_react_emoji_picker",r.value),TS.prefs.enable_react_emoji_picker_changed_sig.dispatch());break;case"client_logs_pri":TS.prefs.setPrefLocal(r.name,r.value),TS.console.setAppropriatePri();break;case"email_alerts":TS.prefs.setPrefLocal(r.name,r.value),TS.prefs.email_alerts_changed_sig.dispatch();break;default:TS.prefs.setPrefLocal(r.name,r.value)}},hex_regex:/^#?([0-9a-f]{6})$/i,conditionallyClogFrecencyDueToSizeChange:function(r,i,t){t.length/i.length<.1&&TS.interop.clog.track(r,{updated_user_client_prefs:{existing_frecency:i,new_frecency:t}})},setSidebarThemeCustomValues:function(r){var i=!1;r&&typeof r=="object"&&r.length===void 0&&_.forOwn(r,function(t,n){if(i=!1,!t||!t.substr||(r[n]=t.substr(0,7),!t.match(TS.prefs.hex_regex)))return!1;i=!0}),i?TS.prefs.setPrefLocal("sidebar_theme_custom_values",JSON.stringify(r)):(TS.prefs.setPrefLocal("sidebar_theme","default"),TS.prefs.setPrefLocal("sidebar_theme_custom_values",JSON.stringify(TS.sidebar_themes.default_themes.default_theme)))},setPrefByAPI:function(r,i){return TS.interop.api.callExpedited("users.prefs.set",r).then(function(t){const{data:a,args:d}=t;if(a&&a.prefs&&d){const m=d.name&&[d.name]||_.keys(TS.interop.url.queryStringParse(d.prefs));_.forEach(m,u=>TS.prefs.legacyOnPrefChanged({name:u,value:a.prefs[u]}))}if(i)return i(!0,a,d)}).catch(function(t){const{args:n}=t;var a;n.hasOwnProperty("name")?a=`pref name: ${n.name}`:n.prefs&&(a="(multiple prefs)"),TS.interop.utility.getLogger({getState:TS.redux.getState}).error(a,"TS.prefs.setPrefByAPI call got a not ok rsp",{subtype:"API response error"}),setTimeout(function(){n.prefs?TS.error("multi preferences setting failed."):TS.error(`"${n.name}" preference setting failed.`)},0)})},setTeamPrefByAPI:function(r,i,t){return TS.interop.api.callExpedited("team.prefs.set",{prefs:JSON.stringify(r)}).then(function(n){const{data:a}=n;if(TS.web){t=t||[];var d=Object.keys(r).concat(t);d.forEach(function(m){a.prefs.hasOwnProperty(m)&&(r.hasOwnProperty(m)||TS.prefs.getTeamPref(m)!==a.prefs[m])&&TS.prefs.legacyOnTeamPrefChanged({name:m,value:a.prefs[m]})})}return Promise.resolve(a.prefs)}).catch(function(n){const{data:a}=n;return i&&i(a),Promise.reject(a)})},removeTeamFromEnterpriseExcludeTeamPref:function(r){if(!TS.boot_data.page_needs_enterprise)return;const i=TS.prefs.getPref("enterprise_excluded_app_teams");if(!i)return;const t=i?i.split(","):[];_.pull(t,r),TS.prefs.setPrefByAPI({name:"enterprise_excluded_app_teams",value:t.join(",")})}});var s=!1})()},1386085343:()=>{(function(){TS.registerModule("redux.bots",{bulkUpsertBots:function(s){_.isArray(s)&&TS.redux.dispatch(TS.interop.redux.models.bots.bulkUpsertBots({bots:s}))}})})()},3657898688:()=>{(function(){TS.registerModule("redux.channels.interop",{maybeWrapEntity:function(H){return!H||!H.id?H:Y(H.id)}});var s=TS.interop.channels.getChannelById,r={},i={},t={},n=o(function(){var H=window.Proxy&&Q();return H},"_shouldWrapEntityInProxyObject"),a=o(function(H,F,ee){if(!(!H||!F)){var c={id:H};c[F]=ee,TS.interop.channels.updateOneKeyForChannel(c)}},"_updateOneKeyForChannel"),d=["_show_in_list_even_though_no_unreads","deleted","has_draft","is_archived","is_frozen","is_channel","is_ext_shared","is_group","is_im","is_member","is_mpim","is_open","is_org_shared","is_pending_ext_shared","is_starred","last_read","members","priority","unread_cnt","unread_highlight_cnt","internalTeamIds","pendingAndConnectedTeamIds"],m=["_display_name","_archive_msgs","_checking_at_channel_status","_delayed_fetch_timer","_did_defer_initial_msg_history","_display_name_lc","_display_name_truncated","_i18n_ns_history","_i18n_ns","_internal_name","_jumper_previous_name_match","_latest_via_users_counts","_mark_most_recent_read_timer","_marked_reason","_members","_mention_count_display_via_users_counts","_name_lc","_prev_last_read","_score","_users_counts_info","active_members","can_thread","create_channel","created","creator","date_created","enterprise_id","fetched_history_after_scrollback_time","has_fetched_history_after_scrollback","has_pins","history_changed","history_fetch_failed","history_fetch_retries","history_is_being_fetched","id","inherit","is_default","is_general","is_global_shared","is_limited","is_moved","is_non_threadable","is_org_default","is_org_mandatory","is_private","is_read_only","is_thread_only","last_made_active","last_msg_input","latest","length","member","msgs","name_normalized","name","needs_joined_message","never_needs_joined_msg","note","num_members","old_name","oldest_msg_ts","opened_this_session","org","parent_group","pinned_items","pinned_items_count","presence","previous_names","purpose","scroll_top","shares","domain","tooltip","topic","unlinked","unread_count_display","unread_count","unread_highlight_cnt_in_client","unread_highlights","unreads","user","was_archived_this_session","isUnknown","isNonExistent","fromAnotherTeam","internalTeamIds","team_id","pendingAndConnectedTeamIds","previously_connected_team_ids","pending_connected_team_ids","conversation_host_id"],u=["_get","_is_interop_channel_object","_set","_setWithReduxAction","attributes","children","disabled","is_broadcast_keyword","is_divider","is_emoji","is_usergroup","is_view","is_app_action","nodeType","old_name","props_to_define","selector","then","title","toObject","toJSON","window","@@toStringTag"],f=_.reduce(d,function(H,F){return H[F]=!0,H},{}),p=_.reduce(m,function(H,F){return H[F]=!0,H},{}),S=_.reduce(u,function(H,F){return H[F]=!0,H},{}),v={},P=o(function(H,F){if(!p[F]&&!f[F]&&!S[F]&&_.isString(F)){TS.console.logStackTrace(`Accessing an unknown key ${F} on a model object`),t[F]||(t[F]=!0),Q()&&TS.console.error(`Dev only warning: Trying to get an unknown field "${F}" from a model object. If this is not a typo and you are relying on this property, please try and store this data outside of the model ob, or add to the model_ob_keys_as_map whitelist in TS.redux.channels.interop.source.js. Questions? Feel free to ask in #dhtml`);var ee=s(H.id);return ee&&ee[F]}return H[F]},"_proxyGet"),C=o(function(H,F,ee){if(_.isString(F)&&(r[F]=(r[F]||0)+1),!p[F]&&!f[F]&&_.isString(F)){if(TS.console.logStackTrace(`Setting an unknown key ${F} on a model object`),t[F]||(t[F]=!0),Q())throw new Error(`Dev only warning: Trying to set an unknown field "${F}" on a model object. If this is not a typo and you are relying on this property, please try and store this data outside of the model ob, or add to the model_ob_keys_as_map whitelist in TS.redux.channels.interop.source.js. Questions? Feel free to ask in #dhtml`);var c=s(H.id);c&&(c[F]=ee)}return H[F]=ee,!0},"_proxySet"),D=o(function(H){this.id=H,Object.defineProperties(this,this.props_to_define)},"_Channel"),O={};_.without(m,"id").forEach(function(H){O[H]={enumerable:!0,get:function(){return this._get(H)},set:function(F){return this._set(H,F)}},d.forEach(function(F){O[F]={enumerable:!0,get:function(){return this._get(F)},set:function(ee){return this._setWithReduxAction(F,ee)}}})}),D.prototype.props_to_define=O,D.prototype._is_interop_channel_object=!0,D.prototype._get=function(H){var F=s(this.id);if(F)return F[H]},D.prototype._set=function(H,F){var ee=s(this.id);return ee&&(ee[H]=F),!0},D.prototype._setWithReduxAction=function(H,F){var ee=s(this.id);return ee&&ee[H]!==F&&(a(this.id,H,F),i[H]=(i[H]||0)+1),!0};var Q=o(function(){return TS.boot_data&&(TS.boot_data.version_ts==="dev"||TS.boot_data.version_ts==="local_js")},"_isDev"),Y=o(function(H){if(!H)throw new Error("Must pass in a valid id to _createWrappedEntityById");var F,ee=n();return v[H]?F=v[H]:(F=new D(H),ee&&(F=new window.Proxy(F,{get:function(c,x){return P(c,x)},set:function(c,x,re){return C(c,x,re)}})),v[H]=F),F},"_createWrappedEntityById")})()},3706413573:()=>{(function(){TS.registerModule("redux.channels",{onStart:function(){s=!0,i=TS.interop.rules.channels.isIm||r,Object.defineProperty(TS.model,"channels",{get:function(){return f("channels")}}),Object.defineProperty(TS.model,"groups",{get:function(){return f("groups")}}),Object.defineProperty(TS.model,"mpims",{get:function(){return f("mpims")}}),Object.defineProperty(TS.model,"ims",{get:function(){return f("ims")}})},bulkAddEntities:function(p){TS.interop.channels.bulkAddChannels({channels:p})},updateMutedChannels:function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];var S=_.reduce(p,function(v,P){return v[P]=!0,v},{});TS.redux.dispatch(TS.interop.redux.actions.setMutedChannels(S))},getEntityById:function(p,S){return TS.interop.channels.getEntityById(p,S)},getPublicOrPrivateChannelByName:function(p){var S=n(p);if(TS.interop.rules.channels.isPublicChannel(S)||TS.interop.rules.channels.isPrivateChannel(S))return S},getImByMemberId:function(p){var S=a(p),v=TS.redux.channels.getEntityById(S);return i(v)?v:null},test:function(){var p={};return p}});let s=!1;function r(){TS.interop.utility.getLogger({getState:TS.redux.getState}).error(`missing-isIm: onStartDidRun=${s}, i(${_.has(window,"TS.interop")}), i.r(${_.has(window,"TS.interop.rules")}), i.r.c(${_.has(window,"TS.interop.rules.channels")}), i.r.c.i(${_.has(window,"TS.interop.rules.channels.isIm")})`);const p=Date.now()-(window.localStorage.isImBugLastEncountered||0);throw localStorage.isImBugLastEncountered=Date.now(),p>6e4&&TS.reload(null,"isIM bug detected"),new Error("TS.interop.rules.channels.isIm not present on page, not sure how to proceed")}o(r,"_isImErrorHandler");var i=r,t=TS.interop.channels.getAllChannels,n=TS.interop.channels.getChannelByName,a=TS.interop.channels.getImIdByMemberId,d,m={},u={channels:void 0,groups:void 0,mpims:void 0,ims:void 0},f=o(function(p){var S=t(),v;switch(p){case"channels":v=o(function(P){return P.is_channel&&!P.fromAnotherTeam},"filter");break;case"groups":v=o(function(P){return P.is_group&&!P.is_mpim&&!P.fromAnotherTeam},"filter");break;case"ims":v=i;break;case"mpims":v=o(function(P){return P.is_group&&P.is_mpim},"filter");break;default:}return S===d&&m[p]||(S!==d&&(d=S,m={}),m[p]=_.filter(S,v),m[p]=_.map(m[p],TS.redux.channels.interop.maybeWrapEntity),u[p]||(u[p]=_.defer(function(){delete m[p],delete u[p],d=null}))),m[p]},"_buildModelArrayKey")})()},6318582152:()=>{(function(){TS.registerModule("redux.files",{onStart:function(){Object.defineProperty(TS.model,"files",{get:function(){return TS.redux.files.getAllFiles()},set:function(){return!1}})},getFileById:function(n){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;var d=r(n,a);return!d||d.id!==n?null:d},getAllFiles:function(){var n=s();return n===i||(t=_.values(n),i=n),t}});var s=TS.redux.bindSelectorToStore("TS.interop.redux.models.files.getAllFiles"),r=TS.redux.bindSelectorToStore("TS.interop.redux.models.files.getFileById"),i,t})()},3404403316:()=>{(function(){TS.registerModule("redux.members",{onStart:function(){TS.boot_data.no_login||(r=TS.utility.enableFeatureForUser(1),t(),Object.defineProperty(TS.model,"members",{get:function(){return TS.redux.members.getAllMembers()},set:function(){return!1}}),Object.defineProperty(TS.model,"user",{get:function(){return TS.interop.members.getCurrentMember()}}))},getPotentiallyUnknownMemberById:function(n){if(n&&n[0]==="@"&&(n=n.substring(1)),!TS.interop.utility.looksLikeMemberId(n)){r&&TS.console.logStackTraceToBackEnd("non-ID passed into getPotentiallyUnknownMemberById","member_name_as_id_lookup",1);const d=TS.interop.members.getMemberByName(n);if(d)return d}const a=TS.interop.members.getPotentiallyUnknownMemberById(n);return a?a.isUnknown?(TS.members.legacySetMemberUnknown(n),_.omit({...a,is_unknown:!0},"isUnknown")):a.isNonExistent?_.omit({...a,is_non_existent:!0},"isNonExistent"):a:null},getMemberByEmail:function(n){var a=TS.interop.members.getMemberByEmail(n);return!a||!a.profile?null:a},getAllMembers:function(){var n=TS.interop.members.getAllMembers();return _.values(n)},hasMemberWithId:function(n){return TS.interop.members.hasMemberWithId(n)},test:function(){var n={_addSignalListeners:t};return Object.defineProperty(n,"_bulk_upsert_payload",{get:function(){return s},set:function(a){s=a}}),n}});var s=[],r,i=o(function(){s.length&&(TS.interop.members.markObjectsAsFresh(s.map(n=>n.id)),TS.interop.members.dangerouslyBulkAddMembers(s),s=[])},"_bulkUpsertMembers"),t=o(function(){TS.members.batch_upserted_sig.add(i)},"_addSignalListeners")})()},5790153495:()=>{(function(){TS.registerModule("redux.prefs",{setUserPrefs:function(s){TS.interop.prefs.setUserPrefs(s)},setTeamPrefs:function(s){TS.interop.prefs.setTeamPrefs(s)},setEnterprisePrefs:function(s){TS.interop.prefs.setEnterprisePrefs({prefs:s})},setUserPref:function(s,r){TS.redux.prefs.getUserPref(s)!==r&&TS.interop.prefs.setUserPref({pref:s,value:r})},setTeamPref:function(s,r){TS.redux.prefs.getTeamPref(s)!==r&&TS.interop.prefs.setTeamPref({pref:s,value:r})},getUserPref:function(s){return TS.interop.prefs.getUserPref(s)},getTeamPref:function(s){return TS.interop.prefs.getTeamPref(s)},test:function(){var s={};return s}})})()},8489220238:()=>{(function(){TS.registerModule("redux.presence",{onStart:function(){t()},getPresenceByMemberId:function(n){return s(n)},updatePresenceForMember:function(n){!n||!n.id||TS.redux.dispatch(TS.interop.redux.features.presence.updatePresence({memberId:n.id,presence:n.presence}))}});var s=TS.redux.bindSelectorToStore("TS.interop.redux.features.presence.getPresenceByMemberId"),r={},i=o(function(){r.length&&(TS.redux.dispatch(TS.interop.redux.features.presence.bulkUpdatePresence(r)),r={})},"_bulkUpsertPresences"),t=o(function(){TS.members.presence_changed_sig.add(TS.redux.presence.updatePresenceForMember),TS.members.batch_upserted_sig.add(i)},"_addSignalListeners")})()},638087661:()=>{(function(){TS.registerModule("redux.reactions",{getReactionsForKey:function(s){return TS.interop.redux.models.reactions.getReactionsForKey(TS.redux.getState(),s)},upsertReactions:function(s,r,i){const t=TS.redux.reactions.getReactionsForKey(s),n=TS.redux.dispatch(TS.interop.redux.models.reactions.upsertReactions({key:s,reactions:r,fromUserAction:i}));let a="NOOP";return n&&(r&&_.isEmpty(t)?a="ADDED":_.isEqual(t,r)||(a="CHANGED")),{status:a,what_changed:[],rxns:r}}})})()},9170865939:()=>{(function(){TS.registerModule("redux.teams",{onStart:function(){Object.defineProperty(TS.model,"team",{get:function(){return TS.redux.teams.getCurrentTeam()},set:function(){return TS.error("TS.redux.teams: trying to set TS.model.team???"),!1}})},upsertTeam:function(s){if(!(!s||!s.id))return TS.interop.teams.upsertTeam({team:s})},getTeamById:function(s,r){return TS.interop.teams.getTeamById?TS.interop.teams.getTeamById(s,r):null},getAllTeams:function(){return TS.interop.teams.getAllTeams?TS.interop.teams.getAllTeams():null},getCurrentTeam:function(){return TS.interop.teams.getCurrentTeam?TS.interop.teams.getCurrentTeam():null},fetchAndUpsertEnterpriseOrgInfo:function(){return TS.interop.teams.fetchAndUpsertEnterpriseOrgInfo?TS.redux.dispatch(TS.interop.teams.fetchAndUpsertEnterpriseOrgInfo()):null}})})()},4354742961:()=>{(function(){TS.registerModule("redux.user_groups",{onStart:function(){Object.defineProperty(TS.model,"user_groups",{get:function(){return TS.redux.user_groups.getAllUserGroups()},set:function(){return TS.error("TS.redux.user_groups: trying to set TS.model.user_groups???"),!1}})},getAllUserGroups:function(){var i=TS.interop.userGroups.getAllUserGroups();return i===s||(r=_.values(i).sort(TS.interop.i18n.mappedSorter("_name_lc")),s=i),r}});var s,r})()},2724016834:()=>{(function(){TS.registerModule("rxns",{upsertRxnsFromDataAndUpdateUI:function(r,i){var t=s(r,i);return t},getRxnKey:function(r,i,t){return r==="message"&&!t&&TS.error("getRxnKey: no c_id provided for message rxn_key"),r!=="message"&&t&&TS.error("getRxnKey: c_id provided for but this is not a message rxn_key"),`${r}-${i}-${t||""}`},getExistingRxnsByKey:function(r){var i=TS.redux.reactions.getReactionsForKey(r);return i&&i.length?i:null},test:function(){return{upsertRxnsFromData:s}}});var s=o(function(r,i){return TS.redux.reactions.upsertReactions(r,i,!1)},"_upsertRxnsFromData")})()},1496158114:()=>{(function(){TS.registerModule("shared",{onStart:function(){},test:function(){var n={};return Object.defineProperty(n,"_queried_usernames",{get:function(){return s},set:function(a){s=a}}),n},legacyGetActiveModelOb:function(){var n;return TS.boot_data.channel_id?n=TS.interop.channels.getPublicChannelById(TS.boot_data.channel_id):TS.boot_data.im_id?n=TS.interop.channels.getImById(TS.boot_data.im_id):TS.boot_data.mpim_id?n=TS.interop.channels.getMpimById(TS.boot_data.mpim_id):TS.boot_data.group_id?n=TS.interop.channels.getGroupById(TS.boot_data.group_id):(TS.warn("error getActiveModelOb found no ob"),TS.warn(`TS.boot_data.channel_id: ${TS.boot_data.channel_id}`),TS.warn(`TS.boot_data.im_id: ${TS.boot_data.im_id}`),TS.warn(`TS.boot_data.group_id: ${TS.boot_data.group_id}`)),n},promiseToRefetchModelOb:function(n){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"TS.shared.promiseToRefetchModelOb";if(!n||typeof n!="string")return Promise.resolve();const d=[n];return TS.interop.channels.fetchAndUpsertChannelsFromFlannel({ids:d}).then(m=>{let{channels:u}=m;return _.isEmpty(u)?TS.interop.channels.fetchAndUpsertChannelsFromAPI({ids:d,reason:a}):{channels:u}}).then(m=>{let{channels:u}=m;return u&&u[0]})},ensureModelObsArePresent:function(n,a){return!n||!n.length?Promise.resolve():TS.interop.channels.fetchAndUpsertChannelsById({ids:n,reason:a}).then(d=>{let{missing:m}=d;return _.isEmpty(m)||m.forEach(u=>TS.interop.channels.upsertChannel({id:u,isNonExistent:!0})),Promise.resolve()})},legacyEnsureModelObsInDataArePresent:function(n,a){const d=TS.interop.utility.extractAllModelObIds(n);return a==="search.messages"&&TS.boot_data.page_needs_enterprise&&i(n,d),TS.shared.ensureModelObsArePresent(d,a)},legacyBatchUpsertObjects:function(n){TS.has_pri[t]&&TS.log(t,`Flannel: upserting batch of ${n.length} objects`);var a=[],d=[],m=[];_.forEach(n,function(v){TS.interop.utility.looksLikeMemberId(_.get(v,"id"))?TS.redux.members.hasMemberWithId(v.id)?a.push(v):d.push(v):r(v)&&m.push(v)});var u=!!d.length,f=[];function p(v){TS.has_pri[t]&&TS.log(t,`Flannel: upserting and signaling user ${v.id} from query results`);var P=TS.members.legacyUpsertAndSignal(v).member;f.push(P)}o(p,"upsertAndSignalMember");function S(v){TS.has_pri[t]&&TS.log(t,`Flannel: upserting user ${v.id} from query results`);var P=TS.members.legacyUpsertMember(v).member;f.push(P)}return o(S,"upsertMember"),a.forEach(p),u&&(TS.members.legacyStartBatchUpsert(),d.forEach(S),TS.members.legacyFinishBatchUpsert()),m.length&&(TS.redux.bots.bulkUpsertBots(m),m.forEach(v=>{TS.has_pri[t]&&TS.log(t,`Flannel: upserting bot ${v.id} from query results`);var P=TS.interop.bots.getBotById(v.id);f.push(P)})),f}});var s={},r=o(function(n){var a=_.get(n,"id[0]");return a==="B"},"_isBot");function i(n,a){var d=TS.model.team.id;_.remove(a,function(m){var u=_.find(n.messages.matches,function(S){return S.channel.id==m},this),f=_.get(u,"channel"),p=TS.interop.rules.channels.isOrgShared(f)||TS.interop.rules.channels.isExternallySharedChannel(f);if(u&&_.get(u,"team")!=d&&_.startsWith(m,"C")&&!p)return m})}o(i,"_excludeNonLocalModelObs");var t=1989})()},9410205190:()=>{(function(){const s="STORAGE";TS.registerModule("storage",{version:"0.85",msgs_version:window.boot_data&&boot_data.cache_version||"unknown_version",cache_ts_version:window.boot_data&&boot_data.cache_ts_version||"unknown_version",do_compression:!TS.model.is_our_app&&typeof window.Worker<"u"&&(!window.bowser||!bowser.phantom&&!bowser.msie),test:function(){return{getLocalStorage:ce,setLocalStorage:L,getKeys:O,set:q}},onStart:function(){TS.storage.onStart=function(){},TS.storage.do_compression||(TS.interop.console.info(s,"Special case: force-enabling LS compression for this session."),TS.storage.do_compression=!0),TS.storage.version+=TS.storage.do_compression?"-compressed-LZString":"";var y=a||!ne||function(){return!TS.storage.storageAvailable()&&(Y(),!TS.storage.storageAvailable())?(TS.interop.console.info(s,"TS.storage.storageAvailable() = false in onStart after flushing all our keys, so disabling"),!0):!1}();TS.has_pri[N]&&(TS.log(N,`TS.storage.onStart should_disable:${y}`),TS.log(N,`TS.storage.do_compression:${TS.storage.do_compression} (_ls.getItem('is_compressed') === 'yes'):${ne&&ne.getItem("is_compressed")==="yes"}`)),TS.ui.window_unloaded_sig.add(F),TS.ui.window_focus_changed_sig.add(ee),TS.storage.setDisabled(y),q("rxn_records",null);var U=TS.storage.fetchExpandableState();TS.redux.dispatch(TS.interop.redux.features.expandables.bulkSetExpanded(U))},setDisabled:function(y){a!=y&&(y||!ne?(a=!0,ne&&Y()):(a=!1,Q()),TS.log(N,`_disabled:${a}`))},storageAvailable:function(){if(!ne)return!1;try{var y="test_to_see_if_we_can_write_to_local_storage";return ne.setItem(y,"foo"),ne.removeItem(y),!0}catch{return!1}},storageSize:function(y){var U=0;if(!ne)return U;for(var h=O(),w=0,R,E,B=0;B<h.length;B+=1)w+=1,R=h[B],E=ne.getItem(R),!E&&E!==""?TS.interop.console.info(s,`${R} not measurable value, typeof:${typeof E}`):(U+=E.length,y&&TS.info(`${R}=${(E.length*2/1024).toFixed(2)}KB (total=${(U/1024).toFixed(2)}KB)`));return y&&TS.info(`total for ${w} items is ${(U/1024).toFixed(2)}KB`),U},flush:function(y){TS.has_pri[N]&&TS.log(N,"TS.storage.flush()"),Y(),y&&TS.storage.clearBufferAndCache()},clearBufferAndCache:function(){TS.has_pri[N]&&TS.log(N,"TS.storage.clearBufferAndCache()"),m={},u={},TS.compresion&&TS.compression.terminate()},fetchStorageVersion:function(){return J("storage_version")},storeStorageVersion:function(y){q("storage_version",y,!0)},fetchCacheTSStorageVersion:function(){return J("storage_cache_ts_version")},_makeMsgInputId:function(y){return`msg_input_${y}`},fetchLastMsgInput:function(y){var U=J(TS.storage._makeMsgInputId(y),null);return U==="\u4000"?(TS.interop.utility.getLogger({getState:TS.redux.getState}).error({storage_version:TS.storage.fetchStorageVersion(),ts_storage_version:TS.storage.version,is_our_app:TS.model.is_our_app,typeof_window_worker:typeof window.Worker,has_bowser:!!window.bowser},"decompress_general_compressed_fail"),""):U},fetchOldestTs:function(y){return J(n(y),null)},fetchLastEventTS:function(y){return J("last_event_ts","",y)||""},storeUIState:function(y){q("ui_state",y)},fetchExpandableState:function(){var y=J("expandable_state",{});return y&&typeof y=="object"?y:{}},fetchCustomEmoji:function(){return J("custom_emoji",null)||null},fetchApps:function(){return J("apps",null)||null},fetchCmds:function(){return J("cmds",null)||null},storeFilterState:function(y){q("team_filter_state",y)},fetchFrecency:function(y){return J(`frecency_${y}`)},storeFrecency:function(y,U){q(`frecency_${y}`,U)},clearFrecency:function(y){q(`frecency_${y}`,"")},fetchLastEKMChangeTimestamp:function(){return J("last_ekm_change_ts","0")||"0"},storeLastEKMChangeTimestamp:function(y){q("last_ekm_change_ts",y)}});var r=`${window.boot_data.user_id}_`,i="channel_msgs_",t="oldest_msg_ts_",n=o(function(y){return t+y},"_makeOldestTsId"),a,d=!1,m={},u={},f=1e3,p=!1,S=1e3,v=!1,P=1e3,C=!1,D=!1,O=o(function(){var y=[];if(!ne)return y;var U=ne.length;if(!U)return y;for(var h=0;h<U;h+=1)y.push(ne.key(h));return y},"_getKeys"),Q=o(function(){var y;if(!a){var U=TS.storage.fetchStorageVersion()||"",h=U.indexOf("-compressed")!=-1||ne.getItem("is_compressed")==="yes";TS.storage.do_compression&&!h?(TS.interop.console.info(s,"migrating to compressed format"),y=O(),y.forEach(function(E){var B=E.replace(r,""),G=te(E,ne.getItem(E)),K=`converting: ${E} -> ${B} val.length: ${G==null?-1:String(G).length}`;q(B,null),q(B,G),J(B)==G?TS.has_pri[N]&&TS.log(N,`${K} SUCCESS _get(name) has a value:${!!J(B)}, and it it the same as val`):TS.error(`${K} FAILURE _get(name) !== val`)}),TS.interop.console.info(s,`migration to compressed format complete, ${y.length} migrated`),TS.storage.storeStorageVersion(TS.storage.version)):TS.has_pri[N]&&TS.log(N,"no migration needed"),ne.setItem("is_compressed",TS.storage.do_compression?"yes":"no")}var w=TS.storage.fetchCacheTSStorageVersion();TS.has_pri[N]&&TS.log(N,`storage_cache_ts_version:${w}`);var R=TS.storage.fetchStorageVersion()||"";TS.has_pri[N]&&(TS.log(N,`TS.storage.version:${TS.storage.version}`),TS.log(N,`storage_version:${R}`),TS.log(N,`TS.storage last_unload_flushing: ${J("last_unload_flushing")}`),TS.log(N,`TS.storage.storageAvailable(): ${TS.storage.storageAvailable()}`)),y=O(),TS.has_pri[N]&&TS.dir(N,y,"_getKeys()"),TS.storage.storageAvailable()?R!=TS.storage.version?(TS.log(N,`storage_version:${R} does not match TS.storage.version:${TS.storage.version} so flushing all our keys: ${y.join(", ")}`),Y()):TS.storage.fetchLastEventTS()||(TS.log(N,"TS.storage.fetchLastEventTS() is empty so flushing channel data"),H()):(TS.log(N,"TS.storage.storageAvailable() = false so flushing all our keys"),Y()),TS.storage.storeStorageVersion(TS.storage.version)},"_setUp"),Y=o(function(){O().forEach(function(y){y.indexOf(r)===0&&ne.removeItem(y)})},"_removeAllOurKeys"),H=o(function(){var y=O();TS.has_pri[N]&&TS.log(N,y,"_getKeys()");for(var U,h=0;h<y.length;h+=1)U=y[h],U.indexOf(r)===0&&(U.indexOf(i)==-1&&U.indexOf(t)==-1||(ne.removeItem(U),delete m[U]));for(U in m)U.indexOf(r)===0&&(U.indexOf(i)==-1&&U.indexOf(t)==-1||delete m[U]);u={},y=O(),TS.dir(488,y,"_getKeys()")},"_completelyEmptyAllStorage"),F=o(function(){d=!0,q("last_unload_flushing",new Date().toString(),!0),re(!0,"_windowUnloaded"),TS.compression.terminate()},"_windowUnloaded"),ee=o(function(){re(!0,"_windowBlurred")},"_windowBlurred"),c=o(function(y){return typeof y=="string"||typeof y=="number"||!y?y:JSON.stringify(y)},"_prepareValForStorage"),x=o(function(y){return y==="undefined"||y==="null"?null:y},"_correctBadValsFromStorage"),re=o(function(y,U){if(!a){var h=new Date,w=Date.now(),R,E=0,B,G=!1,K,ae,ue,oe,le;for(B in m)if(!m[B].being_flushed){if(oe=c(m[B].val),oe==null)ne.removeItem(B),delete m[B],delete u[B];else try{z(B,oe)}catch(ie){TS.error(0,ie),Y(),delete m[B],delete u[B];continue}if(E+=1,R=Date.now()-w,G&&TS.has_pri[N]&&TS.log(N,`_flushBuffer _ls.setItem ${B}: ${R}ms ${m[B]&&m[B].val&&m[B].val.toString?m[B].val.toString().substr(0,100):"NULL?"}`),!y&&(K=new Date-h,!C&&K>P)){C=!0,ue=new Date;try{ae=TS.storage.storageSize()}catch{}ue=new Date-ue,le=`Took ${K}ms for ${E} item (!all case) (threshold is ${P} ms). Key: ${B}. Buffer length: ${m[B]&&m[B].val&&m[B].val.toString()?m[B].val.toString().length:"unknown (not a string)"}. localStorage size: ${ae||"unknown"}. Time to read LS size: ${ue}`,TS.info(`_flushBuffer exceeded slow write threshold: ${le}`)}if(m[B]&&(m[B].being_flushed=!0),!y){TS.has_pri[N]&&TS.log(N,`_flushBuffer: Wrote one item. why: ${U}`);return}u={}}if(E&&!D&&(K=new Date-h,K>P)){D=!0;try{ae=TS.storage.storageSize()}catch{}le=`Took ${K}ms for ${E} items (threshold is ${P} ms). localStorage size: ${ae}. App open for ${((Date.now()-TS.boot_data.start_ms)/1e3/60).toFixed(2)} min. why: ${U}`,TS.info(`_flushBuffer exceeded slow write threshold (all case): ${le}`)}TS.has_pri[N]&&(E===0?TS.log(N,"_flushBuffer: Nothing to save."):TS.log(N,`_flushBuffer: Saved ${E}${E===1?" item":" items"} why: ${U}`))}},"_flushBuffer"),J=o(function(y,U,h){var w=r+y;if(h&&TS.info(`_get name:${y} k:${w} disabled:${a} _buffer["${w}"].val:${m[w]&&m[w].val}`),a||w in m)return m[w]&&m[w].val||U;if(u.hasOwnProperty(w))return u[w];var R=te(w,X(w,ne.getItem(w)),U,h);return u[w]=R,R},"_get"),te=o(function(y,U,h,w){var R=new Date,E=x(U);w&&TS.info(`_get _correctBadValsFromStorage(_ls.getItem(k)) k:${y} typeof result:${typeof E} /^[{[]/.test(result):${/^[{[]/.test(E)}`);var B;if(E&&typeof E=="string"&&/^[{[]/.test(E)&&(E=TS.utility.parseJSONOrElse(E)||E),E=E||(h!==void 0?h:null),R=new Date-R,!p&&R>f){p=!0;try{B=TS.storage.storageSize()}catch{}var G=`_get took longer than threshold: Took ${R}ms to read ${y} (theshold is ${f}ms), length = ${E&&!isNaN(E.length)?E.length:"unknown"}. Storage size: ${B}`;TS.info(G)}return E},"_convertTypeForFetch"),q=o(function(y,U,h,w){var R=!1,E=new Date,B,G=r+y;if(m[G]={val:U,being_flushed:!1},u[G]=m[G].val,w&&TS.info(`_set immediate:${h} name:${y} k:${G} disabled:${a} do_compression:${TS.storage.do_compression} _buffer["${G}"].val:${m[G].val}`),h){if(!a){var K=c(U);if(K==null)ne.removeItem(G),delete m[G];else try{z(G,K,h)}catch{TS.interop.console.warn(`_set _ls.setItem failed, flushing. TS.storage.storageSize():${TS.storage.storageSize(!1)}`),R=!0}}if(w&&TS.info(`_set failed:${R}`),!R)if(w&&TS.info(`_set _buffer["${G}"]:${m[G]&&JSON.stringify(m[G])}`),E=new Date-E,E>S){if(TS.interop.console.info(s,`_set immediately ${y}: ${E}ms ${U&&U.toString?U.toString().substr(0,100):"NULL?"}`),!v){v=!0;try{B=TS.storage.storageSize()}catch{}var ae=`_set exceeded slow set threshold (immediate): Took ${E}ms to write ${G} (theshold is ${S}ms), length = ${U&&!isNaN(U.length)?U.length:"unknown"}. Storage length: ${B}`;TS.info(ae)}}else TS.has_pri[N]&&TS.log(N,`_set GOOD immediately: ${h} ${y}: ${E}ms`,U)}},"_set"),ne=window.localStorage,ce=o(function(){return ne},"_getLs"),L=o(function(y){ne=y},"_setLs"),z=o(function(y,U,h){if(U=String(U),TS.storage.do_compression){TS.compression.compress(y,U,h||d,j);return}j({k:y,str:U})},"_compressAndStore"),j=o(function(y){ne.setItem(y.k,y.str);var U=o(function(h){var w=ne.getItem(y.k);if(w===y.str){h>1&&TS.interop.console.info(s,`${y.k} now saved, try #${h}`),delete m[y.k],delete u[y.k];return}if(h>1&&(!m[y.k]||m[y.k].val!=y.str)){TS.error(`buffer changed for ${y.k} so we don't care anymore, a new value is being set for it, try #${h}`);return}TS.error(`WTF not saved, try #${h} ${y.k} ${(y.str||"").length} typeof ob.str:${typeof y.str} from_ls:${typeof w}`),ne.setItem(y.k,y.str),setTimeout(U,1e3,h+1)},"testAndFinishOrTryAgain");U(1)},"_afterCompress"),X=o(function(y,U){if(!TS.storage.do_compression)return U==="\u4000"?(TS.interop.utility.getLogger({getState:TS.redux.getState}).error({storage_version:TS.storage.fetchStorageVersion(),ts_storage_version:TS.storage.version,is_our_app:TS.model.is_our_app,typeof_window_worker:typeof window.Worker,has_bowser:!!window.bowser},"decompress_empty_string_fail"),""):U;var h=Date.now();U&&(U=LZString.decompress(U));var w=Date.now()-h;return U&&TS.has_pri[N]&&TS.log(N,`${y} took ${w}ms to _decompress str.length: ${U.length}`),U==="\u4000"?(TS.interop.utility.getLogger({getState:TS.redux.getState}).error({storage_version:TS.storage.fetchStorageVersion(),ts_storage_version:TS.storage.version,is_our_app:TS.model.is_our_app,typeof_window_worker:typeof window.Worker,has_bowser:!!window.bowser},"decompress_double_compressed_fail"),""):U},"_decompress"),N=488})()},5110391454:()=>{(function(){TS.registerModule("team",{team_name_changed_sig:new signals.Signal,onStart:function(){TS.team.team_name_changed_sig.add(r)},ensureTeamProfileFields:function(){return s||(s=TS.interop.api.call("team.profile.get").then(function(i){TS.redux.teams.upsertTeam(_.assign({id:TS.boot_data.team_id},{profile:i.data.profile}))}),s)},getTeamProfileFieldById:function(i){TS.model.team.profile.fields.length||TS.warn("Ensure profile fields exist before calling getTeamProfileFieldById");for(var t=0;t<TS.model.team.profile.fields.length;t+=1)if(TS.model.team.profile.fields[t].id===i)return TS.model.team.profile.fields[t];return null},getVisibleTeamProfileFields:function(){return TS.model.team.profile.fields.length||TS.warn("Ensure profile fields exist before calling getVisibleTeamProfileFields"),TS.model.team.profile.fields.filter(function(i){return!i.is_hidden})},getHiddenTeamProfileFields:function(){return TS.model.team.profile.fields.length||TS.warn("Ensure profile fields exist before calling getHiddenTeamProfileFields"),TS.model.team.profile.fields.filter(function(i){return i.is_hidden})},sortTeamProfileFieldsByOrdering:function(i){if(!i||!i.length)TS.warn("Ensure profile fields exist before calling sortTeamProfileFieldsByOrdering");else return _.clone(i).sort(function(t,n){return t.ordering-n.ordering})}});var s,r=o(function(){$("#team_name").text(TS.model.team.name),document.title=document.title.replace(TS.model.last_team_name,TS.model.team.name),TS.model.last_team_name=TS.model.team.name},"_handleTeamRename")})()},603105959:()=>{(function(){TS.registerModule("teams",{rename_sig:new signals.Signal,changed_icon_sig:new signals.Signal,onStart:function(){TS.teams.changed_icon_sig.add(r),TS.teams.rename_sig.add(r)},getTeamById:function(n,a){return _.isString(n)?TS.redux.teams.getTeamById(n,a):null},ensureTeamsArePresent:function(n){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"TS.teams.ensureTeamsArePresent";if(!_.isArray(n))return Promise.reject(Error("t_ids is not an array"));var d=_.filter(n,function(m){var u=!1,f=TS.teams.getTeamById(m,u);return!f||f._other_account});return d.length?s(d,a):Promise.resolve()},ensureTeamsInDataArePresent:function(n){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"TS.teams.ensureTeamsInDataArePresent";var d=TS.interop.utility.extractAllTeamIds(n);return TS.teams.ensureTeamsArePresent(d,a)},test:function(){var n={_getSharedTeamIdsForMember:t};return Object.defineProperty(n,"_getTeamsByIdFromApi",{get:function(){return s},set:function(a){s=a}}),n}});var s=o(function(n,a){if(!_.isArray(n))return Promise.reject(Error("t_ids is not an array"));const d=250,m=_.chunk(n,d);return Promise.map(m,u=>TS.interop.api.callExpedited("team.info",{teams:u,_x_reason:a}).then(f=>{var p=[];return f.data.teams.forEach(function(S){S&&S.id&&S.id.charAt(0)==="E"?TS.warn(`EVALUE-1721: team.info response included an Enterprise org of ${S.id}. NOT adding to model. Client requested teams=${u.join(", ")}.`):p.push(TS.redux.teams.upsertTeam(S))}),p}).catch(f=>{TS.error(`_getTeamsByIdFromApi failed with ${f.data&&f.data.error||"unknown error"}, when requesting teams=${u.join(", ")}`)})).then(u=>_.compact(_.flatten(u)))},"_getTeamsByIdFromApi"),r=o(function(n){n.id!==TS.model.team.id&&i(n)},"_handleTeamChange"),i=o(function(n){if(_.isObject(n)){var a=TS.utility.teams.getMembersForTeam(n);a.length&&_.forEach(a,function(d){TS.members.changed_profile_sig.dispatch(d)})}},"_updateTeamMembers"),t=o(function(n){return n?_.get(n,"enterprise_user")?_.intersection(_.get(n,"enterprise_user.teams",[]),_.get(TS.model.user,"enterprise_user.teams",[])):_.get(n,"team_id")===_.get(TS.model.user,"team_id")?[n.team_id]:[]:[]},"_getSharedTeamIdsForMember")})()},3693504700:()=>{(function(){TS.registerModule("templates.builders",{makeMemberPreviewLink:function(r,i){if(!r)return"";i!==!0&&(i=!1);var t=TS.templates.builders.makeMemberColorClass(r),n,a;return r.is_service?(a=TS.utility.shouldLinksHaveTargets()?`target="/services/${r.id}"`:"",t+=" app_preview_link",n=`<a href="/services/${r.id}" ${a} data-bot-id="${r.id}" class="message_sender service_link ${t}">`):(a=TS.utility.shouldLinksHaveTargets()?`target="/team/${r.id}"`:"",t+=r.is_bot?" app_preview_link":" member member_preview_link",t+=` ${TS.templates.builders.makeMemberTypeBadgeClass(r)}`,n=`<a href="/team/${r.id}" ${a} class="message_sender ${t}" data-member-id="${r.id}">`),i&&r.id==TS.model.user.id?n+=TS.interop.i18n.t("You","templates_builders")():n+=TS.interop.rules.members.getPrefCompliantMemberName(r,!0),n+=TS.templates.builders.makeMemberTypeBadgeCompact(r,!1),n+="</a>",(r.is_bot||r.is_service)&&(n+=`<span class="c-app_label">${TS.interop.i18n.t("APP","templates_builders")()}</span>`),r.is_unknown&&(n=TS.templates.unknown_member({id:r.id})),n},legacyShowDraftIcon:function(r){if(!_.isObject(r))return!1;if(TS.interop.utility.looksLikeMemberId(r.id)){var i=TS.redux.channels.getImByMemberId(r.id);if(!i)return!1}var t=i||r,n=t.last_msg_input,a=t.id,d=TS.shared.legacyGetActiveModelOb();if(d){var m=d.id;m&&m==a&&(n=null)}return t.is_channel&&(TS.interop.rules.channels.isArchived(t)||!t.is_member)&&(n=null),t.is_group&&!t.is_mpim&&TS.interop.rules.channels.isArchived(t)&&(n=null),TS.interop.rules.user.canPostInChannel(t)||(n=null),!!_.trim(n)},makeMemberPreviewLinkImage:function(r,i,t,n,a,d,m){var u;if(typeof r=="object"?u=r:u=TS.redux.members.getPotentiallyUnknownMemberById(r),!u||!u.profile)return"";t=t===!0,n=n===!0||TS.utility.members.isMemberEKMRevoked(u),a=a===!0,d=d===!0,m=typeof m=="string"?m:!1,r==="USLACKBOT"&&m&&(u=TS.utility.slackbot.getWithFeels(m));var f=TS.templates.builders.getImageStyleForMemberPreviewImage(u,i,t),p={omit_link:n,omit_badge:a,lazy:t,member:u,size:i,include_restricted_overlay:!d||!0,bg_img_style:f};return TS.templates.member_preview_link_image(p)},getImageStyleForMemberPreviewImage:function(r,i,t){var n,a,d;switch(a="background-image: ",d=[],i){case 20:TS.environment.is_retina?n=r.profile.image_48:n=r.profile.image_24;break;case 24:TS.environment.is_retina?n=r.profile.image_48:n=r.profile.image_24;break;case 32:TS.environment.is_retina?n=r.profile.image_72:n=r.profile.image_32;break;case 36:TS.environment.is_retina?n=r.profile.image_72:n=r.profile.image_48;break;case 48:TS.environment.is_retina?n=r.profile.image_72:n=r.profile.image_48;break;case 72:TS.environment.is_retina?n=r.profile.image_192:n=r.profile.image_72;break;case 192:TS.environment.is_retina?n=r.profile.image_512||r.profile.image_192:n=r.profile.image_192;break;case 512:TS.environment.is_retina?n=r.profile.image_1024||r.profile.image_512||r.profile.image_192:n=r.profile.image_512||r.profile.image_192;break;default:TS.environment.is_retina?n=r.profile.image_72:n=r.profile.image_48;break}if(d.push(`url('${n}')`),i===512){var m=TS.environment.is_retina?r.profile.image_72:r.profile.image_48;d.push(`url('${m}')`)}return t?a=d.length?d.join(", "):"":a=d.length?a+d.join(", "):"",a},makePendingUserImage:function(r,i){if(!r||!i)return"";var t=48;i===36&&(t=72);var n=`/img/new_channel_modal/airplane_${t.toString()}.png`,a=`url('${vvv(n)}')`,d={restricted:r.invite_prefs&&r.invite_prefs.type==="restricted",img_url:a,size:i};return TS.templates.pending_user_image(d)},newWindowName:function(){return TS.boot_data.app==="web"||TS.boot_data.app==="calls"?"_self":`new_${s.toString()}`},strBuilder:function(r,i){return r.replace(/\${([a-z_]+)}/g,function(t,n){return n.indexOf("_html")>-1?i[n]:_.escape(i[n])})},atLabel:function(r){r==="group"&&(r="channel");var i=(_.keyBy(TS.interop.broadcast_keywords.getAllBroadcastKeywords(),"ms_name")[r]||{}).name||"channel";return`@${i}`},makeMemberTypeBadgeClass:function(r){return!TS.boot_data.page_needs_enterprise||!r.is_restricted?"":"has_member_type_badge"},makeMemberColorClass:function(r){var i="color_";return r?i+=`${r.id} color_${r.color}`:i+="unknown",i},makeMemberTypeBadgeCompact:function(r,i){if(!TS.boot_data.page_needs_enterprise)return"";typeof i!="boolean"&&(i=!1);var t={icon_class:"",with_tooltip:i,tooltip:{member_type:"",type_description:""}},n=TS.boot_data.page_needs_enterprise?TS.interop.i18n.t("organization directory","templates_builders")():TS.interop.i18n.t("workspace directory","templates_builders")();return r.isExternal?"":r.is_ultra_restricted?(t.icon_class="ts_icon_single_channel_guest",t.tooltip.member_type=TS.interop.i18n.t("Single-Channel Guests","templates_builders")(),t.tooltip.type_description=TS.interop.i18n.t("see a partial {directory_name} and can only access messages and files from the channel they belong to.","templates_builders")({directory_name:n}),TS.templates.member_type_icon(t)):r.is_restricted?(t.icon_class="ts_icon_restricted_user",t.tooltip.member_type=TS.interop.i18n.t("Multi-Channel Guests","templates_builders")(),t.tooltip.type_description=TS.interop.i18n.t("see only a partial {directory_name} and can only access messages and files from selected channels.","templates_builders")({directory_name:n}),TS.templates.member_type_icon(t)):""},getMemberTypeClass:function(r){return r.is_restricted?" ra":""},loadingHTML:function(){return TS.templates.infinite_spinner({color:"white",size:"medium"})},test:function(){var r={};return r}});var s=Date.now()})()},3318067913:()=>{(function(){TS.registerModule("templates.helpers",{onStart:function(){TS.templates.helpers.register()},register:function(){Handlebars.registerHelper("debugger",function(){debugger}),Handlebars.registerHelper("i18n_ns",function(t){if(!_.isObject(this)){TS.warn(`Cannot set i18n namespace "${t}". Chances are you\u2019ve inadvertently changed the context in a Handlebars partial to something that\u2019s not an object.`);return}this._i18n_ns&&(this._i18n_ns_history?this._i18n_ns_history.push(this._i18n_ns):this._i18n_ns_history=[this._i18n_ns]),this._i18n_ns=t}),Handlebars.registerHelper("_i18n_ns_end",function(){this._i18n_ns_history&&this._i18n_ns_history.length&&(this._i18n_ns=this._i18n_ns_history.pop())}),Handlebars.registerHelper("i18n_img",function(t){var n=t.fn(this),a=t&&t.hash&&t.hash.locales?t.hash.locales:null;return a&&(a=a.replace(/\s/g,""),a.split(",").indexOf(TS.interop.i18n.locale)>-1&&(n=n.replace(/(\..+$)/,`.${TS.interop.i18n.locale}$1`))),n}),Handlebars.registerHelper("t",function(t){var n;typeof t=="string"?(n=t,t=arguments[1]):n=t.fn();var a;t.hash.ns!==void 0?a=t.hash.ns:this._i18n_ns!==void 0?a=this._i18n_ns:a=t.data.root&&t.data.root._i18n_ns?t.data.root._i18n_ns:"";var d=this;_.isObject(d)||(d={this:d});var m={},u;_.forOwn(t.hash,function(C,D){m[D]=d[D],d[D]=Handlebars.Utils.escapeExpression(C)});var f=n.match(/{[^\s}]+}/g);if(f&&f.length){var p=o(function(C){var D=C.split(".");if(D.length>1){var O=0,Q=D.length,Y=d;for(O;O<Q;O+=1)if(Y=Y[D[O]],Y===void 0)return;return Y}return d[C]},"getValue"),S,v=0,P=f.length;for(v;v<P;v+=1)u=f[v].slice(1,-1),t.hash[u]===void 0&&(S=p(u),S!==void 0&&(m[u]=d[u],d[u]=Handlebars.Utils.escapeExpression(S)))}return t.hash.debug&&(TS.info("debug handlerbars t helper"),TS.info(this)),d.__handlebars=!0,n=TS.interop.i18n.t(n,a)(d),_.forOwn(m,function(C,D){d[D]=C}),n}),Handlebars.registerHelper("zdLocale",function(){return TS.interop.i18n.zdLocale()}),Handlebars.registerHelper("exampleEmail",function(t){return TS.utility.exampleEmailAddress(t)}),Handlebars.registerHelper("convertTimestampToMilliseconds",function(t){return t*1e3}),Handlebars.registerHelper("listify",function(t,n){n.hash.map&&(t=_.map(t,n.hash.map));var a=_.get(n.hash,"conjunction"),d=_.get(n.hash,"strong"),m=_.get(n.hash,"no_escape"),u=TS.interop.i18n.listify(t,{conj:a,strong:d,noEscape:m});return new Handlebars.SafeString(u.join(""))}),Handlebars.registerHelper("isClient",function(t){return TS.boot_data.app==="client"?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("isChrome",function(t){return TS.model.is_chrome_desktop||TS.model.is_chrome_mobile?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("isWeb",function(t){return TS.boot_data.app==="web"||TS.boot_data.app==="space"||TS.boot_data.app==="calls"?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("isMac",function(t){return TS.model.is_mac?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("isWin",function(t){return TS.model.is_win?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("isLin",function(t){return TS.model.is_lin?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("isOurApp",function(t){return TS.model.is_our_app?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("feature",function(t){var n=t.hash.flag;return TS.qs_args[n]==1||TS.boot_data[n]==1?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("pageNeedsEnterprise",function(t){return TS.boot_data.page_needs_enterprise?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("experiment",function(t){var n=t.hash.name,a=t.hash.group||"treatment";return TS.interop.experiments.getGroupForUser(n)===a?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("cash",function(t){var n=t.hash.all_digits||!1,a=t.hash.currency_code||"USD",d=parseInt(t.hash.value,10);return TS.interop.currency.formatCurrency(d,a,{displayTrailingZeroes:n})}),Handlebars.registerHelper("toLowerCase",function(t){return t.toLowerCase()}),Handlebars.registerHelper("initialsSafe",function(t){var n=TS.interop.rules.teams.getTeamInitials(t,{limit:2});return new Handlebars.SafeString(n)}),Handlebars.registerHelper("json",function(t){return typeof t=="object"&&t!==null&&t.name==="json"?JSON.stringify(this):JSON.stringify(t)}),Handlebars.registerHelper("currentTeamName",function(){return _.escape(_.get(TS.model.team,"name",""))}),Handlebars.registerHelper("currentTeamNameSafe",function(){return new Handlebars.SafeString(_.escape(_.get(TS.model.team,"name","")))}),Handlebars.registerHelper("isSlackbot",function(t){return TS.interop.rules.members.isSlackbot(t)}),Handlebars.registerHelper("convertFilesize",function(t){return TS.interop.utility.convertFilesize(t)}),Handlebars.registerHelper("roundToThree",function(t){return TS.utility.roundToThree(t)}),Handlebars.registerHelper("toDate",function(t){return TS.interop.datetime.formatDate(t,"{date_num}",{customFormat:"YYYY-MM-DD, LT"})}),Handlebars.registerHelper("toTime",function(t,n,a){return(!t||_.isObject(t))&&(t=window.moment().unix()),TS.interop.datetime.formatDate(t,"{time}",{do24hrTime:TS.utility.date.do24hrTime(),includeMeridiem:n!==!1,includeSeconds:a===!0})}),Handlebars.registerHelper("isToday",function(t,n){return TS.interop.datetime.isToday(TS.interop.datetime.toDateObject(t))?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("if_equal",function(t,n){return n=s(n),t==n.hash.compare?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("if_gt",function(t,n){return n=s(n),t>n.hash.compare?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("if_lt",function(t,n){return n=s(n),t<n.hash.compare?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("or",function(t,n,a){return a=s(a),t||n?a.fn(this):a.inverse(this)}),Handlebars.registerHelper("and",function(t,n,a){return a=s(a),t&&n?a.fn(this):a.inverse(this)}),Handlebars.registerHelper("foreach",function(t,n){return n.inverse&&!t.length?n.inverse(this):t.map(function(a,d){var m={index:d,value:a,length:t.length};return m.first=d===0,m.last=d===t.length-1,n.fn(m)}).join("")}),Handlebars.registerHelper("repeat",function(t,n){for(var a="",d=0;d<t;d+=1)a+=n.fn(d);return a}),Handlebars.registerHelper("newWindowName",TS.templates.builders.newWindowName),Handlebars.registerHelper("truncate",function(t,n){var a=truncate(t,n);return a.replace(/&#64;/g,"@")}),Handlebars.registerHelper("truncateToNearestWordBoundary",TS.utility.truncateToNearestWordBoundary),Handlebars.registerHelper("isArchived",function(t){return TS.interop.rules.channels.isArchived(t)}),Handlebars.registerHelper("memberIsUnavailable",function(t,n){return n=s(n),TS.interop.rules.members.isUnavailable(TS.redux.getState(),t)?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("isModelObExtShared",function(t,n){return TS.interop.utility.isModelObjectExternal(t)?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("shouldUseInitialsIcon",function(t,n,a){return t&&t.icon&&(t.icon.image_default||n)?a.fn(this):a.inverse(this)}),Handlebars.registerHelper("makeTeamNameList",function(t,n){if(n=n||{},n=n.hash||n,!t)return"";var a=_.map(t,m=>TS.teams.getTeamById(m)).map(m=>TS.interop.rules.teams.isUnknown(m)?TS.templates.unknown_team({id:m.id,subtler:n.subtler}):_.escape(TS.interop.rules.teams.getTeamDisplayName(m))),d=TS.interop.i18n.listify(a,{...n,noEscape:!0}).join("");if(d)return new Handlebars.SafeString(d)}),Handlebars.registerHelper("mpimMemberCount",function(t){return TS.mpims.getMemberCount(t)}),Handlebars.registerHelper("mpimDisplayName",function(t,n,a,d,m){n=n===!0,m=m===!0;var u=TS.mpims.legacyGetDisplayName(t,n,a===!0,d,m);return n||m?new Handlebars.SafeString(u):u}),Handlebars.registerHelper("currentUserId",function(){return TS.model.user.id}),Handlebars.registerHelper("makeMemberPresenceIcon",function(t){return TS.warn("Presence icons should not be used outside of the client application, because they rely on a WS connection to keep presence up to date. Rendering anyway, but be careful out there!"),new Handlebars.SafeString(TS.templates.makeMemberPresenceIcon(t))}),Handlebars.registerHelper("showDraftIcon",function(t,n){return TS.templates.builders.legacyShowDraftIcon(t)?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("makeMemberPreviewLink",function(){var t=TS.templates.builders.makeMemberPreviewLink.apply(this,arguments);return new Handlebars.SafeString(t)}),Handlebars.registerHelper("makeMemberPreviewLinkImage",function(){return new Handlebars.SafeString(TS.templates.builders.makeMemberPreviewLinkImage.apply(this,arguments))}),Handlebars.registerHelper("makePendingUserImage",function(){return new Handlebars.SafeString(TS.templates.builders.makePendingUserImage.apply(this,arguments))}),Handlebars.registerHelper("getMemberPreviewLinkImageArgs",function(t,n,a,d,m,u,f){var p;if(typeof t=="object"?p=t:p=TS.interop.members.getMemberById(t),!p||!p.profile)return"";a=a===!0,d=d===!0,m=m===!0,u=u===!0,f=typeof f=="string"?f:!1,t==="USLACKBOT"&&f&&(p=TS.utility.slackbot.getWithFeels(f));var S,v,P;switch(v="background-image: ",P=[],n){case 20:TS.environment.is_retina?S=p.profile.image_48:S=p.profile.image_24;break;case 24:TS.environment.is_retina?S=p.profile.image_48:S=p.profile.image_24;break;case 32:TS.environment.is_retina?S=p.profile.image_72:S=p.profile.image_32;break;case 36:TS.environment.is_retina?S=p.profile.image_72:S=p.profile.image_48;break;case 48:TS.environment.is_retina?S=p.profile.image_72:S=p.profile.image_48;break;case 56:TS.environment.is_retina?S=p.profile.image_192:S=p.profile.image_72;break;case 72:TS.environment.is_retina?S=p.profile.image_192:S=p.profile.image_72;break;case 192:TS.environment.is_retina?S=p.profile.image_512||p.profile.image_192:S=p.profile.image_192;break;case 512:TS.environment.is_retina?S=p.profile.image_1024||p.profile.image_512||p.profile.image_192:S=p.profile.image_512||p.profile.image_192;break;default:TS.environment.is_retina?S=p.profile.image_72:S=p.profile.image_48;break}if(P.push(`url('${S}')`),n===512){var C=TS.environment.is_retina?p.profile.image_72:p.profile.image_48;P.push(`url('${C}')`)}a?v=P.length?P.join(", "):"":v=P.length?v+P.join(", "):"";var D={omit_link:d,omit_badge:m,lazy:a,member:p,size:n,include_restricted_overlay:!u||!0,bg_img_style:v};return D}),Handlebars.registerHelper("getGuestBadgeSize",function(t){var n;switch(t){case 24:n=10;break;case 32:case 36:case 48:n=16;break;case 72:n=24;break;case 192:n=48;break;case 512:n=96;break;default:n=16}return n}),Handlebars.registerHelper("getTeamBadgeSize",r),Handlebars.registerHelper("getPrefCompliantMemberNameById",function(t){return TS.interop.rules.members.getPrefCompliantMemberNameById(t)}),Handlebars.registerHelper("getMemberComponentPrimaryName",function(t,n){return n?n==="real_name"?TS.interop.rules.members.getMemberRealName(t):TS.getMemberMentionName(t):TS.interop.rules.members.getPrefCompliantMemberName(t,!1,!1)}),Handlebars.registerHelper("memberIsInvited",function(t,n){return t&&t.is_invited_user?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("memberComponentHasSecondaryName",function(t,n,a){var d=!1;return t&&(n?n==="real_name"?d=!!TS.interop.rules.members.getMemberProfileFieldDisplayName(t):d=!!TS.interop.rules.members.getMemberRealName(t):d=!!TS.interop.rules.members.getMemberSecondaryName(t)),d&&!t.is_invited_user?a.fn(this):a.inverse(this)}),Handlebars.registerHelper("getMemberComponentSecondaryName",function(t,n){if(n){if(n==="real_name")return TS.interop.rules.members.getMemberProfileFieldDisplayName(t);if(n==="display_name")return TS.interop.rules.members.getMemberProfileFieldDisplayName(t)?TS.interop.rules.members.getMemberRealName(t):""}return TS.interop.rules.members.getMemberSecondaryName(t)}),Handlebars.registerHelper("getPrefCompliantMemberName",function(t,n,a){return TS.interop.rules.members.getPrefCompliantMemberName(t,n===!0,a===!0)}),Handlebars.registerHelper("getTeamById",function(t){return TS.teams.getTeamById(t)}),Handlebars.registerHelper("getTeamDisplayName",function(t){return TS.interop.rules.teams.isUnknown(t)?new Handlebars.SafeString(TS.templates.unknown_team({id:t.id})):TS.interop.rules.teams.getTeamDisplayName(t)}),Handlebars.registerHelper("getMemberPreviewLinkTarget",function(t){return TS.utility.shouldLinksHaveTargets()?new Handlebars.SafeString(`target="/team/${t.id}"`):""}),Handlebars.registerHelper("getMemberRealName",function(t){return TS.interop.rules.members.getMemberRealName(t)}),Handlebars.registerHelper("getMemberProfileFieldDisplayNameandRealNameInCorrectOrder",function(t){var n=_.escape(TS.interop.rules.members.getPrefCompliantMemberName(t)),a;t.is_self?a=TS.interop.i18n.t("(you)","templates_helpers")():a=_.escape(TS.interop.rules.members.getMemberSecondaryName(t));var d=`<span class="member_real_name">${n}</span>`,m=`<span class="member_preferred_name">${a}</span>`;return new Handlebars.SafeString(d+m)}),Handlebars.registerHelper("memberHasIm",function(t){var n=t.hash.member,a=!1;return n&&TS.redux.channels.getImByMemberId(n.id)&&(a=!0),a?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("memberHasImUnreadCount",function(t){var n=t.hash.member,a=!1;if(n){var d=TS.redux.channels.getImByMemberId(n.id);d&&d.unread_cnt&&(a=!0)}return a?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("getUnreadCountForIMByMemberId",function(t){var n=TS.redux.channels.getImByMemberId(t);return n?n.unread_cnt:""}),Handlebars.registerHelper("makeMemberLinksWithDisplayNames",function(t){if(!t)return"";var n=t.split(/\s*,\s*/).map(function(a){return TS.templates.builders.makeMemberPreviewLink(TS.interop.members.getMemberById(a))}).join(", ");return new Handlebars.SafeString(n)});function i(t){var n=TS.interop.members.getMemberById(t.user);if(!n)return TS.warn(`Missing member in makeIMLink: ${t.user}`),TS.templates.search_im_link({im_exists:!1,im_member_id:t.user,im_name:t.user,im_id:t.id,member_color:"unknown"});var a={im_exists:!TS.interop.rules.channels.isImWithDeletedMember(t),im_member_id:n.id,im_name:TS.ims.getDisplayNameOfUserForIm(t),im_id:t.id,member_color:`color_${n?`${n.id} color_${n.color}`:"unknown"}`};if(TS.utility.shouldLinksHaveTargets()){var d=`/messages/${t.id}`;TS.interop.rules.channels.isImWithDeletedMember(t)&&(d=TS.templates.builders.newWindowName()),a.target=d}return TS.templates.search_im_link(a)}o(i,"makeIMLink"),Handlebars.registerHelper("makeIMLink",function(t){return new Handlebars.SafeString(i(t))}),Handlebars.registerHelper("tinyspeck",function(t){return t.inverse(this)}),Handlebars.registerHelper("math",function(t,n,a){return arguments.length<4&&(a=n,n="+"),t=parseFloat(t),a=parseFloat(a),{"+":t+a,"-":t-a,"*":t*a,"/":t/a,"%":t%a}[n]}),Handlebars.registerHelper("loadingHTML",function(){return new Handlebars.SafeString(TS.templates.builders.loadingHTML())}),Handlebars.registerHelper("versioned_loading_animation",function(){return vvv_abs_url+"/img/loading.gif"}),Handlebars.registerHelper("versioned_upload_file_icon",function(t){if(t==="1x")return vvv_abs_url+"/img/upload_file_icon.png";if(t==="2x")return vvv_abs_url+"/img/upload_file_icon@2x.png"}),Handlebars.registerHelper("versioned_default_application_icon",function(){return vvv_abs_url+"/img/apps/default_new_app_icon.png"}),Handlebars.registerHelper("versioned_tos_book_illustration",function(t){if(t==="1x")return vvv_abs_url+"/img/signup/book_illustration.png";if(t==="2x")return vvv_abs_url+"/img/signup/book_illustration@2x.png"}),Handlebars.registerHelper("number",function(t){return _.isUndefined(t)?"":TS.interop.i18n.number(t)||""}),Handlebars.registerHelper("atLabel",function(t){return TS.templates.builders.atLabel(t)}),Handlebars.registerHelper("getMemberTypeClass",TS.templates.builders.getMemberTypeClass),Handlebars.registerHelper("dangerouslyRenderHTML",function(t){return new Handlebars.SafeString(t)}),Handlebars.registerHelper("getTeamIconOfSize",function(t,n){return t&&t.icon?t.icon[`image_${n}`]:null}),Handlebars.registerHelper("getIconSizeToFit",function(t){return TS.interop.utility.getIconSizeToFit(t,[230,132,102,88,68,44,34])}),Handlebars.registerHelper("escape",function(t){return _.escape(t)})},test:function(){return{_optionsFnInverseBooleanHelper:s}}});var s=o(function(i){return typeof i.fn!="function"&&(i.fn=function(){return!0}),typeof i.inverse!="function"&&(i.inverse=function(){return!1}),i},"_optionsFnInverseBooleanHelper"),r=o(function(i){var t;switch(i){case 32:case 36:case 48:t=16;break;case 72:t=22;break;case 192:case 512:break;default:t=16}return t},"_getTeamBadgeSize")})()},1182967304:()=>{(function(){TS.registerModule("templates",{onStart:function(){i(),TS.members&&TS.members.user_color_changed_sig.add(TS.templates.memberUserColorChanged,TS.templates),TS.prefs&&TS.prefs.sidebar_behavior_changed_sig.add(TS.templates.sidebarBehaviorPrefChanged,TS.templates),TS.environment.retina_changed_sig.add(s)},makeMemberPresenceDomClass:function(n){return`member_presence_${n}`},makeMemberPresenceStateClass:function(n){var a=TS.redux.presence.getPresenceByMemberId(n.id);return a},makeMemberPresenceIcon:function(n){if(n.deleted)return"";var a=TS.templates.makeMemberPresenceDomClass(n.id),d="ts_icon_presence",m=TS.redux.presence.getPresenceByMemberId(n.id),u=m==="active"?TS.interop.i18n.t("active","templates_helpers")():TS.interop.i18n.t("away","templates_helpers")();n.is_ultra_restricted?(a+=" ura",d="ts_icon_presence_ura"):n.is_restricted?(a+=" ra",d="ts_icon_presence_ra"):TS.interop.rules.members.isExternal(n)?(a+=" external",d="ts_icon_presence_external"):n.is_slackbot&&(d="ts_icon_heart");var f=`<i aria-hidden="true" class="ts_icon ${d} presence_icon"></i>`,p=TS.templates.makeMemberPresenceStateClass(n),S=`<span data-member-presence="${n.id}" class="presence ${p} ${a}" title="${u}">${f}</span>`;return S},memberUserColorChanged:function(n){var a=`color_${n.id}`;if(n.color==n.member_color){var d=`color_rule_${a}`,m=$(`#${d}`);m.remove();return}TS.templates.makeUserColorRule(n)},makeUserColorRule:function(n){var a=`color_${n.id}`,d=`#${_.escape(n.member_color)}`,m;m=`            .${a}:not(.nuc) {                color:${d};            }        `;var u=`color_rule_${a}`,f=$(`#${u}`);f.length?f.text(m):$(`<style type="text/css" id="${u}">${m}</style>`).appendTo("body")},sidebarBehaviorPrefChanged:function(){TS.templates.makeSidebarBehaviorRule()},makeSidebarBehaviorRule:function(){var n,a="sidebar_behavior",d=$(`#${a}`);TS.prefs.getPref("sidebar_behavior")==="hide_read_channels"?n="				.channels_list_holder ul li:not(.unread):not(.active):not(.show_in_list_even_though_no_unreads) {					display: none;			}":TS.prefs.getPref("sidebar_behavior")==="hide_read_channels_unless_starred"&&(n="				.channels_list_holder div:not(#starred_div)>ul li:not(.unread):not(.active):not(.is_starred):not(.show_in_list_even_though_no_unreads) {					display: none;			}"),n?d.length?d.text(n):$(`<style type="text/css" id="${a}">${n}</style>`).appendTo("head"):$(`#${a}`).remove()}});var s=o(function(){var n,a,d,m;$(".member_image").each(function(){m=$(this),n=m.data("member-id"),a=m.data("thumb-size"),d=!m.is("a"),n&&a&&$(this).replaceWith(TS.templates.builders.makeMemberPreviewLinkImage(n,a,!1,d))}),m=null},"_redrawRetinaAssets"),r=/{{\s*i18n_ns\s*('|")[a-zA-Z0-9]+('|")\s*}}/,i=o(function(){Object.keys(TS.raw_templates).forEach(function(n){TS.templates[n]=t(n,TS.raw_templates[n]),TS.raw_template_paths||(TS.raw_template_paths={},TS.interop.utility.getLogger({getState:TS.redux.getState}).error("MISSING_RAW_TEMPLATE_PATHS")),TS.templates[`${n}_path`]=TS.raw_template_paths[n],Handlebars.registerPartial(n,TS.templates[n])}),delete TS.raw_templates},"_load"),t=o(function(n,a){if(!a)return TS.warn(`${n} was passed no html`),null;r.test(a)&&(a+=" {{_i18n_ns_end}}");var d=Handlebars.compile(a);return function(m){m=m||{};var u=!1,f=!1,p=TS.interop.experiments.getGroupForUser("jira_newxp_2040");if(p==="variant"){var S=Math.floor(Math.random()*1e5);u=S==1,TS.templates_to_audit&&TS.templates_to_audit.includes(n)&&(u=!0,f=!0)}if(u)try{var v={contexts:{ui_context:{action:"impression",ui_properties:{element_name:`${n}.hbs`}}}};!TS.interop.environment.isDev&&!TS.interop.environment.isQa&&TS.interop.clog.track("HANDLEBARS_TEMPLATE_LOGS",v);var P=/\/[A-Z0-9-.]*\//g,C=window.location.pathname.replace(P,"/#####/"),D=new Error;D.fileName=TS.templates[`${n}_path`],D.message=`${C} ${window.location.hash}`,D.stack="";var O="HANDLEBARS_TEMPLATE_LOGS";f&&(O="HANDLEBARS_TEMPLATE_LOGS_AUDIT"),TS.interop.utility.getLogger({getState:TS.redux.getState}).error(D,O,{subtype:n})}catch{}return d(m)}},"_compile")})()},6131426979:()=>{(function(){TS.registerModule("tips",{onStart:function(){s.delegate(".ts_tip_lazy, .ts_tip_float","mouseenter",m),s.delegate(".ts_tip_float","mouseleave",u),s.on("click",".ts_tip",function(){S($(this))})},hideAll:function(){$(".ts_tip").addClass("ts_tip_hide")},unhideAll:function(){$(".ts_tip").removeClass("ts_tip_hide")},updateTipTitle:function(D,O){var Q=v(D);Q.length?Q.html(O):D.attr("title",O),i&&i[0]==D[0]&&(O?(n.html(O),p()):f())}});var s=$("BODY"),r=null,i=null,t=null,n=null,a=10,d=0,m=o(function(D){i=$(D.currentTarget);var O=i.hasClass("ts_tip_multiline");if(i.addClass("ts_tip_hidden"),i.children(".ts_tip_tip").length==0&&C(i,O),i.removeAttr("title"),i.removeClass("ts_tip_lazy"),$("#ts_tip_float_floater").remove(),i.hasClass("ts_tip_float")){var Q=i.attr("class").split(/\s+/).filter(function(H){return H==="ts_tip_float"||H==="ts_tip_lazy"?!1:H.indexOf("ts_tip")===0}),Y=TS.templates.builders.strBuilder('<div id="ts_tip_float_floater" style="width:${w}px; height:${h}px;" class="${classes}">${tip_html}</div>',{w:i.outerWidth(),h:i.outerHeight(),classes:Q.join(" "),tip_html:i.find(".ts_tip_tip").clone()[0].outerHTML});t=$(Y),s.append(t),d=setTimeout(function(){t.removeClass("ts_tip_hidden"),p()},a),r=i.closest(":scrollable(vertical)"),r.on("scroll.ts_tip_removal",f),i.on("destroyed.ts_tip_removal",f),i.hasClass("ts_tip_hide_on_click")&&i.on("click.ts_tip_removal",f),O?n=t.find(".ts_tip_multiline_inner"):(n=t.find(".ts_tip_tip_inner"),n.length||(n=t.find(".ts_tip_tip")))}else setTimeout(function(){i.removeClass("ts_tip_hidden")},a)},"_onMouseEnter"),u=o(function(){f()},"_onMouseLeave"),f=o(function(){clearTimeout(d),t&&t.addClass("ts_tip_hidden"),i&&i.length&&(i.off("click.ts_tip_removal"),i.off("destroyed.ts_tip_removal")),r&&r.off("scroll.ts_tip_removal"),r=null,i=null,t=null,n=null},"_hideFloater"),p=o(function(){var D=i.offset(),O=2,Q=window.innerWidth-O,Y=window.innerHeight-O,H=t.hasClass("ts_tip_multiline"),F=o(function(){return H?t.find(".ts_tip_multiline_inner").dimensions_rect():t.find(".ts_tip_tip").dimensions_rect()},"getRect"),ee=o(function(x){t.removeClass("			ts_tip_right 			ts_tip_rightish 			ts_tip_left 			ts_tip_leftish 			ts_tip_multiline_top_leftish 			ts_tip_multiline_top_left 			ts_tip_multiline_top_right 			ts_tip_multiline_top_rightish 		").addClass(x)},"setHorizontalPositionClass");t.css("left",D.left).css("top",D.top);var c=F();c.bottom>Y?t.removeClass("ts_tip_bottom").addClass("ts_tip_top"):c.top<O&&t.removeClass("ts_tip_top").addClass("ts_tip_bottom"),H?(c.right>Q?ee("ts_tip_multiline_top_rightish"):c.left<O&&ee("ts_tip_multiline_top_leftish"),c=F(),c.right>Q?ee("ts_tip_multiline_top_right"):c.left<O&&ee("ts_tip_multiline_top_left")):(c.right>Q?ee("ts_tip_rightish"):c.left<O&&ee("ts_tip_leftish"),c=F(),c.right>Q?ee("ts_tip_right"):c.left<O&&ee("ts_tip_left"))},"_positionFloater"),S=o(function(D){var O=v(D),Q="tip-toggle-auto",Y;if(D.data(Q)?Y=D:O.data(Q)&&(Y=O),!!(Y&&Y.length)){var H=O.html(),F=Y.data(Q);if(!F)return TS.warn("No toggle state text defined on tipped element. Please add text to data-tip-toggle-text or data-tip-toggle-auto attribute");TS.tips.updateTipTitle(D,F),Y.data(Q,H)}},"_toggleTipTitle"),v=o(function(D){var O=D.find(".ts_tip_multiline_inner");return O.length||(O=D.find(".ts_tip_tip_inner")),O.length||(O=D.find(".ts_tip_tip")),O},"_getTipEl"),P=o(function(D){if(!D.text().trim().length&&!D.attr("aria-label"))return _.uniqueId("ts_tip_tip_")},"_possiblyMakeLabelId"),C=o(function(D,O){var Q="",Y=_.escape(D.prop("title")),H=P(D),F=H?` id="${H}"`:"";Q=O?`<span class="ts_tip_multiline_inner">${Y}</span>`:Y;var ee=["<span",F,' class="ts_tip_tip"',">",Q,"</span>"];D.append(ee.join("")),D.attr("aria-labelledby",H)},"_buildDom")})()},540370361:()=>{(function(){TS.registerModule("ui.a11y",{unread_message_strings:{},$aria_live_div:null,zoom_level_changed_sig:new signals.Signal,onStart:function(){t(),u(),p(),$(document).on("focus","input[placeholder],textarea[placeholder]",function(C){i($(C.target))}),$(document).on("blur","input[placeholder],textarea[placeholder]",function(C){i($(C.target))})},focusAndAddTabindex:function(C){C&&(C.attr("tabindex")&&C.data("previous-tabindex",C.attr("tabindex")),C.attr("tabindex","0"),C.focus())},ariaLiveAnnounce:function(C,D){TS.ui.a11y.$aria_live_div.empty(),TS.ui.a11y.$aria_live_div.attr("aria-live",D?"assertive":"polite"),TS.ui.a11y.$aria_live_div.text(C)},assembleActiveModelName:function(){var C=TS.shared.legacyGetActiveModelOb(),D;if(!C)return"";if(C.is_channel)D=TS.interop.i18n.t("Channel #{model_name}","a11y")({model_name:C.name});else if(C.is_im)D=TS.interop.i18n.t("Direct message with {model_name}","a11y")({model_name:TS.interop.rules.members.getPrefCompliantMemberNameById(C.user)});else if(C.is_mpim)D=TS.interop.i18n.t("Direct message with {model_name}","a11y")({model_name:TS.mpims.legacyGetDisplayName(C)});else if(C.is_group)D=TS.interop.i18n.t("Private Channel {model_name}","a11y")({model_name:C.name});else return"";return D},getContrastColor:function(C){var D=!1;if(C=C.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(F,ee,c,x){return ee+ee+c+c+x+x}),C=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(C),C){var O=parseInt(C[1],16),Q=parseInt(C[2],16),Y=parseInt(C[3],16),H=(O*299+Q*587+Y*114)/1e3;D=H>=128?"#000000":"#FFFFFF"}return D},test:function(){return{createAriaLiveElement:t,destroyAriaLiveElement:n,getMessageInputElement:a,getMessageDivElement:d}}});var s={70:"-3",80:"-2",90:"-1",normal:"0",110:"1",125:"2",150:"3"},r=Object.keys(s).reduce(function(C,D){return C[s[D]]=D,C},{}),i=o(function(C){var D=C.attr("placeholder"),O=C.attr("aria-label")||"",Q=!!O.length,Y=!!C.val().trim().length;if(Y&&!Q&&D.length){C.attr("aria-label",D);return}!Y&&Q&&O==D&&C.removeAttr("aria-label")},"_labelWithPlaceholder"),t=o(function(){return TS.ui.a11y.$aria_live_div=$('<div id="aria_live_announcer" role="status"></div>'),$("body").append(TS.ui.a11y.$aria_live_div),TS.ui.a11y.$aria_live_div},"_createAriaLiveElement"),n=o(function(){TS.ui.a11y.$aria_live_div.remove(),delete TS.ui.a11y.$aria_live_div},"_destroyAriaLiveElement"),a=o(function(){return $()},"_getMessageInputElement"),d=o(function(){return $()},"_getMessageDivElement"),m,u=o(function(){TS.model.is_electron&&(m=TS.interop.desktop.getZoom(),$(window).on("resize",f))},"_bindResizeListener"),f=o(function(){var C=TS.interop.desktop.getZoom();m!=C&&(m=C,TS.ui.a11y.zoom_level_changed_sig.dispatch({zoom_level:C}))},"_onResize"),p=o(function(){TS.model.is_electron&&($("body").append('<div class="zoom_level_indicator hidden"></div>'),TS.ui.a11y.zoom_level_changed_sig.add(P))},"_createZoomLevelIndicatorUI"),S=o(function(C){var D=r[C]||"100",O=D==="normal"?"100":D,Q=TS.interop.i18n.t("zoom: <strong>{zoom_percentage}%</strong>","a11y")({zoom_percentage:O});$(".zoom_level_indicator").html(Q)},"_setZoomLevel"),v,P=o(function(C){if(!$("body").hasClass("loading")){var D=$(".prefs_modal.active");if(!(D.length&&D.find(".a11y_pref_zoom").length)){v&&(clearTimeout(v),v=null),S(C.zoom_level);var O=$(".zoom_level_indicator");O.insertAfter(document.body.lastElementChild),O.removeClass("hidden").show(0);var Q=O.outerWidth()/2,Y=`calc(50vw - ${Q}px)`;O.css("left",Y),v=setTimeout(function(){O.fadeOut(100)},1e3)}}},"_showZoomLevel")})()},8200244755:()=>{(function(){TS.registerModule("ui.admin_edit_team_profile",{onStart:function(){$("body").on("click",'[data-action="edit_team_profile_modal"]',TS.ui.admin_edit_team_profile.start)},start:function(){ne()&&a()}});var s,r,i,t=[],n=50,a=o(function(){var I={body_template_html:TS.templates.admin_edit_team_profile_modal(),onShow:d,onCancel:m};TS.ui.fs_modal.start(I)},"_start"),d=o(function(){s=$("#edit_team_profile_container"),r=$("body"),s.on("click",'[data-action="edit_team_profile_to_custom"]',c),s.on("click",'[data-action="edit_team_profile_to_add"]',ee),s.on("click",'[data-action="edit_team_profile_to_edit"]',x),s.on("click",'[data-action="edit_team_profile_to_hide"]',re),s.on("click",'[data-action="edit_team_profile_to_delete"]',J),s.on("click",'[data-action="edit_team_profile_cancel"]',F),s.on("click",'[data-action="edit_team_profile_confirm_edit"]',D),s.on("click",'[data-action="edit_team_profile_confirm_hide"]',v),s.on("click",'[data-action="edit_team_profile_confirm_delete"]',S),s.on("click",'[data-action="edit_team_profile_remove_option"]',j),s.on("click",'[data-action="edit_team_profile_add_option"]',X),s.on("focusin",'[data-action="edit_team_profile_update_preview_label"], [data-action="edit_team_profile_update_preview_hint"], .option_header_row + .option_row [data-action="edit_team_profile_update_preview_option"]',U),s.on("focusout",'[data-action="edit_team_profile_update_preview_label"], [data-action="edit_team_profile_update_preview_hint"], .option_header_row + .option_row [data-action="edit_team_profile_update_preview_option"]',h),s.on("input",'[data-action="edit_team_profile_update_preview_label"], [data-action="edit_team_profile_update_preview_hint"], .option_header_row + .option_row [data-action="edit_team_profile_update_preview_option"]',y),s.on("click",'[data-action="edit_team_profile_list_menu"]',B),s.on("input","input",me),r.on("keydown.admin_submit",u),f().then(F).catch(TS.error)},"_onShow"),m=o(function(){ce(!0),s=null,t=[],i=null,r.off("keydown.admin_submit"),r=null},"_onCancel"),u=o(function(I){if(I.which==TS.utility.keymap.enter)return $(i).find('button[type="submit"]').trigger("click"),!1},"_onKeydown"),f=o(function(){return TS.team.ensureTeamProfileFields()},"_ensureProfile"),p=o(function(I,l){if(I)return TS.interop.api.call(I,l).then(function(g){return I==="team.profile.delete"?TS.interop.members.deleteProfileFields(TS.model.team.id,JSON.parse(l.profile).fields):I==="team.profile.reorder"?TS.interop.teams.reorderTeamProfileFields(TS.model.team.id,_.get(g,"data.profile.fields")):TS.interop.members.updateProfileFields(TS.boot_data.team_id,_.get(g,"data.profile.fields")),Promise.resolve(g)},function(g){return Promise.reject(g)})},"_apiCall"),S=o(function(I){var l=$(I.target),g=l.data("id");if(g||(l=l.closest("[data-id]")),g=l.data("id"),!!g){var b=TS.team.getTeamProfileFieldById(g);b&&O("team.profile.delete",[g]).then(F,_.noop)}},"_deleteField"),v=o(function(I){C(I,!0)},"_hideField"),P=o(function(I){C(I,!1)},"_showField"),C=o(function(I,l){var g=$(I.target),b=g.data("id");if(b||(g=g.closest("[data-id]")),b=g.data("id"),!b)return;var M=TS.team.getTeamProfileFieldById(b);if(!M)return;M=$.extend({},M),M.is_hidden=l,l&&(M.ordering=M.ordering||E());function Z(){F(),ie(b)}o(Z,"resolve"),O("team.profile.set",[M]).then(Z,_.noop)},"_hideOrShowField"),D=o(function(I){var l=s.find("#edit_team_profile_edit");if(!TS.ui.validation.validate(l,{quiet:!0,fast:!0})){TS.ui.validation.validate(l),Ladda.stopAll(),$("#edit_team_profile_confirm_edit_btn").addClass("disabled");return}var g=$(I.target),b=g.data("id");b||(g=g.closest("[data-id], [data-type]")),b=g.data("id");var M=s.find('input[name="label"]'),Z=s.find('input[name="hint"]'),V=TS.team.getTeamProfileFieldById(b)||{},_e=JSON.stringify(V);V=$.extend({},V),V.type=V.type||g.data("type")||"text",V.label=M.val().trim(),V.hint=Z.val().trim(),V.ordering=V.ordering||E(),V.type==="options_list"&&(V.possible_values=s.find('input[name^="option_"]').map(function(){return $(this).val().trim()}).toArray());function fe(){F(),ie(b)}o(fe,"resolve"),JSON.stringify(V)==_e?(fe(),Ladda.stopAll()):O("team.profile.set",[V]).then(fe,_.noop)},"_editField"),O=o(function(I,l){l=l&&l.length?l:TS.model.team.profile.fields;var g={profile:JSON.stringify({fields:l})};return p(I,g).catch(function(b){if(b.data.error==="no_perms"||b.data.error==="missing_scope"){var M=TS.boot_data.page_needs_enterprise,Z=M?TS.interop.i18n.t("Sorry! An organization owner or admin is required to update this setting.","team_profile","21d269f8b1a2802d90b32308195ac5b67c9413f6")():TS.interop.i18n.t("Sorry! An owner in your workspace has restricted who can customize your members\u2019 profile.","team_profile")();TS.generic_dialog.start({body:Z,show_cancel_button:!1,esc_for_ok:!0,fullscreen:!1,onEnd:TS.ui.fs_modal.close})}else return b.data.error==="field_bad_order"?(TS.error(`Failed to create profile field: ${b.data.error}`),TS.generic_dialog.alert(TS.interop.i18n.t("Apologies, but the maximum number of profile fields you can add is {max_no_of_fields, number}. Please remove some existing fields if you\u2019d like to add different ones.","team_profile")({max_no_of_fields:n}))):(TS.error(`Failed to customize profile: ${b.data.error}`),TS.generic_dialog.alert(TS.interop.i18n.t("Sorry! Something went wrong. Please try again.","team_profile")()))}).finally(Ladda.stopAll)},"_saveProfile"),Q=o(function(){return(TS.model.team.profile.fields||[]).some(I=>I.field_name==="title"&&I.options&&I.options.is_scim)},"_shouldHideDefaultTitle"),Y=o(function(){return TS.interop.experiments.getGroupForUser("rimeto_profile_show_default_phone_webapp")==="on"?!1:(TS.model.team.profile.fields||[]).some(I=>I.field_name==="primaryPhone"&&I.options&&I.options.is_scim)},"_shouldHideDefaultPhone"),H=o(function(){return TS.prefs.getTeamPref("display_pronouns")},"_shouldShowPronounField"),F=o(function(){t.length=0,t.push({back:F});var I={};I.team_profile_fields=ae(),I.hidden_team_profile_fields=ue(),I.default_team_profile_fields=le(),I.hide_default_title=Q(),I.hide_default_phone=Y(),I.show_pronoun_field=H();var l=TS.templates.admin_edit_team_profile_list(I);s.find("#edit_team_profile_header").text(TS.interop.i18n.t("Customize profile","team_profile")()).removeClass("hidden center_and_narrow");var g;TS.model.team.profile&&TS.model.team.profile.fields.length>=50?g=`<div class="alert alert_info"><i class="ts_icon ts_icon_info_circle"></i>${TS.interop.i18n.t("You have reached the maximum number of fields that can be added to profiles.","team_profile")()}</div>`:g=TS.interop.i18n.t("Expand your members\u2019 profiles by adding additional fields below","team_profile")(),s.find("#edit_team_profile_value_note").html(g).removeClass("hidden center_and_narrow"),s.find("#edit_team_profile_list").html(l),K("#edit_team_profile_list"),R(),q(),ce(!0)},"_switchToList"),ee=o(function(){t.push({back:ee});var I={};I.default_team_profile_fields=le();var l=TS.templates.admin_edit_team_profile_add(I);s.find("#edit_team_profile_header").text(TS.interop.i18n.t("Select a field type","team_profile")()).removeClass("center_and_narrow"),s.find("#edit_team_profile_value_note").addClass("hidden"),s.find("#edit_team_profile_add").html(l),K("#edit_team_profile_add"),q(),ce()},"_switchToAdd"),c=o(function(){t.push({back:c});var I=TS.templates.admin_edit_team_profile_custom();s.find("#edit_team_profile_header").text(TS.interop.i18n.t("Create a new field","team_profile")()).removeClass("center_and_narrow"),s.find("#edit_team_profile_value_note").text(TS.interop.i18n.t("Which type of field would you like to create?","team_profile")()).removeClass("hidden center_and_narrow"),s.find("#edit_team_profile_custom").html(I),K("#edit_team_profile_custom"),q(),ce(),w()},"_switchToCustom"),x=o(function(I){var l=$(I.target);if(l.hasClass("ts_icon_grabby_patty"))return!1;var g=l.data("id");g||(l=l.closest("[data-id], [data-type]")),g=l.data("id");var b={},M;if(!g)b.type=l.data("type"),b.label=l.data("label"),M=TS.interop.i18n.t("Customize profile field","team_profile")();else{if(b=TS.team.getTeamProfileFieldById(g),!b)return;M=TS.interop.i18n.t("Edit profile field","team_profile")()}I.stopPropagation(),t.push({back:x,event:I});var Z=TS.templates.admin_edit_team_profile_edit(b);s.find("#edit_team_profile_header").text(M).removeClass("center_and_narrow"),s.find("#edit_team_profile_value_note").addClass("hidden"),s.find("#edit_team_profile_edit").html(Z),K("#edit_team_profile_edit"),L(),z(),w(),Ladda.bind("#edit_team_profile_confirm_edit_btn"),q(),ce(),me()},"_switchToEdit"),re=o(function(I){var l=$(I.target),g=l.data("id");if(g||(l=l.closest("[data-id]")),g=l.data("id"),!!g){var b=TS.team.getTeamProfileFieldById(g);if(b){I.stopPropagation(),t.push({back:re,event:I});var M=TS.templates.admin_edit_team_profile_hide({id:b.id,can_delete:!_.get(b,"options.is_scim",!1)}),Z=TS.interop.i18n.t('Hide "{field_label}"',"team_profile")({field_label:b.label});s.find("#edit_team_profile_header").text(Z).addClass("center_and_narrow");var V=TS.interop.i18n.t("All data entered for this field will no longer be visible on your members\u2019 profiles. You can un-hide it later.","team_profile")();s.find("#edit_team_profile_value_note").text(V).addClass("center_and_narrow").removeClass("hidden"),s.find("#edit_team_profile_hide").html(M),K("#edit_team_profile_hide"),Ladda.bind("#edit_team_profile_confirm_hide_btn"),te(),ce()}}},"_switchToHide"),J=o(function(I){var l=$(I.target),g=l.data("id");if(g||(l=l.closest("[data-id]")),g=l.data("id"),!!g){var b=TS.team.getTeamProfileFieldById(g);if(b){I.stopPropagation(),t.push({back:J,event:I});var M=TS.templates.admin_edit_team_profile_delete(b),Z=TS.interop.i18n.t('Delete "{field_label}"',"team_profile")({field_label:b.label});s.find("#edit_team_profile_header").text(Z).addClass("center_and_narrow");var V=TS.interop.i18n.t("<strong>Are you sure?</strong> All data associated with this field will be permanently deleted. This <strong>cannot be undone</strong>.","team_profile")();s.find("#edit_team_profile_value_note").html(V).addClass("center_and_narrow").removeClass("hidden"),s.find("#edit_team_profile_delete").html(M),K("#edit_team_profile_delete"),Ladda.bind("#edit_team_profile_confirm_delete_btn"),te(),ce()}}},"_switchToDelete"),te=o(function(){s.closest(".contents").addClass("display_flex flex_direction_column").css("height","70vh"),s.css({margin:"auto 0",height:"auto","padding-top":0})},"_flexContentsAndCenter"),q=o(function(){s.closest(".contents").removeClass("display_flex flex_direction_column").css("height",""),s.css({margin:"",height:"","padding-top":""})},"_unflexContentsAndCenter"),ne=o(function(){if(!TS.model.team)return!1;var I=TS.model.user;return I?TS.prefs.getTeamPref("who_can_change_team_profile")==="admin"?I.is_admin:TS.prefs.getTeamPref("who_can_change_team_profile")==="owner"?I.is_owner:!0:!1},"_userCanEditTeamProfile"),ce=o(function(I){I?(TS.ui.fs_modal.unbindBackButton(),TS.ui.fs_modal.hideBackButton()):(TS.ui.fs_modal.bindBackButton(function(){t.pop();var l=t.pop();l.back(l.event)}),TS.ui.fs_modal.showBackButton())},"_updateBackButton"),L=o(function(){var I=s.find(".option_row");I.length>=3?I.addClass("show_remove_action"):I.removeClass("show_remove_action")},"_maybeShowOptionRemoveAction"),z=o(function(){y({target:s.find('.option_header_row + .option_row [data-action="edit_team_profile_update_preview_option"]')})},"_maybeUpdateOptionPreviewValue"),j=o(function(I){$(I.target).closest(".row.option_row").remove(),me(),L(),z(),N()},"_removeOption"),X=o(function(){var I=TS.templates.admin_edit_team_profile_option_row({index:s.find(".row.option_row").length});s.find("#option_rows").append(I).find(".row.option_row").last().find("input").focus(),me(),L(),N()},"_addOption"),N=o(function(){s.find(".row.option_row").length===50?s.find('[data-action="edit_team_profile_add_option"]').addClass("hidden").next().removeClass("hidden"):s.find('[data-action="edit_team_profile_add_option"]').removeClass("hidden").next().addClass("hidden")},"_maybeUpdateAddOptionAction"),y=o(function(I){var l=$(I.target),g=l.val();g&&(g=g.trim()),g!==void 0&&!g.length&&(g=l.data("default")),s.find(`.profile_field_preview [data-id="${l.data("target")}"]`).text(g)},"_updatePreviewValue"),U=o(function(I){var l=s.find(`.profile_field_preview [data-id="${$(I.target).data("target")}"]`),g=l.closest("select");g.length&&(l=g),l.addClass("highlight_yellow_bg")},"_decoratePreview"),h=o(function(I){var l=s.find(`.profile_field_preview [data-id="${$(I.target).data("target")}"]`),g=l.closest("select");g.length&&(l=g),l.removeClass("highlight_yellow_bg")},"_undecoratePreview"),w=o(function(){var I=s.find(".edit_team_profile_lazy_filter_select");if(I.length){var l="USLACKBOT",g={append:!0,classes:"disabled",preselected_ids:[l]};TS.ui.people_picker.make(I,g)}},"_makePeoplePicker"),R=o(function(){s.find("#edit_team_profile_list_drag_and_drop_area").sortable({items:".visible_row[data-id]",handle:".ts_icon_grabby_patty",forcePlaceholderSize:!0}).on("sortupdate",function(I){I.stopPropagation();var l=[];$(this).find(".row[data-id]").each(function(b){var M=TS.team.getTeamProfileFieldById($(this).data("id"));M&&M.ordering!=b&&(M.ordering=b,l.push({id:M.id,ordering:b}))});var g=TS.team.sortTeamProfileFieldsByOrdering(TS.model.team.profile.fields);TS.redux.teams.upsertTeam(_.assign({},TS.model.team,{profile:{fields:g}})),O("team.profile.reorder",l)})},"_enableDragAndDrop"),E=o(function(){return TS.model.team.profile.fields.length?_.max(TS.model.team.profile.fields.map(function(I){return I.ordering}))+1:0},"_makeOrdering"),B=o(function(I){I.stopPropagation();var l=$(I.target).closest("[data-id]").get(0),g={};g.is_scim=$(I.target).closest("[data-is-scim]").data("is-scim");var b=jQuery.Event("click",{target:l,currentTarget:l});TS.menu.startWithEditTeamProfileListActions(b,G,g)},"_openListMenu"),G=o(function(I){I.preventDefault();var l=$(I.target).closest("[data-id]");l.is('[data-action="edit_team_profile_to_show"]')?P(I):l.is('[data-action="edit_team_profile_to_hide"]')?re(I):l.is('[data-action="edit_team_profile_to_delete"]')&&J(I),TS.menu.end()},"_onListMenuClick"),K=o(function(I){var l=["#edit_team_profile_loading","#edit_team_profile_list","#edit_team_profile_add","#edit_team_profile_custom","#edit_team_profile_edit","#edit_team_profile_hide","#edit_team_profile_delete"].filter(function(g){return g!==I}).join(", ");s.find(l).addClass("hidden"),s.find(I).removeClass("hidden"),i=I},"_hideAllSectionsBut"),ae=o(function(){var I=TS.team.getVisibleTeamProfileFields();return I.length?I:null},"_getVisibleTeamProfileFields"),ue=o(function(){var I=TS.team.getHiddenTeamProfileFields();return I.length?I:null},"_getHiddenTeamProfileFields"),oe=o(function(){return TS.model.team.profile.fields.reduce(function(I,l){return I[l.label.toLowerCase()]=!0,I},{})},"_getLabelsMap"),le=o(function(){var I=oe(),l=[{type:"text",label:TS.interop.i18n.t("Address","team_profile")()},{type:"date",label:TS.interop.i18n.t("Birthdate","team_profile")()},{type:"user",label:TS.interop.i18n.t("Direct Reports","team_profile")()},{type:"link",label:TS.interop.i18n.t("Facebook","team_profile")()},{type:"link",label:TS.interop.i18n.t("Flickr","team_profile")()},{type:"link",label:TS.interop.i18n.t("GitHub","team_profile")()},{type:"link",label:TS.interop.i18n.t("Instagram","team_profile")()},{type:"link",label:TS.interop.i18n.t("LinkedIn","team_profile")()},{type:"user",label:TS.interop.i18n.t("Manager","team_profile")()},{type:"link",label:TS.interop.i18n.t("Pinterest","team_profile")()},{type:"text",label:TS.interop.i18n.t("Skype","team_profile")()},{type:"link",label:TS.interop.i18n.t("SoundCloud","team_profile")()},{type:"date",label:TS.interop.i18n.t("Start Date","team_profile")()},{type:"link",label:TS.interop.i18n.t("Tumblr","team_profile")()},{type:"link",label:TS.interop.i18n.t("Twitter","team_profile")()},{type:"link",label:TS.interop.i18n.t("YouTube","team_profile")()}].filter(function(g){return!I[g.label.toLowerCase()]});return l.length?l:[]},"_getDefaultTeamProfileFields"),ie=o(function(I){var l=I?`[data-id=${I}]`:".visible_row[data-id]",g=s.find("#edit_team_profile_list").find(l).last(),b=g.outerHeight()*-2;g.highlight(1500,"",null,0),g.scrollintoview({duration:200,px_offset:b,direction:"y"})},"_highlightInList"),me=o(function(){$("#edit_team_profile_confirm_edit_btn").toggleClass("disabled",!TS.ui.validation.validate(s.find("#edit_team_profile_edit"),{quiet:!0,fast:!0}))},"_toggleSave")})()},4556606753:()=>{(function(){TS.registerModule("ui.admin_user_groups",{user_groups_fetched:new signals.Signal,onStart:function(){$("body").on("click",'[data-action="admin_user_groups_modal"]',function(){m()}),$("body").on("click",'[data-action="admin_user_groups_modal_new"]',function(){TS.ui.admin_user_groups.add()})},start:function(){m()},add:function(){m(),n=!0,F()},editInfo:function(h){m(),n=!0,F(h)},editMembers:function(h){m(),n=!0,te(h,!1)},disable:function(h){m(),n=!0,Y(h,"disable_user_group")},enable:function(h){m(),n=!0,Y(h,"enable_user_group")},interopFunctions:function(h){let{action:w,userGroup:R,defaultChannels:E}=h;switch(w){case"add":F();break;case"enable":Y(R,"enable_user_group");break;case"disable":Y(R,"disable_user_group");break;case"editInfo":F(R,E);break;case"editMembers":te(R,!1);break;default:}},test:function(){var h={_isFullLocalMember:j};return Object.defineProperty(h,"_isFullLocalMember",{get:function(){return j},set:function(w){j=w}}),h}});var s,r,i,t=[],n=!1,a=!1,d=!1,m=o(function(){var h=TS.templates.user_group_modal({show_info_pane:!TS.prefs.getPref("hide_user_group_info_pane"),show_user_groups_add:TS.interop.userGroups.canCreateAndDeleteUserGroups()}),w={body_template_html:h,onShow:u,onCancel:f};w.full_height_contents=!0,w.modal_contents_container_class="overflow_hidden",y="",TS.interop.userGroups.setSearchQuery(y),TS.ui.fs_modal.start(w)},"_start"),u=o(function(){s=$("#all_user_groups"),r=$("#user_groups_form_div"),i=$("#user_groups_toggle_div"),O(),$("#user_groups_create_btn").on("click",()=>{F()})},"_onShow"),f=o(function(){s=null,r=null,i=null,n=!1,U=null,$(window).off("resize",D),TS.ui.admin_user_groups.user_groups_fetched.dispatch(t),X(TS.model.user_groups),N()},"_onCancel"),p=o(function(h){h&&h.preventDefault(),n?TS.ui.fs_modal.close():O(),X(TS.model.user_groups)},"_onReset"),S=o(function(){n?TS.ui.fs_modal.close():O(),TS.ui.admin_user_groups.user_groups_fetched.dispatch(t),X(TS.model.user_groups)},"_onUpdateComplete"),v=o(function(){n||(TS.ui.fs_modal.bindBackButton(O),TS.ui.fs_modal.showBackButton())},"_bindBackButton"),P=o(function(h){if(!t||!h)return!1;for(var w=0,R=t.length;w<R;w+=1)if(t[w].auto_type===h)return t[w];return!1},"_findAutoUserGroup"),C=o(function(h){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!h){var R=$("#user_group_name_input").val()||"",E=$("#user_group_handle_input").val()||"";if(w.group_name=R,w.group_handle=E,w.error&&(w.error==="forbidden_handle"||w.error==="forbidden_name")){var B=R+E;if(B){var G=P("owner"),K=P("admin"),ae=!!B.match(/admins/i),ue=!!B.match(/owners/i);w.suggest_auto_group=!0,w.can_create_auto_owners=ue&&TS.model.user.is_admin&&!G,w.can_enable_auto_owners=ue&&G&&G.date_delete,w.can_create_auto_admins=ae&&TS.model.user.is_admin&&!K,w.can_enable_auto_admins=ae&&K&&K.date_delete}}return $("#user_group_alerts").html(TS.templates.user_group_alerts(w)),!0}return!1},"_alertIfNotOk"),D=o(function(){var h=$("#user_groups_header");if(h.length){var w=$("#user_groups_list_scroller");if(w.length){var R=h[0].offsetHeight,E=$(window).height(),B=250,G=E*.15,K=Math.max(B,E-R-G);w.css("height",K)}}},"_onResizeList"),O=o(function(){var h=$("#user_groups_list_div");h&&!a&&(TS.interop.mountUserGroupsList(TS.boot_data.team_id,h[0],{isLegacy:!0,isUserGroupBrowser:!0,includeDeactivated:!0,onClearSearch:()=>z()}),h.addClass("ug_modern_list"),a=!0),s.removeClass("hidden"),r.addClass("hidden"),i.addClass("hidden"),Q(),TS.ui.fs_modal.hideBackButton()},"_switchListView"),Q=o(function(){$(window).on("resize",D),D(),$("#user_group_modal_search").on("keydown keyup change",L),U=$("#user_groups_header .user_groups_search .icon_close"),U.off("click").on("click",z),s.off("click");var h=o(function(R,E){if(R){n=!1;let B=null;E.subteam&&E.subteam.id&&(B=E.subteam.id),E.usergroup&&E.usergroup.id&&(B=E.usergroup.id),O(B)}},"autoMethodHandler"),w={owners:{create:function(){TS.interop.api.call("subteams.createAuto",{type:"owner"}).then(function(R){let{data:E,args:B,request_id:G}=R;var K=!0;return h&&h(K,E,B,G),{data:E,args:B,request_id:G}}).catch(function(R){let{data:E,args:B,request_id:G}=R;var K=!1;return h&&h(K,E,B,G),{data:E,args:B,request_id:G}})},enable:function(){var R=P("owner");R&&TS.redux.dispatch(TS.interop.userGroups.enableUserGroup({usergroup:R.id})).then(E=>{h(!0,E)})}},admins:{create:function(){TS.interop.api.call("subteams.createAuto",{type:"admin"}).then(function(R){let{data:E,args:B,request_id:G}=R;var K=!0;return h&&h(K,E,B,G),{data:E,args:B,request_id:G}}).catch(function(R){let{data:E,args:B,request_id:G}=R;var K=!1;return h&&h(K,E,B,G),{data:E,args:B,request_id:G}})},enable:function(){var R=P("admin");R&&TS.redux.dispatch(TS.interop.userGroups.enableUserGroup({usergroup:R.id})).then(E=>{h(!0,E)})}}};r.off("click").on("click","a.user_group_auto_action",function(R){var E=$(R.target),B=E.data("auto-type"),G=E.data("auto-action");if(w[B]&&w[B][G])return w[B][G](),R.preventDefault(),!1})},"_bindListUI"),Y=o(function(h,w){if(!h){TS.warn("Cannot switch toggle view to undefined User Group");return}N(),i.html(TS.templates.user_group_toggle({action:w,user_group:h})),i.find('[data-action="cancel"]').on("click",p),i.find(".user_group_toggle_btn").on("click",function(){var R=$(this).data("action");_.includes(["enableUserGroup","disableUserGroup"],R)&&TS.redux.dispatch(TS.interop.userGroups[R]({usergroup:h.id})).then(()=>{R==="enableUserGroup"&&H(h),S()}).catch(function(E){const{data:B}=E;return C(!1,B)})}),s.addClass("hidden"),i.removeClass("hidden"),v()},"_switchToggleView"),H=o(function(h){TS.interop.userGroups.upsertUserGroup(h),TS.interop.userGroups.searchLocalUserGroups()},"_upsertUserGroup"),F=o(function(h,w){N(),r.html(TS.templates.user_group_settings_form(h)),d=!1,$("#user_group_default_channels").lazyFilterSelect(re(h,w)),J(h),s.addClass("hidden"),r.removeClass("hidden"),v()},"_switchSettingsFormView"),ee=o(function(h,w){if(!h||!w)return!1;const R=h&&h.id,E=w.prefs.channels.concat(w.prefs.groups);return _.includes(E,R)},"isPreselected"),c=o(function(h,w){const R=_.get(w,"prefs.channels",[]);return(R.length?TS.shared.ensureModelObsArePresent(R):Promise.resolve()).then(function(){return TS.interop.searcher.search({query:h,options:{entities:{channels:{includePublic:!0,includePrivate:!0,includeFromAnotherTeam:!1,includeMpims:!1,includeArchived:!1,searchPreviousNames:!1,onlyVisibleMpims:!1,includeRequired:!0}},limit:100,tiered:!0,allowEmptyQuery:!0,sort:{frecency:!0}}})}).then(function(B){return B})},"getLFSChannels"),x=o(function(h,w){return function(R){return c(R,h).then(function(E){const B=_.map(E,G=>{const K=G.id,ae=d?!1:ee(G,h);return{model_ob:G,lfs_id:K,preselected:ae}});return!d&&w&&w.length>0&&_.differenceWith(w,B,(K,ae)=>K.id===ae.lfs_id).forEach(K=>{K&&K.id&&B.push({lfs_id:K.id,model_ob:K,preselected:!0})}),d=!0,{replace_all_items:!0,all_items_fetched:!0,items:B}})}},"_getLFSChannelsProvider"),re=o(function(h,w){return{data_promise:x(h,w),template:function(R){const E=R.model_ob;let B="";return B+=TS.interop.rules.channels.isPublicChannel(E)?"#":'<ts-icon class="ts_icon_lock ts_icon_inherit"></ts-icon>',B+=_.escape(E.name||TS.interop.i18n.t("private channel","channel_token")()),TS.interop.rules.channels.isOrgShared(E)?B+=' <ts-icon class="ts_icon_shared_channel ts_icon_inherit"></ts-icon>':TS.interop.utility.isModelObjectExternal(E)&&(B+=TS.templates.shared_channels_icon({model_ob:E,tooltip:!0,connectedTeamIds:TS.interop.rules.channels.getConnectedTeamIds(TS.redux.getState(),E),inherit:!0})),new Handlebars.SafeString(B)},placeholder_text:""}},"_getLFSChannelsOptions"),J=o(function(h){var w,R,E;h?(w=TS.interop.userGroups.updateUserGroup,R=!1,E=h.id):(w=TS.interop.userGroups.createUserGroup,R=!0);var B=$("#user_group_handle_input");B.on("input",function(){$(this).closest(".handle_input").toggleClass("empty",!this.value.length)}),r.find(".user_group_settings_form").on("submit",function(ue){ue.preventDefault();var oe=$('input[name="name"]').val(),le=$('input[name="handle"]').val(),ie=$('input[name="description"]').val(),me=$("#user_group_default_channels").lazyFilterSelect("value");me=_.map(me,"model_ob.id");var I={name:oe,handle:le,description:ie,channels:me};E&&(I.usergroup=E),TS.redux.dispatch(w(I)).then(function(l){const g=l.usergroup;H(g),R?te(g,R):S(),TS.user_groups.updated_info_sig.dispatch(g.id)}).catch(function(l){const{data:g}=l;return C(!1,g)})}),r.find(".user_group_settings_form").on("reset",p);var G=$("#save_user_group"),K=$("#user_group_name_input");function ae(){var ue=K.val(),oe=B.val();!_.isEmpty(ue)&&!_.isEmpty(oe)?G.removeAttr("disabled"):G.attr("disabled",!0)}o(ae,"inputChange"),G.length&&K.length&&B.length&&(K.on("change",ae),K.on("keyup",ae),B.on("change",ae),B.on("keyup",ae),ae())},"_bindSettingsFormUI"),te=o(function(h,w){var R=!!h.is_external||!!h.auto_type,E=o(function(){r.html(TS.templates.user_group_members_form({is_new:w,is_locked:R,user_group:h}))},"renderForm"),B=o(function(){var K=$("#member_count"),ae=h.user_count||0,ue=o(function(){var le=$(w?"#create_group":"#save_group");le.length&&(ae<1?le.prop("disabled",!0):le.prop("disabled",!1))},"updateForm"),oe={approx_item_height:36,template:function(le){var ie=TS.templates.user_group_invite_member_small(le);return new Handlebars.SafeString(ie)},onItemAdded:function(){ae+=1,K.html(ae),ue()},onItemRemoved:function(){ae-=1,K.html(ae),ue()},filter:function(le,ie){var me=le.member;ie.charAt(0)==="@"&&(ie=ie.substr(1));var I=new RegExp(`^${TS.utility.regexpEscape(ie)}`,"i"),l=new RegExp(`(-|_|\\+|\\s|\\.|@)${TS.utility.regexpEscape(ie)}`,"i");return TS.utility.members.checkMemberMatch(me,I)||TS.utility.members.checkMemberMatch(me,l)},disabled:!!h.is_external||!!h.auto_type,data_promise:q(h)};$("#user_group_members_select").lazyFilterSelect(oe),ce(h),s.addClass("hidden"),r.removeClass("hidden"),N(),ue()},"renderUI");if(w)E(),TS.ui.fs_modal.hideBackButton(),B();else{var G=o(function(){E(),v(),B()},"work");if(TS.user_groups.legacyNeedsToFetchMembership(h))TS.interop.userGroups.getUserGroupMembers(h.id,function(K){if(K&&K.users){h=K;const ae=_.get(h,"users",[]);return TS.interop.members.ensureMembersArePresent(ae).then(G)}});else{const K=_.get(h,"users",[]);return TS.interop.members.ensureMembersArePresent(K).then(G)}}},"_switchMembersFormView"),q=o(function(h){var w=!0;return function(R,E){R.charAt(0)==="@"&&(R=R.substring(1));var B=!1;if(w&&(w=!1,_.get(h,"users.length")&&(B=!0)),B){var G=h.users.map(oe=>TS.interop.members.getMemberById(oe));G.sort(TS.members.memberSorterByName);var K=G.map(function(oe){return oe?{member:oe,lfs_id:String(oe.id),preselected:!0}:{}});return Promise.resolve(K)}if(E>0)return Promise.resolve([]);var ae={query:R,include_org:!1,include_slackbot:!1,include_self:!0,full_profile_filter:!1,include_bots:!0,include_profile_only_users:!0},ue=ne(ae);return ue}},"_buildMembersSelectDataPromise"),ne=o(function(h){return Promise.resolve().then(function(){return TS.members.promiseToSearchMembers(h).then(function(w){var R=[];return w.query===""?R=TS.utility.teams.getMembersForTeam(TS.model.team):R=w.items,w.items=R.filter(j).map(function(E){return{member:E,lfs_id:String(E.id)}}),w})})},"_getSearchPromise"),ce=o(function(h){r.find(".user_group_members_form").on("submit",function(w){w.preventDefault();var R=$("#user_group_members_select").lazyFilterSelect("value");R=R.map(function(E){return E.member.id}),TS.redux.dispatch(TS.interop.userGroups.updateMembersOfUserGroup({usergroup:h.id,users:R})).then(E=>{S(),TS.user_groups.updated_info_sig.dispatch(E.usergroup.id)}).catch(E=>{const{data:B}=E;C(!1,B)})}),r.find(".user_group_members_form").on("reset",function(w){w.preventDefault(),p(w)})},"_bindMembersFormUI"),L=o(function(h){var w=$(h.target),R=w.val();R!==y&&(y=R,U.toggleClass("hidden",R===""),TS.interop.userGroups.setSearchQuery(y))},"_updateSearch"),z=o(function(){var h=$("#user_group_modal_search");y="",h.val(""),setTimeout(function(){h.focus()},0),U.addClass("hidden"),TS.interop.userGroups.setSearchQuery(y)},"_clearSearch"),j=o(function(h){return h?!!((TS.interop.rules.members.isMemberOnTeam(h,TS.model.team.id)||h.is_profile_only_user)&&!h.deleted&&!h.is_ultra_restricted&&!h.is_restricted&&!(h.is_bot||TS.interop.rules.members.isSlackbot(h))):!1},"_isFullLocalMember"),X=o(function(h){var w=$("#user_groups_tab .count");w.html(h.length)},"_updateTabUserGroupsCount"),N=o(function(){a=!1;var h=$("#user_groups_list_div");TS.interop.unmountUserGroupsList(h[0])},"_cleanupListView"),y,U})()},980335758:()=>{(function(){TS.registerModule("ui.edit_member_profile",{onStart:function(){TS.members.changed_profile_sig.add(r)}});var s,r=o(function(){s&&$("#edit_member_profile_photo_container .member_image").replaceWith(TS.templates.builders.makeMemberPreviewLinkImage(TS.model.user.id,192,!1,!0))},"_maybeUpdateMemberPhoto")})()},2021630798:()=>{(function(){TS.registerModule("ui.fs_modal",{is_showing:!1,transition_duration:250,start:function(q){if(TS.ui.fs_modal.is_showing)return c(q);v=_.defaults({},q,P),TS.ui.fs_modal.is_showing=!0,TS.tips.hideAll(),C(),v.modal_class&&s.addClass(v.modal_class),v.modal_bg_class&&r.addClass(v.modal_bg_class),v.modal_contents_container_class&&s.find(".contents_container").addClass(v.modal_contents_container_class),t=s.find(".contents"),n=s.find("#fs_modal_sidebar"),a=s.find("#fs_modal_header"),m=s.find("#fs_modal_footer_content");var ne;if(v.body_template_html?(ne=v.body_template_html,v.body&&TS.warn("Both body and body_template_html were passed in settings to TS.ui.fs_modal.start(). Using body_template.")):ne=TS.templates.fs_modal_generic_contents({settings:v,fs_modal_header:_.includes(v.modal_class,"fs_modal_header"),fs_modal_footer:_.includes(v.modal_class,"fs_modal_footer")}),t.html(ne),v.header_html&&a.replaceWith(v.header_html),v.footer_html&&m.html(v.footer_html),v.sidebar_html&&n.html(v.sidebar_html),q.title&&s.attr("aria-label",q.title),!q.title&&a&&s.attr("aria-labelledby","fs_modal_header"),$("#client-ui").attr("aria-hidden",!0),s.on("click",".dialog_go",D),s.on("click",".dialog_secondary_go",O),s.on("click",".dialog_cancel",H),$(window.document).off(".fs_modal"),$(window.document).on("keydown.fs_modal",Q),$(window.document).on("focusin.fs_modal",Y),i.on("click",function(){v.esc_for_ok?D():H()}),$("html").addClass("fs_modal_active"),setTimeout(function(){r&&r.addClass("active"),s&&s.addClass("active")},0),s.find("input").length?s.find("input").first().focus():document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),v.onShow&&v.onShow(),v.onShowComplete||TS.model.is_our_app&&TS.interop.desktop.legacyAreDragRegionsRequired()){var ce=!1,L=x();p=setTimeout(function(){ce=!0,re(),v.onShowComplete&&v.onShowComplete(),s.off(`${L}.fs_modal_show_complete`)},600),s.one(`${L}.fs_modal_show_complete`,function(){ce||(re(),clearTimeout(p),v.onShowComplete&&v.onShowComplete())})}},close:function(q){H(q)},bindBackButton:function(q){$("#fs_modal_back_btn").off("click.fs_modal").on("click.fs_modal",q)},unbindBackButton:function(){$("#fs_modal_back_btn").off("click.fs_modal")},showBackButton:function(){$("#fs_modal_back_btn").removeClass("hidden")},hideBackButton:function(){$("#fs_modal_back_btn").addClass("hidden")},activate:function(){s.addClass("active"),r.addClass("active")},deactivate:function(){s.removeClass("active"),r.removeClass("active")},hideFooter:function(){d.length&&(s.removeClass("fs_modal_footer"),d.addClass("hidden"))},isShowing:function(){return TS.ui.fs_modal.is_showing}});var s,r,i,t,n,a,d,m,u=!1,f,p,S=".modal,[role=dialog]:not(.modal),[role=alertdialog]:not(.modal)",v=null,P={title:"",body:"",body_template_html:null,show_go_button:!0,show_secondary_go_button:!1,show_cancel_button:!0,go_button_text:TS.interop.i18n.t("OK","fs_modal")(),go_button_class:"",secondary_go_button_text:TS.interop.i18n.t("OK 2","fs_modal")(),secondary_go_button_class:"",cancel_button_text:TS.interop.i18n.t("Cancel","fs_modal")(),disable_default_controls:!1,disable_esc:!1,onGo:null,onSecondaryGo:null,onCancel:null,onEnd:null,esc_for_ok:!1,onShow:null,enter_always_gos:!1,fullscreen:!1,modal_class:null,modal_bg_class:null,modal_contents_container_class:null,sidebar_html:null,header_html:null,footer_html:null,full_height_contents:!1},C=o(function(){r=null,s=null,a=null,d=null,m=null,i=null,t=null,n=null;var q={settings:v,fs_modal_header:_.includes(v.modal_class,"fs_modal_header"),fs_modal_footer:_.includes(v.modal_class,"fs_modal_footer"),fs_modal_sidebar:_.includes(v.modal_class,"fs_modal_sidebar"),disable_default_controls:v.disable_default_controls},ne=TS.templates.fs_modal(q);$("body").append(ne),r=$("#fs_modal_bg"),s=$("#fs_modal"),a=$("#fs_modal_header"),d=$("#fs_modal_footer"),i=$("#fs_modal_close_btn")},"_build"),D=o(function(){if(!TS.ui.fs_modal.is_showing){TS.error("not showing?");return}v.onGo?v.onGo()!==!1&&H():H()},"_go"),O=o(function(){if(!TS.ui.fs_modal.is_showing){TS.error("not showing?");return}v.onSecondaryGo?v.onSecondaryGo()!==!1&&H():H()},"_secondaryGo"),Q=o(function(q){if(q.which==TS.utility.keymap.enter&&(TS.utility.getActiveElementProp("NODENAME")==="BODY"||v.enter_always_gos))v.show_go_button&&(D(),q.preventDefault());else if(q.which==TS.utility.keymap.esc){if(v.disable_esc)return;v.esc_for_ok?D():(H(),v.clog_name&&TS.interop.clog.track(`${v.clog_name}_ACTION`,{source:v.clog_source,action:"close_modal",trigger:"esc_key"}))}},"_onKeyDown"),Y=o(function(q){var ne=$(S).filter(function(){return $(this).css("display")!=="none"}).toArray(),ce=_.sortBy(ne,function(z){return parseInt($(z).css("z-index"),10)}).pop();if(s.is(ce)){var L=q.target;!s.is(L)&&!s.has(L).length&&s.focus()}},"_onFocus"),H=o(function(q){te(q)&&(s&&s.removeClass("active"),r&&r.removeClass("active"),setTimeout(function(){$("html").removeClass("fs_modal_active")},TS.ui.fs_modal.transition_duration),v.onCancel&&v.onCancel(),ee())},"_cancel"),F=o(function(){s.removeAttr("aria-label"),s.removeAttr("aria-labelledby"),s.remove(),r.remove(),TS.ui.fs_modal.is_showing=!1,J()},"_clean"),ee=o(function(){setTimeout(function(){F(),$("#client-ui").removeAttr("aria-hidden")},TS.ui.fs_modal.transition_duration),$(window.document).off("keydown.fs_modal"),$(window.document).off("focusin.fs_modal"),clearTimeout(p),s.off(`${x()}.fs_modal_show_complete`),v.onEnd&&v.onEnd(),TS.tips.unhideAll()},"_end"),c=o(function(q){s.removeClass("active"),v.onCancel&&v.onCancel();var ne=r.attr("id",null).addClass("fs_modal_bg");return new Promise(ce=>{setTimeout(function(){s.remove(),TS.ui.fs_modal.is_showing=!1,ce(TS.ui.fs_modal.start(q)),setTimeout(ne.remove.bind(ne),TS.ui.fs_modal.transition_duration)},TS.ui.fs_modal.transition_duration)})},"_swap"),x=o(function(){var q={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",transition:"transitionend"};for(var ne in q)if(s[0].style[ne]!==void 0)return q[ne]},"_getTransitionEndEventName"),re=o(function(){if(!(!TS.model.is_our_app||!TS.interop.desktop.legacyAreDragRegionsRequired())){if(_.get(window,"desktop.app.updateDragRegion")){window.desktop.app.updateDragRegion([]);return}TS.interop.desktop.legacyUpdateNoDragRegion([]);var q=$("#fs_modal").find("header").find("button, a").toArray();u||(TSSSB.nodrag.updateElements(q),u=!0),f=_.debounce(()=>{TS.interop.utility.requestIdleCallback(()=>TSSSB.nodrag.updateElements(q),{timeout:200})},400),$(window).off("resize.setupNoDragFSM").on("resize.setupNoDragFSM",f)}},"_setupNoDragRegions"),J=o(function(){!TS.model.is_our_app||!TS.interop.desktop.legacyAreDragRegionsRequired()||(u=!1,$(window).off("resize.setupNoDragFSM"),TS.interop.desktop.legacyUpdateNoDragRegion([]))},"_tearDownNoDragRegions"),te=o(function(q){return q?!0:!(TS.ui.lazy_filter_select.is_list_open||TS.model.menu_is_showing||TS.model.dialog_is_showing||TS.utility.isTabCompleteShowing())},"_canClose")})()},5908611399:()=>{(function(){TS.registerModule("ui.lazy_filter_select",{STYLES:{default:"default",filter_in_list:"filter_in_list",normal:"normal",small:"small"},onStart:function(){$("select[data-lazy-filter-select], label[data-lazy-filter-select] select").addClass("hidden").lazyFilterSelect({use_data_attributes:!0})},create:function(e,T){if(T.use_data_attributes){var A=Object.keys(e.data());A.forEach(function(de){if(de.indexOf("lazyFilterSelect")>-1&&de!=="TS-lazyFilterSelect"&&e.data(de)!==""){var pe=e.data(de);(pe==="true"||pe==="false")&&(pe=pe==="true"),T[de.replace("lazyFilterSelect","").toLowerCase()]=pe}})}e.prop("tagName")==="SELECT"&&typeof T.single>"u"&&(T.single=!e.prop("multiple"));var k=$.extend({},s,T);T.approx_divider_height===void 0&&(k.approx_divider_height*=1),T.approx_item_height===void 0&&(k.approx_item_height*=1);var W=$('<div class="lazy_filter_select">');k.classes&&W.addClass(k.classes),e.prop("disabled")&&(k.disabled=!0),k.disabled&&W.addClass("disabled"),k.style=_.get(TS.ui.lazy_filter_select.STYLES,k.style,TS.ui.lazy_filter_select.STYLES.default),b(k)&&!k.single&&(TS.warn("Multi-select lazyFilterSelect instances can't use the 'filter_in_list' style. Using 'default' style instead."),k.style=TS.ui.lazy_filter_select.default);var se=TS.templates.lazy_filter_select_container({instance:k,aria_labelledby:e.attr("aria-labelledby"),STYLES:TS.ui.lazy_filter_select.STYLES});return W.html(se),k.append?W.appendTo(e):W.insertAfter(e),W.addClass(`${k.style}_style`),k.single&&(W.addClass("single"),W.attr("tabindex",0)),k.width&&W.css("width",k.width),k.css&&W.css(k.css),k.$container=W,k.$select=e,k.$input_container=W.find(".lfs_input_container"),k.$lfs_value=W.find(".lfs_value"),k.$input=W.find(".lfs_input"),k.$list_container=W.find(".lfs_list_container"),k.$list=W.find(".lfs_list"),k.$status=W.find(".lfs_status"),k.$status_loading_indicator=k.$status.find(".lfs_status_loading_indicator"),k.$status_content=k.$status.find(".lfs_status_content"),b(k)?k.$filter_input=W.find(".lfs_filter_input"):k.$filter_input=k.$input,k._page_number=1,k._slug_id_counter=1,k.run=z,k.data_promise?(N(k)&&k._running_promise.cancel("Uhhh..."),k._running_promise=X(k,"").then(function(de){k.data=de,k.run(),n(k)},function(de){n(k),TS.interop.utility.getLogger({getState:TS.redux.getState}).error(de,"LFS error"),Z(k,de,"Something failed while trying to return the initial data for lazyFilterSelect.")})):(k.data&&(k.data=k.data.slice()),_.forEach(k.data,function(de,pe,ge){de&&de._is_interop_channel_object&&(ge[pe]=_.assign({},de))}),k.run(),n(k)),k.current_items_in_view_signal=new signals.Signal,k},is_list_open:!1});var s={allow_item_unselect:!1,allow_list_position_above:!1,always_visible:!1,append:!1,approx_divider_height:28,approx_item_height:30,data_promise:null,data_qa:"lfs",disabled:!1,filter:function(e,T){var A=e.toString();if(T=T.toLowerCase(),e instanceof jQuery||e instanceof HTMLElement){A=$(e).text();var k=$(e).attr("data-additional-search-field");if(k&&k.toLowerCase().indexOf(T)>-1)return!0}return A.toLowerCase().indexOf(T)>-1},input_debounce_wait_time:void 0,listItemClass:null,max_selected_items:1/0,min_query_length:0,monkey_scroll:!0,no_default_selection:!1,noResultsTemplate:function(e){return M(this)&&e.length<this.min_query_length?TS.interop.i18n.t("{query_length, plural, =0 {Start typing to see results\u2026} other {Keep typing to see results\u2026}}","lazy_filter_select")({query_length:e.length}):TS.interop.i18n.t("No items matched {query}","lazy_filter_select")({query:TS.interop.i18n.safeString(`<strong>${_.escape(e)}</strong>`)})},errorTemplate:function(e){return e||TS.interop.i18n.t("Couldn't load results.","lazy_filter_select")()},onInputBlur:_.noop,onInputFocus:_.noop,onReady:function(){},onItemAdded:function(){},onItemRemoved:function(){},onKeyDown:function(){},onMaxItemsSelected:function(){},onListShown:_.noop,onListHidden:_.noop,adjustAvailableSpaceAbove:_.identity,adjustAvailableSpaceBelow:_.identity,placeholder_text:TS.interop.i18n.t("Choose an option\u2026","lazy_filter_select")(),filter_placeholder_text:TS.interop.i18n.t("Search","lazy_filter_select")(),renderDividerFunc:null,render_item_func:null,restrict_input_container_height:!1,restrict_preselected_item_removal:!1,scroll_threshold:1e3,set_height:!0,single:!1,sluggify:{enabled:!1,delimiter:null,key_name:null,validator:null},style:TS.ui.lazy_filter_select.STYLES.default,template:function(e){var T=e.toString(),A,k;return(e instanceof jQuery||e instanceof HTMLElement)&&(T=$(e).text(),A=I($(e).attr("data-additional-search-field"),this),k=I($(e).attr("data-ts-icon"),this)),T=I(T,this),A&&(T+=` <span class="addl_text">${A}</span>`),k&&(T+=` <ts-icon class="addl_icon ${k}"></ts-icon>`),new Handlebars.SafeString(T)},tokenClass:null,tokenTemplate:null,tokenTemplateSingle:null,use_data_attributes:!1,_$active:null,_all_done_fetching:!1,_list_built:!1,_list_visible:!1,_mouse:{},_page_number:1,_prevent_blur:!1,_previous_val:"",_running_promise:null,_scroll_callback_was_called:!1,_selected:[],_showing_status:!1};$.widget("TS.lazyFilterSelect",{_create:function(){this.instance=TS.ui.lazy_filter_select.create(this.element,this.options)},_destroy:function(){this.instance.$container.remove(),delete this.instance},blur:function(){this.instance.$filter_input.blur()},clearValue:function(){if(this.instance.single){if(this.instance._selected.length){var e=this.instance.$input_container.find(".lfs_item");ce(this.instance,e)}}else q(this.instance)},container:function(){return this.instance.$container},disable:function(){S(this.instance)},disabled:function(){return this.instance.disabled},enable:function(){P(this.instance)},focus:function(){this.instance.$filter_input.focus()},getInstance:function(){return this.instance},hideList:function(){Y(this.instance,{force:!0}),he(this.instance)},recomputeHeight:function(){ie(this.instance)},setValue:function(e,T){var A=this.element[0].selectedIndex;this.element.val(e),this.element[0].selectedIndex<0&&(this.element[0].selectedIndex=0);var k=this.element[0].options[this.element[0].selectedIndex];if(this.instance.single){if(this.element[0].selectedIndex==A&&!T)return}else q(this.instance);var W=O(this.instance,$(k));h(this.instance,W)},forceSelectItem:function(e){this.instance.$lfs_value.html(a(this.instance,e,{force_selected:!0})),this.instance.$container.addClass("value")},showList:function(){G(this.instance)},update:function(e){le(this.instance,e)},updatePlaceholder:function(e){this.instance.placeholder_text=e,this.instance.$input.prop("placeholder",e)},updateFilterPlaceholder:function(e){b(this.instance)&&(this.instance.filter_placeholder_text=e,this.instance.$filter_input.prop("placeholder",e))},value:function(){return this.instance._selected}});var r=o(function(e,T){if(H(e)&&T.trim()&&p(e)){var A={};A[e.sluggify.key_name]=T.trim(),A.lfs_id=null,A.lfs_slug_id=e._slug_id_counter,e._slug_id_counter+=1,e._selected.push(A);var k=TS.templates.lazy_filter_select_item({content:e.tokenTemplate(A),applied_classes:"lfs_token",slug_id:A.lfs_slug_id,data_qa:e.data_qa}).replace(/(\r\n|\n|\r)/gm,""),W=$(k);W.insertBefore(e.$input),e.sluggify.validator&&e.sluggify.validator(W),re(e,e.data),G(e),e.$filter_input.val(""),e._previous_val="",i(e),e.onItemAdded(A),p(e)||e.onMaxItemsSelected()}},"_addUserCreatedSlugFromString"),i=o(function(e){e.single||(e.$input.prop("size",e.$filter_input.val().length+1),e.$filter_input.val().length+e._selected.length===0?B(e):(e.$input_container.removeClass("empty"),e.$input_container.removeClass("error"),l(e)))},"_adjustInput"),t=o(function(e){e.data_promise&&e.$list.on("scroll",function(){var T=$(this).scrollTop(),A=e.$list.height(),k=e.$list.find(".list_items").height(),W=k-T-A;W<=e.scroll_threshold&&!e._scroll_callback_was_called&&!e._all_done_fetching?(f(e,e._previous_val,e._page_number+1),e._scroll_callback_was_called=!0):W>e.scroll_threshold&&e._scroll_callback_was_called&&(N(e)&&e._running_promise.cancel("User scrolled back and we do not need to add more data"),e._scroll_callback_was_called=!1)})},"_bindListListeners"),n=o(function(e){e.$container.on("mouseleave",ye.bind(null,e)),e.$container.on("click",Te.bind(null,e)),e.$container.parents("label").on("click",Pe.bind(null,e)),e.$container.on("keydown",Be.bind(null,e)),e.$input_container.on("focus",Ue.bind(null,e)),e.$input.on("focus",Ee.bind(null,e));var T;_.isUndefined(e.input_debounce_wait_time)?T=Ce:T=_.debounce(Ce,e.input_debounce_wait_time),e.$filter_input.on("input",T.bind(null,e)),e.$filter_input.on("keydown",Me.bind(null,e)),e.$filter_input.on("blur",Fe.bind(null,e)),e.$lfs_value.on("click",Le.bind(null,e)),e.$lfs_value.on("mousedown",We.bind(null,e)),e.$input_container.on("click",".lfs_token",Oe.bind(null,e)),e.$input_container.on("mousedown",".lfs_token",je.bind(null,e)),e.$list_container.on("mousedown",Ae.bind(null,e)),e.$list_container.on("mouseup",ze.bind(null,e)),e.$list_container.on("mousemove",".lfs_item",De.bind(null,e)),e.$list_container.on("mouseleave",".lfs_item.active",Ke.bind(null,e)),e.$list_container.on("click",".lfs_item",Re.bind(null,e)),e.onReady()},"_bindUI"),a=o(function(e,T,A){var k=$(T);A=A||{};var W=A.force_selected||F(e,T),se=T.disabled||T.lfs_disabled;e.restrict_preselected_item_removal&&T.preselected&&(se=!0);var de;A.should_tokenize&&_.isFunction(e.tokenTemplate)?de=e.tokenTemplate(T):e.single&&_.isFunction(e.tokenTemplateSingle)?de=e.tokenTemplateSingle(T):de=e.template(T);var pe=I(k.data("lfs-item-desc"),e),ge={active:e._previous_val!==""&&!W&&!se,disabled:se,lfs_token:A.should_tokenize,selected:W,single:e.single,group_item:k.hasClass("group_item")};return _.isFunction(e.tokenClass)&&(ge[e.tokenClass(T)]=!0),TS.templates.lazy_filter_select_item({content:de,icon:k.data("lfs-item-icon"),desc:new Handlebars.SafeString(pe),applied_classes:TS.utility.getAppliedClasses(ge),lfs_id:T.lfs_id,data_qa:e.data_qa}).replace(/(\r\n|\n|\r)/gm,"")},"_buildItem"),d="position_above",m="show_status",u=o(function(e){if(!(!e._list_built&&!e._showing_status)){e.$list_container.removeClass(d);var T=e.$list.css("max-height");e.$list.css({"max-height":0});var A=e.$list[0].scrollHeight,k=parseInt(e.$list_container.css("padding-top"),10)+parseInt(e.$list_container.css("padding-bottom"),10)+parseInt(e.$list_container.css("border-top-width"),10)+parseInt(e.$list_container.css("border-bottom-width"),10)+parseInt(e.$list_container.css("margin-top"),10)+parseInt(e.$list_container.css("margin-bottom"),10);b(e)&&(k+=e.$filter_input.outerHeight()+parseInt(e.$filter_input.css("margin-bottom"),10));var W=parseInt(e.$list_container.css("max-height"),10),se=2*e.approx_item_height+k,de=Math.min(A+k,W),pe=$(window).height(),ge=e.$input_container[0].getBoundingClientRect().bottom+parseInt(e.$input_container.css("margin-bottom"),10),ve=e.adjustAvailableSpaceBelow(pe-ge);if(e.allow_list_position_above){var we=e.$input_container[0].getBoundingClientRect().top+parseInt(e.$input_container.css("margin-top"),10),Se=e.adjustAvailableSpaceAbove(we),$e=Se>=de,be=ve>=de&&ve>se;$e&&!be&&(ve=Se,e.$list_container.addClass(d))}var ke=Math.floor(Math.min(ve,de)-k);e.$list.css({"max-height":ke||T})}},"_sizeAndPositionItemsList"),f=o(function(e,T,A){N(e)&&e._running_promise.cancel("Scrolling happened"),!e._all_done_fetching&&(e._running_promise=e.data_promise(T,A).then(function(k){var W=k;if(W.items&&(W=W.items),W&&W.length){e._page_number+=1,e._current_data||(e._current_data=e.data.slice()),typeof k.all_items_fetched<"u"&&(e._all_done_fetching=!!k.all_items_fetched),typeof k.num_remaining<"u"&&k.num_remaining===0&&(e._all_done_fetching=!0);var se,de=parseInt(k.num_new,10)||0;se=W.slice(-de),se.length?(k._replace_all_items||k.replace_all_items?e._current_data=se:e._current_data=e._current_data.concat(se),v(e,e._current_data)):e._all_done_fetching=!0}else e._all_done_fetching=!0},function(k){TS.interop.utility.getLogger({getState:TS.redux.getState}).error(k,"LFS error"),Z(e,k,"Something failed while trying to return the next batch of data for lazyFilterSelect.")}))},"_callScrollCallback"),p=o(function(e){return e._selected.length<e.max_selected_items},"_canAddNewItem"),S=o(function(e){e.disabled||(e.disabled=!0,e.$container.addClass("disabled"),e.$input.prop("disabled",!0),e.$filter_input.prop("disabled",!0))},"_disable"),v=o(function(e,T){te(e,T),re(e,T);var A=e._list_built&&(!e.data||e.data.length===0||e.always_visible);A&&G(e,!0),i(e)},"_doAllTheThingsRequiredWithNewData"),P=o(function(e){e.disabled&&(e.disabled=!1,e.$container.removeClass("disabled"),e.$input.prop("disabled",!1),e.$filter_input.prop("disabled",!1))},"_enable"),C=o(function(e,T){for(var A=e.data,k=[],W=0;W<A.length;W+=1){var se=A[W];if(se.lfs_group||se.is_divider){for(var de=[],pe=0;pe<se.children.length;pe+=1){var ge=se.children[pe];e.filter(ge,T)&&de.push(ge)}de.length>0&&k.push({is_divider:!0,lfs_group:!0,label:se.label,children:de})}else e.filter(se,T)&&k.push(se)}return k},"_filterGroup"),D=o(function(e){return e.attr("data-lfs-id")||e.prop("lfs_id")||null},"_getLfsId"),O=o(function(e,T,A){var k=D(T),W;if(A)W=e._selected;else if(W=e.data_promise&&e._current_data?e._current_data:e.data,k.indexOf(".")!==-1){var se=parseInt(k.split(".")[0],10);W=W[se]?W[se].children:W[0].children}var de=W.filter(function(pe){return pe.lfs_id===k});return de.length?de[0]:null},"_getData"),Q=o(function(e,T){var A=parseInt(T.attr("data-lfs-slug-id"),10),k=e._selected,W=k.filter(function(se){return se.lfs_slug_id===A});return W.length?W[0]:null},"_getUserCreatedSlugData"),Y=o(function(e,T){T=T||{};var A=!e._list_visible||e.always_visible||e.disabled;A&&!T.force||(e._list_visible=!1,e.$list_container.removeClass("visible"),e.$container.removeClass("list_visible"),e.$input_container.removeClass("active"),e._list_built&&e.$list.longListView("setHidden",!0),e._$active=null,e.onListHidden())},"_hideList"),H=o(function(e){return e.sluggify.enabled?e.sluggify.delimiter?e.sluggify.key_name?e.single?(TS.error("Sluggify only works in multi-select versions of lazyFilterSelect."),!1):!0:(TS.error("You must pass a key name to use sluggify with lazyFilterSelect."),!1):(TS.error("You must pass a delimiter regular expression to use sluggify with lazyFilterSelect."),!1):!1},"_instanceCanSluggify"),F=o(function(e,T){if(!e._selected.length)return!1;var A=e._selected.filter(function(k){return k.lfs_id===T.lfs_id});return!!A.length},"_isAlreadySelected"),ee=o(function(e){return e instanceof jQuery?!!e.attr("data-lfs-slug-id"):e.lfs_slug_id!==void 0},"_itemIsUserCreatedSlug"),c=o(function(e,T,A){if(H(e)&&ee(T)){var k=$(T),W=I(k.data("lfs-item-desc"),e);e._slug_id_counter=Math.max(T.lfs_slug_id,e._slug_id_counter)+1,e._selected.push(T);var se,de=TS.templates.lazy_filter_select_item({content:e.tokenTemplate(T),icon:k.data("lfs-item-icon"),desc:new Handlebars.SafeString(W),applied_classes:"lfs_token",slug_id:T.lfs_slug_id,data_qa:e.data_qa}).replace(/(\r\n|\n|\r)/gm,"");return se=$(de),se.insertBefore(e.$input),i(e),e.sluggify.validator&&e.sluggify.validator(se),e.data=A.filter(function(pe){return pe.lfs_slug_id!==T.lfs_slug_id}),e.data}},"_loadSlugAndRemoveFromData"),x=o(function(e){var T=e.children("option, optgroup"),A=T.length>0?[]:void 0;return T.each(function(){if($(this).prop("tagName")==="OPTGROUP"){var k=$(this).children("option").toArray();$(this).prop("disabled")&&(k=k.map(function(W){return W.lfs_disabled=!0,W})),A.push({is_divider:!0,lfs_group:!0,label:$(this).prop("label"),children:k})}else A.push(this)}),A},"_parseHTMLOptionData"),re=o(function(e,T){if(T||(T=e.data),!T){Z(e);return}if(T.length===0){V(e);return}if(he(e,{keep_input_active:!0}),!e._list_built)(!e.data||e.data.length===0)&&(e.data=T),K(e);else{var A=J(T);e.$list.longListView("setItems",A,!0),e._current_data=T,ie(e)}u(e)},"_populate"),J=o(function(e){var T=[];return e.forEach(function(A){if(T.push(A),A.children&&A.children.length)for(var k=0;k<A.children.length;k+=1)T.push(A.children[k])}),T},"_preLongListViewPrep"),te=o(function(e,T){if(T||(T=e.data),!!T){for(var A="",k=!e.single,W=0;W<T.length;){var se=T[W];if(ee(se)){T=c(e,se,T);continue}if(se.children&&se.children.length&&(se.lfs_group=!0),se.lfs_group||se.is_divider){se.is_divider=!0;for(var de=W,pe=0;pe<se.children.length;pe+=1){var ge=se.children[pe];if(ge.lfs_id=ge.lfs_id||`${de}.${pe}`,(ge.selected||ge.preselected)&&e.no_default_selection===!1){if(e.single&&e._selected.length>0||F(e,ge))continue;e._selected.push(ge),A+=a(e,ge,{should_tokenize:k})}}}else if(se.lfs_id=se.lfs_id||String(W),(se.selected||se.preselected)&&e.no_default_selection===!1){if(e.single&&e._selected.length>0||F(e,se)){W+=1;continue}e._selected.push(se),A+=a(e,se,{should_tokenize:k})}W+=1}A.length>0&&(e.$container.addClass("value"),e.single?e.$lfs_value.html(A):($(A).insertBefore(e.$input),e.$input_container.removeClass("empty"),e.$input_container.removeClass("error"),l(e)))}},"_prepItems"),q=o(function(e){for(;e.$input_container.find(".lfs_token").length>0;)ne(e)},"_removeAllSelected"),ne=o(function(e){var T=e.$input_container.find(".lfs_token").last();T.length&&ce(e,T)},"_removeLastSelected"),ce=o(function(e,T){if(!e.disabled){if(ee(T)){L(e,T);return}var A=O(e,T,!0);if(!(A.disabled||e.restrict_preselected_item_removal&&A.preselected)){e._selected=e._selected.filter(function(W){return W!==A});var k=e.$list.find(`[data-lfs-id="${A.lfs_id}"]`);k.removeClass("selected"),T.remove(),me(e),e.$filter_input.val().length+e._selected.length===0&&B(e),e._selected.length===0&&e.$container.removeClass("value"),e.onItemRemoved(A)}}},"_removeSelected"),L=o(function(e,T){if(H(e)){var A=Q(e,T);e._selected=e._selected.filter(function(k){return k!==A}),T.remove(),me(e),e.$filter_input.val().length+e._selected.length===0&&B(e),e.onItemRemoved(A)}},"_removeUserCreatedSlug"),z=o(function(){this.data&&this.data.length===0&&TS.warn("Data passed to lazyFilterSelect is empty."),le(this,this.data),this.always_visible&&G(this),this.restrict_input_container_height&&(this.$container.addClass("has_restricted_input_container_height"),TS.environment.supports_custom_scrollbar||this.$input_container.monkeyScroll())},"_run"),j=o(function(e,T,A){if(!e.disabled&&T!==e._previous_val)if(e._all_done_fetching=!1,e._previous_val=T,e._$active=null,i(e),e._page_number=1,e._list_built&&e.$list.longListView("scrollToTop",!0),e.data_promise)N(e)&&e._running_promise.cancel("User entered more text"),e._running_promise=X(e,T).then(function(W){v(e,W),G(e,A)},function(W){TS.interop.utility.getLogger({getState:TS.redux.getState}).error(W,"LFS error"),Z(e,W,"Something failed while trying to return the filtered data for lazyFilterSelect.")});else{G(e,A);var k=C(e,T);re(e,k),i(e)}},"_runQuery"),X=o(function(e,T){return new Promise(function(A,k){T.length<e.min_query_length?(e._all_done_fetching=!0,A([])):(_.delay(function(){N(e)&&_e(e)},650),e.data_promise(T).then(function(W){W=W||{},_.isUndefined(W.all_items_fetched)||(e._all_done_fetching=!!W.all_items_fetched),W.num_remaining===0&&(e._all_done_fetching=!0);var se=(W.items||W).slice();A(se),he(e,{keep_input_active:!0})},function(W){k(W),he(e)}))})},"_runDataPromiseQuery"),N=o(function(e){return e._running_promise&&e._running_promise.isPending()},"_isRunningPromisePending"),y=o(function(e,T){if(!e.disabled){if(!e._list_visible){G(e);return}var A;e._$active?A=e._$active[T](".lfs_item:not(.disabled, .hidden)").first():A=e.$list.find(".lfs_item:not(.disabled, .hidden)").first(),A.length&&(A.scrollintoview({duration:0}),e._$active&&e._$active.removeClass("active"),A.addClass("active"),e._$active=A)}},"_select"),U=o(function(e){return!(e.hasClass("selected")||e.hasClass("disabled"))},"_selectable"),h=o(function(e,T){if(p(e)){if(e.single&&e._selected.length){var A=e.$list.find(`[data-lfs-id="${e._selected[0].lfs_id}"]`);A.removeClass("selected"),e._selected.length=0,e.$lfs_value.empty()}e._selected.push(T),me(e);var k=$(a(e,T,{should_tokenize:!e.single}));_.isFunction(e.tokenClass)&&k.addClass(e.tokenClass(T)),e.single?e.$lfs_value.html(k):(k.addClass("lfs_token"),k.insertBefore(e.$input)),e.single||(e.$input_container.removeClass("empty"),e.$input_container.removeClass("error"),l(e)),e.$container.addClass("value"),e.onItemAdded(T),p(e)||e.onMaxItemsSelected(),e.single||e.$filter_input.focus()}},"_selectDataItem"),w=o(function(e){return y(e,"nextAll")},"_selectDown"),R=o(function(e){if(!e.disabled){var T=e._$active;if(T.length&&U(T)&&p(e)){T.addClass("selected"),T.removeClass("active"),e._$active=null;var A=O(e,T);h(e,A)}}},"_selectListItem"),E=o(function(e){return y(e,"prevAll")},"_selectUp"),B=o(function(e){e.$input_container.addClass("empty"),g(e)},"_showEmptyState"),G=o(function(e,T){e.disabled||(TS.utility.rAF(function(){e.$filter_input.focus()}),!e._list_visible&&(e._showing_status&&e.always_visible||(e._list_built||K(e),(e._list_built||e._showing_status)&&(e._list_visible=!0,e.$list_container.addClass("visible"),e.$container.addClass("list_visible"),b(e)||e.$input_container.addClass("active"),e._list_built&&e.$list.longListView("setHidden",!1)),e.single&&!T&&(e.$filter_input.val(""),e._previous_val="",e.$filter_input.focus(),M(e)&&(e.data=[]),re(e)),e.set_height&&(u(e),e.monkey_scroll&&!TS.environment.supports_custom_scrollbar&&e.$list.monkeyScroll()),e.onListShown())))},"_showList"),K=o(function(e){if(!(!e.data||e.data.length===0)){var T=J(e.data);e._list_built=!0;var A={items:T,approx_item_height:e.approx_item_height,approx_divider_height:e.approx_divider_height,preserve_dom_order:!0,calcDividerHeight:function(k){return k.outerHeight()},makeDivider:function(){return $('<div class="lfs_group"></div>')},makeElement:function(){return $(TS.templates.lazy_filter_select_item().replace(/(\r\n|\n|\r)/gm,""))},renderDivider:function(k,W,se){if(e.renderDividerFunc)return e.renderDividerFunc(k,W,se);k.html(I(W.label,e))},renderItem:function(k,W,se){if(e.render_item_func)return e.render_item_func(k,W,se);var de=$(W),pe="active selected disabled single group_item lfs_token",ge={disabled:W.disabled||W.lfs_disabled,selected:F(e,W),single:e.single,group_item:de.hasClass("group_item")};_.isFunction(e.listItemClass)&&(ge[e.listItemClass(W)]=!0);var ve=TS.utility.getAppliedClasses(ge),we={"data-qa":`${e.data_qa}-item-${W.lfs_id}`,"data-lfs-id":W.lfs_id,title:W.title};if(k.attr(we).removeClass(pe).addClass(ve).html(e.template(W).string),de.data("lfs-item-icon")){var Se=`url(${de.data("lfs-item-icon")})`,$e=$('<span class="lfs_item_icon">').css("background-image",Se);k.prepend($e)}if(de.data("lfs-item-desc")){var be=I(de.data("lfs-item-desc"),e),ke=$('<span class="lfs_item_desc">').html(be);k.append(ke)}}};e.$list.longListView(A),t(e),e.$list_items=e.$container.find(".list_items"),TS.utility.rAF(function(){e.monkey_scroll&&!TS.environment.supports_custom_scrollbar&&e.$list.monkeyScroll(),e.$list.longListView("resizeImmediately"),TS.utility.rAF(function(){e.current_items_in_view_signal.dispatch(e.$list.longListView("getCurrentItemsInView")||[])})}),e.$list.longListView("getCurrentItemsInViewSignal")&&e.$list.longListView("getCurrentItemsInViewSignal").add(function(k){e.current_items_in_view_signal.dispatch(k)})}},"_startListView"),ae=o(function(e){e.stopPropagation(),e.preventDefault()},"_stopThePresses"),ue=o(function(e,T){if(!(e.single||!e.allow_item_unselect)){var A=O(e,T,!0);T.removeClass("selected"),e._selected=e._selected.filter(function(k){return k!==A}),e.$input_container.find(`.lfs_item[data-lfs-id="${A.lfs_id}"]`).remove(),me(e),e.$filter_input.val().length+e._selected.length===0&&B(e),e._selected.length===0&&e.$container.removeClass("value"),e.onItemRemoved(A)}},"_unselectItem"),oe=o(function(e,T){if(!(!H(e)||!ee(T))){var A=T.text().trim();T.length&&L(e,T),e.$filter_input.val(A),i(e),e.$filter_input.select()}},"_unsluggifySlug"),le=o(function(e,T){if(e.data=T||x(e.$select),e.data&&(e._selected=[],te(e),e.$filter_input.val().length)){var A=e.$filter_input.val();e._previous_val="",j(e,A)}},"_update"),ie=o(function(e){e.restrict_input_container_height&&TS.ui.utility.updateClosestMonkeyScroller(e.$input_container,!0),e.monkey_scroll&&!TS.environment.supports_custom_scrollbar&&(u(e),TS.utility.rAF(function(){TS.ui.utility.updateClosestMonkeyScroller(e.$list,!0)}))},"_updateMonkeyScroll"),me=o(function(e){if(!e.append){var T=e._selected.filter(function(A){return A instanceof HTMLOptionElement}).map(function(A){return $(A).val()});e.$select.val(T).trigger("change")}},"_updateVal"),I=o(function(e){return e=_.escape(e),e},"_formatTextForDisplay"),l=o(function(e){e.$input.attr("placeholder",""),b(e)&&e.$filter_input.attr("placeholder","")},"_clearPlaceholderText"),g=o(function(e){e.$input.attr("placeholder",e.placeholder_text),b(e)&&e.$filter_input.attr("placeholder",e.filter_placeholder_text)},"_resetPlaceholderText"),b=o(function(e){return e.style===TS.ui.lazy_filter_select.STYLES.filter_in_list},"_isFilterInListStyle"),M=o(function(e){return _.isFunction(e.data_promise)&&e.min_query_length},"_usingMinQueryLength"),Z=o(function(e,T,A){fe(e,e.errorTemplate(T),{internal_error_message:A,clear_active_items:!0})},"_showErrorStatus"),V=o(function(e){var T=e.noResultsTemplate(e.$filter_input.val());fe(e,T,{clear_active_items:!0})},"_showNoResultsStatus"),_e=o(function(e){var T=TS.interop.i18n.t("Loading results\u2026","lazy_filter_select")();fe(e,T,{show_loading_indicator:!0})},"_showLoadingStatus"),fe=o(function(e,T,A){A=A||{},e._showing_status=!0,A.internal_error_message&&TS.error(A.internal_error_message),b(e)||e.$input_container.addClass("active"),A.show_loading_indicator&&e.$status_loading_indicator.removeClass("hidden"),A.clear_active_items&&(e._$active=null),e.$status_content.html(T),e.$list_container.addClass(m)},"_showStatus"),he=o(function(e,T){T=T||{},e._showing_status=!1,T.keep_input_active||e.$input_container.removeClass("active"),e.$status_loading_indicator.addClass("hidden"),e.$list_container.removeClass(m)},"_hideStatus"),ye=o(function(e){e._prevent_blur=!1},"_onContainerMouseleave"),Te=o(function(e){e.disabled||G(e)},"_onContainerClick"),Be=o(function(e,T){e.disabled||T.which!==13||G(e)},"_onContainerKeydownEnter"),Pe=o(function(e,T){e.disabled||(T.preventDefault(),G(e))},"_onContainerParentsLabelClick"),Ue=o(function(e){e.$input_container.click(),e.$input.focus()},"_onInputContainerFocus"),Ee=o(function(e){e._input_is_focused||(e._input_is_focused=!0,e.$input_container.click(),e.onInputFocus()),e.single||e.$input_container.addClass("active")},"_onInputFocus"),Ce=o(function(e){var T=e.$filter_input.val();if(H(e)&&T.match(e.sluggify.delimiter)){var A=T.split(e.sluggify.delimiter);A.forEach(function(k){k.length&&r(e,k)})}else j(e,T,!0)},"_onFilterInputInput"),Me=o(function(e,T){if(!e.disabled){switch(T.keyCode){case TS.utility.keymap.down:ae(T),w(e);break;case TS.utility.keymap.up:ae(T),E(e);break;case TS.utility.keymap.enter:xe(e,T);break;case TS.utility.keymap.del:He(e,T);break;case TS.utility.keymap.tab:Ie(e,T);break;case TS.utility.keymap.esc:Ne(e,T);break;default:break}e.onKeyDown(T,T.isDefaultPrevented())}},"_onFilterInputKeydown"),Fe=o(function(e){e._prevent_blur||(Y(e),he(e)),e._input_is_focused=!1,e.onInputBlur()},"_onFilterInputBlur"),xe=o(function(e,T){if(e._$active&&e._$active.length&&e._list_visible){ae(T);var A=e._$active,k=!e.single&&e.allow_item_unselect&&F(e,O(e,A));if(k)ue(e,A);else{if(!p(e))return;R(e);var W=$(T.currentTarget);W.val()!==""&&(W.val(""),e._previous_val="",re(e)),e.single&&(Y(e),he(e))}}},"_onFilterInputKeydownEnter"),He=o(function(e,T){if(e.$filter_input.val()===""){ae(T);var A=e.$input_container.find(".lfs_token").last();H(e)&&ee(A)?oe(e,A):ne(e)}},"_onFilterInputKeydownDel"),Ie=o(function(e,T){e.$filter_input.val().trim()&&H(e)?(ae(T),r(e,e.$filter_input.val())):e.tab_to_nav&&(ae(T),T.shiftKey?E(e):w(e))},"_onFilterInputKeydownTab"),Ne=o(function(e,T){ae(T),Y(e),he(e),e.$filter_input.blur()},"_onFilterInputKeydownEsc"),Le=o(function(e,T){e.disabled||(T.stopPropagation(),G(e),e._prevent_blur=!1)},"_onValueClick"),We=o(function(e,T){T.which===1&&(e._prevent_blur=!0)},"_onValueMousedown"),Oe=o(function(e,T){e.disabled||(ce(e,$(T.currentTarget)),e._prevent_blur=!1)},"_onTokenClick"),je=o(function(e,T){T.which===1&&(e._prevent_blur=!0)},"_onTokenMousedown"),Ae=o(function(e,T){T.which===1&&(e._prevent_blur=!0)},"_onListContainerMousedown"),ze=o(function(e){e._prevent_blur&&e.$filter_input.focus()},"_onListContainerMouseup"),De=o(function(e,T){if(!e.disabled&&!(T.clientX==e._mouse.lastX&&T.clientY==e._mouse.lastY)){var A=$(T.currentTarget);e._$active&&e._$active.removeClass("active"),!A.hasClass("active")&&U(A)&&(A.addClass("active"),e._$active=A),e._mouse.lastX=T.clientX,e._mouse.lastY=T.clientY}},"_onItemMousemove"),Ke=o(function(e,T){$(T.currentTarget).removeClass("active"),e._$active=null},"_onActiveItemMouseleave"),Re=o(function(e,T){if(!e.disabled){T.preventDefault();var A=$(T.currentTarget);e._$active=A;var k=!e.single&&e.allow_item_unselect&&F(e,O(e,A));if(k)ue(e,A);else{var W=U(A);if(!W&&!e.single||!p(e))return;if(!W&&e.single){Y(e),T.stopPropagation();return}R(e),e.$filter_input.val()!==""&&(e.$filter_input.val(""),e._previous_val="",re(e)),e.single&&(Y(e),T.stopPropagation())}e._prevent_blur=!1}},"_onItemClick")})()},3956101715:()=>{(function(){TS.registerModule("ui.people_picker",{STYLES:{normal:"normal",small:"small"},onStart:function(){},preload:function(t){return r(t)(""),t},make:function(t,n){n=n||{},n.append||t.addClass("hidden"),n.style=_.get(TS.ui.people_picker.STYLES,n.style,TS.ui.people_picker.STYLES.normal),t.lazyFilterSelect({append:!!n.append,always_visible:!!n.always_visible,approx_item_height:n.approx_item_height||50,data_promise:r(n),placeholder_text:n.placeholder_text||TS.interop.i18n.t("Search by name","people_picker")(),classes:"people_picker",scroll_threshold:2500,single:!!n.single,style:n.style,sluggify:n.sluggify,disabled:n.disabled,template:n.template||function(a){var d=TS.templates.member_small({member:a.member});return new Handlebars.SafeString(d)},tokenTemplate:n.tokenTemplate||function(a){var d=TS.templates.member_token({member:a.member});return new Handlebars.SafeString(d)},tokenClass:function(a){return TS.templates.builders.getMemberTypeClass(a.member)},noResultsTemplate:n.noResultsTemplate||function(a){return a?TS.interop.i18n.t("No one found matching <strong>{query}</strong>","people_picker")({query:TS.interop.i18n.safeString(_.escape(a))}):TS.interop.i18n.t("No one found","people_picker")()},onItemAdded:n.onItemAdded,onItemRemoved:n.onItemRemoved})},value:function(t){return t.lazyFilterSelect("value")},clearValue:function(t){return t.lazyFilterSelect("clearValue")},recomputeHeight:function(t){return t.lazyFilterSelect("recomputeHeight")}});var s=["include_slackbot","include_self","include_bots","only_local_team","only_admins"],r=o(function(t){var n={},a={};t.preselected_ids&&t.preselected_ids.length&&_.forEach(t.preselected_ids,function(u){u&&(a[u]=!0)});var d={};t.omitted_ids&&t.omitted_ids.length&&_.forEach(t.omitted_ids,function(u){u&&(d[u]=!0)});var m=o(function(u,f){if(u.charAt(0)==="@"&&(u=u.substring(1)),u===""&&t.empty_query_result)return f>0?Promise.resolve([]):Promise.resolve(t.empty_query_result.map(function(S){return{member:S,lfs_id:String(S.id),preselected:!!a[S.id]}}));if(u===""&&t.initial_load_promise)return _.isUndefined(f)||(t.initial_load_promise=i(t.initial_load_promise,a,d)),t.initial_load_promise;n.query!==u&&(n.query=u,n.include_org=TS.boot_data.page_needs_enterprise,n.include_slackbot=!!t.include_slackbot,n.include_self=t.include_self,n.full_profile_filter=!1,n.include_bots=!!t.include_bots,n.only_local_team=!!t.only_local_team,n.only_admins=!!t.only_admins);var p=TS.interop.members.ensureMembersArePresent(_.keys(a)).then(function(){return i(n,a,d)});return u===""&&!t.initial_load_promise&&(t.initial_load_promise=p),p},"promiseToFilter");return m},"_createFilterFunction"),i=o(function(t,n,a){return Promise.resolve().then(function(){var d=[],m=_.keys(n);return m.forEach(function(u){var f=TS.interop.members.getMemberById(u);f||d.push(u)}),d.length?TS.interop.members.ensureMembersArePresent(d).catch(_.noop):Promise.resolve()}).then(function(){return TS.members.promiseToSearchMembers(t).then(function(d){var m=[];if(d.query===""){var u=_.pick(t,s);m=TS.members.getMembersWithOptions(u)}else m=d.items;return d.items=m.filter(function(f){return!a[f.id]}).map(function(f){return f.member&&typeof f.preselected<"u"?f:{member:f,lfs_id:String(f.id),preselected:!!n[f.id]}}),d})})},"_getSearchPromise")})()},218669524:()=>{(function(){TS.registerModule("ui.validation",{completed_sig:new signals.Signal,onStart:function(){f(),$("body").on("input.validation paste.validation change.validation","[data-validation]",TS.utility.debounce(function(l){$(l.target).is(".ql-editor")||$(l.target).is(".ql-clipboard")?P($(l.target).closest(".ql-container"),{},l):P($(l.target),{},l)},500)),$("body").on("input.channel-name-validation paste.channel-name-validation change.channel-name-validation",'[data-validation*="channel_name"]',function(l){const g=$(l.target);if(!g.is('input[type="text"]'))return;const b={query:me(g),count:1};TS.interop.channels.fetchAndUpsertChannelsWithQuery({query:b})}),$("body").on("submit.validation","form[data-validation-form]",function(l){var g=$(l.target),b=TS.ui.validation.validate(g);b||l.preventDefault(),TS.ui.validation.completed_sig.dispatch(g,{event:l,passed:b})})},validate:function(l,g){g=g||{};var b=document;if(l){if(l.is("[data-validation]"))return l.length===1?P(l,g):l.toArray().every(function(V){return P($(V),g)});b=l.get(0)}var M=Array.prototype.slice.call(b.querySelectorAll("[data-validation]"));if(g&&g.fast)return M.every(function(V){return P($(V),g)});if(g&&g.verbose){var Z={};return M.forEach(function(V){Z[V.name]=P($(V),g)}),Z}return M.reduce(function(V,_e){return P($(_e),g)&&V},!0)},register:function(l,g){if(v[l]){TS.warn(`${l} cannot be registered because that key is already in use.`);return}if(typeof g!="function"){TS.warn("Only functions can be registered as validators.");return}v[l]=g},showCustomValidation:function(l,g,b,M){E(l,b.error_message||g,b.class,b,M)},getErrorMessage:function(l,g){switch(l){case"invalid_name_required":return n.required;case"invalid_name_punctuation":return n.punctuation;case"invalid_name_maxlength":return n.maxlength;case"invalid_name_specials":return n.specials;case"name_taken":return n.name_taken({name:g.name});case"restricted_action":return u.restricted_action;case"name_invalid_name_required":return m.required;case"invalid_starts_with_at":return m.at_sign;case"name_invalid_name_maxlength":case"too_long":return m.maxlength;case"invalid_reserved_word":return m.reserved;case"name_invalid_name_specials":return m.specials;case"invalid_emoji_not_allowed":return I(g.name||"");case"display_name_not_allowed":return m.sso_display_name;case"invalid_email":return p.invalid;case"url_in_message":return S.url_in_message;case"invalid_target_domain":return a.invalid_target_domain;case"invalid_target_domain_sameorg":return a.invalid_target_domain_sameorg;case"invalid_target_domain_self":return a.invalid_target_domain_self;default:return TS.interop.i18n.t("For some weird reason, that didn\u2019t work. Please try again to continue.","ui_validation")()}},maybeConvertNameErrorCode:function(l){return l==="invalid_name_specials"?"name_invalid_name_specials":l==="invalid_name_maxlength"?"name_invalid_name_maxlength":l==="invalid_name_required"?"name_invalid_name_required":l},showError:function(l,g,b,M){E(l,b.error_message||g,"validation_error",b,M)},showWarning:function(l,g,b,M){E(l,b.warning_message||g,"validation_warning",b,M)},showSuccess:function(l,g,b,M){E(l,b.success_message||g,"validation_success",b,M)},test:function(){return{validations:v}}});var s=80,r=80,i=21,t=TS.interop.i18n.t("Channel names can\u2019t be longer than {maxLength} characters.","ui_validation")({maxLength:r}),n={name_taken:TS.interop.i18n.t("{name} is already taken by a channel, username, or user group.","ui_validation"),lowercase:TS.interop.i18n.t("Channel names must be all lowercase. Try again?","ui_validation")(),maxlength:t,required:TS.interop.i18n.t("Don\u2019t forget to name your channel.","ui_validation")(),specials:TS.interop.i18n.t("Channel names can\u2019t contain spaces, periods, or most punctuation. Try again?","ui_validation")(),punctuation:TS.interop.i18n.t("Names can\u2019t consist solely of punctuation. Please elaborate!","ui_validation")()},a={invalid_target_domain:TS.interop.i18n.t("{targetDomain}.slack.com\xA0doesn\u2019t appear to be in use.","shared"),invalid_target_domain_sameorg:TS.interop.i18n.t("{targetDomain} is a part of your organization.","shared"),invalid_target_domain_self:TS.interop.i18n.t("You\u2019ll need to enter the Slack URL of the other organization.","shared")()},d={firstalphanumeric:TS.interop.i18n.t("Usernames must start with a letter or number. Sorry about that!","ui_validation")(),lowercase:TS.interop.i18n.t("Sorry, usernames must be lowercase!","ui_validation")(),maxlength:TS.interop.i18n.t("Sorry, that\u2019s a bit too long! Usernames must be fewer than {max_length_plus_one} characters.","ui_validation","10f62c929475d76c2b47d666c9703843310ef356")({max_length_plus_one:i+1}),required:TS.interop.i18n.t("Please fill in a username.","ui_validation")(),specials:TS.interop.i18n.t("Usernames can\u2019t contain special characters. Sorry about that!","ui_validation")()},m={required:TS.interop.i18n.t("Unfortunately, you can\u2019t leave this blank.","ui_validation")(),at_sign:TS.interop.i18n.t("Names can\u2019t start with the @ sign \u2014\xA0that\u2019s how your coworkers will mention you in conversation.","ui_validation","dbbcef363a405836bfc582044f84fec0a0a1cc64")(),maxlength:TS.interop.i18n.t("Unfortunately, names can\u2019t be longer than {maxlength} characters.","ui_validation")({maxlength:s}),reserved:TS.interop.i18n.t("That name\u2019s already being used by Slack.","ui_validation")(),specials:TS.interop.i18n.t("Mostly, names can\u2019t contain punctuation. (Apostrophes, spaces, and periods are fine.)","ui_validation")(),emoji:TS.interop.i18n.t("For all manner of complex reasons, names simply cannot contain emoji. Try again?","ui_validation")(),sso_display_name:TS.interop.i18n.t("Display names are automatically set by your organization.","ui_validation")()},u={},f=o(function(){u={restricted_action:TS.interop.i18n.t("Sorry! An admin in your workspace has restricted who can create private channels.","ui_validation")()}},"_initMpimErrorMessages"),p={invalid:TS.interop.i18n.t("This doesn\u2019t seem like an email address. Sorry!","ui_validation")()},S={url_in_message:TS.interop.i18n.t("Unfortunately, custom messages can\u2019t contain URLs.","ui_validation")()},v={dateandformat:q,firstalphanumeric:L,hasnourl:F,isurl:Y,isouathredirecturl:H,lowercase:ne,maxcsv:J,maxlength:c,mincsv:re,minlength:ee,nospace:ce,required:D,reservedwords:O,keywords:Q,username:z,channel_name:X,team_name:N,is_email:y,membername:j,is_time:h},P=o(function(l,g,b){g=g||{},l.is("[data-validation-for]")&&(g.custom_for=l.attr("data-validation-for")),g.success_message=TS.interop.i18n.t("Nice, thanks!","ui_validation")(),l.is("[data-validation-success]")&&(g.success_message=l.attr("data-validation-success")),l.is("[data-validation-warning]")&&(g.warning_message=l.attr("data-validation-warning")),l.is("[data-validation-error]")&&(g.error_message=l.attr("data-validation-error")),l.is("[data-validation-trim-value]")&&(g.trim_value=!0),oe(l)&&ue(l,g);var M=C(l).every(function(Z){if(Z.indexOf("=")===-1)return v[Z.trim()](l,g);var V=Z.split("=");return v[V[0]](l,g,V[1])});return TS.ui.validation.completed_sig.dispatch(l,{event:b,passed:M}),R(l,M,g)&&TS.ui.validation.showSuccess(l,g.success_message,g,3e3),l.attr("aria-invalid",!M),M},"_validate"),C=o(function(l){return l.is("[data-validation]")?_.compact(l.attr("data-validation").replace(/\s*(,|=)\s*/g,"$1").split(/\s+/)):[]},"_getValidators");function D(l,g){if(l.is('input[type="radio"]')){if($(document.querySelectorAll(`[name="${l.prop("name")}"][data-validation]`)).filter(":checked").length)return!0;TS.ui.validation.showWarning(l,TS.interop.i18n.t("Please select an option","ui_validation")(),g)}else if(l.is('input[type="checkbox"]')){if($(document.querySelectorAll(`[name="${l.prop("name")}"][data-validation]`)).filter(":checked").length)return!0;TS.ui.validation.showWarning(l,TS.interop.i18n.t("Please select at least one option","ui_validation")(),g)}else if(l.is("select")){var b=_.get(l.data(),"TSLazyFilterSelect",!1);if(b&&!_.isEmpty(b.value())||!b&&!_.isEmpty(l.val()))return!0;TS.ui.validation.showWarning(l,TS.interop.i18n.t("Please select an option","ui_validation")(),g)}else if(oe(l)){if(le(l).trim())return!0;TS.ui.validation.showWarning(l,TS.interop.i18n.t("This field can\u2019t be empty","ui_validation")(),g)}else TS.error("Error: cannot validate")}o(D,"_validateRequired");function O(l,g,b){if(l.is('input[type="radio"]')||l.is('input[type="checkbox"]')||l.is("select"))return!0;if(oe(l)){var M=le(l).trim().toLowerCase(),Z=b.split(",");if(Z.indexOf(M)===-1)return!0;TS.ui.validation.showWarning(l,TS.interop.i18n.t('"{word}" is a reserved word. Try something else!',"ui_validation")({word:TS.interop.i18n.safeString(_.escape(M))}),g)}else TS.error("WTF: cannot validate")}o(O,"_validateReservedWords");function Q(l,g){return O(l,g,TS.model.RESERVED_KEYWORDS.join(","))}o(Q,"_validateKeywords");function Y(l,g,b){var M=le(l);g&&g.trim_value&&(M=M.trim());var Z=TS.interop.i18n.t("This doesn\u2019t seem like a proper link. Sorry!","ui_validation")(),V,_e=!1,fe=!1;if(!M||l.is('input[type="radio"]')||l.is('input[type="checkbox"]')||l.is("select"))return!0;if(!oe(l)){TS.error("Error: cannot validate");return}if(b){V=b.split(","),V.indexOf("http")!=-1&&V.indexOf("https")==-1&&V.push("https");for(var he=0;he<V.length;he+=1)M.indexOf(`${V[he]}://`)===0&&(_e=!0);!_e&&V.indexOf("https")!=-1&&(Z=TS.interop.i18n.t("Please use https (for security).","ui_validation")())}else _e=!0,M.indexOf("://")==-1&&(M=`http://${M}`);if(fe=TS.interop.url.simpleIsUrl(M),fe&&_e)return!0;TS.ui.validation.showWarning(l,Z,g)}o(Y,"_validateIsUrl");function H(l,g,b){if(Y(l,g,b)){var M=le(l);if(M.indexOf("#")==-1)return!0;const Z=TS.interop.i18n.t("Oauth redirect URLs should not contain a fragment component (#)","ui_validation")();TS.ui.validation.showWarning(l,Z,g)}}o(H,"_validateIsOauthRedirectUrl");function F(l,g){if(l.is('input[type="radio"]')||l.is('input[type="checkbox"]')||l.is("select"))return!0;if(oe(l)){var b=le(l);if(!b||!TS.interop.url.findUrlsInString(b).length)return!0;TS.ui.validation.showWarning(l,S.url_in_message,g)}else TS.error("Error: cannot validate")}o(F,"_validateHasNoUrl");function ee(l,g,b,M){return x(l,"minlength",g,b,M)}o(ee,"_validateMinLength");function c(l,g,b,M){return x(l,"maxlength",g,b,M)}o(c,"_validateMaxLength");function x(l,g,b,M,Z){if(l.is('input[type="radio"]')||l.is('input[type="checkbox"]')||l.is("select"))return!0;if(oe(l)){var V=le(l);if(M=+M,V===void 0||isNaN(M)){TS.error("Error: no length to validate");return}if(g==="minlength"){if(TS.interop.utility.getStringLength(V)>=M)return!0;TS.ui.validation.showError(l,TS.interop.i18n.t("This field can\u2019t be less than {minlength, plural, =1{# character}other{# characters}}","ui_validation")({minlength:M}),b)}else if(g==="maxlength"){if(Z||K(l,V.length,M,b),TS.interop.utility.getStringLength(V)<=M)return!0;TS.ui.validation.showError(l,TS.interop.i18n.t("This field can\u2019t be more than {maxlength, plural, =1{# character}other{# characters}}","ui_validation")({maxlength:M}),b)}}else TS.error("Error: cannot validate")}o(x,"_validateLength");function re(l,g,b){return te(l,"mincsv",g,b)}o(re,"_validateMinCSV");function J(l,g,b){return te(l,"maxcsv",g,b)}o(J,"_validateMaxCSV");function te(l,g,b,M){if(l.is('input[type="radio"]')||l.is('input[type="checkbox"]')||l.is("select"))return!0;if(oe(l)){var Z=le(l).trim();if(M=+M,Z===void 0||isNaN(M)){TS.error("Error: no length to validate");return}if(g==="mincsv"){if(Z.split(/\s*,\s*/).length>=M)return!0;TS.ui.validation.showError(l,TS.interop.i18n.t("This field can\u2019t have less than {minlength, plural, =1{# value}other{# values}}","ui_validation")({minlength:M}),b)}else if(g==="maxcsv"){if(Z.split(/\s*,\s*/).length<=M)return!0;TS.ui.validation.showError(l,TS.interop.i18n.t("This field can\u2019t have more than {maxlength, plural, =1{# value}other{# values}}","ui_validation")({maxlength:M}),b)}}else TS.error("Error: cannot validate")}o(te,"_validateCSV");function q(l,g,b){if(l.is('input[type="radio"]')||l.is('input[type="checkbox"]')||l.is("select"))return!0;if(oe(l)){var M=le(l).trim();if(!M)return!0;var Z,V,_e,fe;switch(b){case"Y-m-d":Z="YYYY-MM-DD",V=M.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/),_e=V&&V.length===1&&V[0]===M,_e&&(fe=w(`${M}T00:00:00.000Z`));break;case"m-d":Z="MM-DD",V=M.match(/^[0-9]{2}-[0-9]{2}$/),_e=V&&V.length===1&&V[0]===M,_e&&(fe=w(`0000-${M}T00:00:00.000Z`));break;default:TS.error("Error: cannot validate");return}if(_e&&fe)return!0;_e?fe||TS.ui.validation.showWarning(l,TS.interop.i18n.t("{value} doesn\u2019t appear to be a valid date. Sorry!","ui_validation")({value:TS.interop.i18n.safeString(_.escape(M))}),g):TS.ui.validation.showWarning(l,TS.interop.i18n.t("This needs to be in the format {pattern}. Sorry!","ui_validation")({pattern:Z}),g)}else TS.error("Error: cannot validate")}o(q,"_validateDateAndFormat");function ne(l,g){var b=oe(l)?le(l):l.val(),M=b===b.toLocaleLowerCase();if(M)return!0;TS.ui.validation.showWarning(l,TS.interop.i18n.t("This field must be lowercase only","ui_validation")(),g)}o(ne,"_validateLowercase");function ce(l,g){var b=oe(l)?le(l):l.val(),M=/\s/.test(b);if(!M)return!0;TS.ui.validation.showWarning(l,TS.interop.i18n.t("This field can\u2019t contain spaces","ui_validation")(),g)}o(ce,"_validateNospace");function L(l,g){var b=oe(l)?le(l):l.val(),M=/^[^\W_]/.test(b);if(M)return!0;TS.ui.validation.showWarning(l,TS.interop.i18n.t("This first character must be a letter or number","ui_validation")(),g)}o(L,"_validateFirstAlphanumeric");function z(l,g){var b=$.extend({},g,{quiet:!0});if(!D(l,b))TS.ui.validation.showWarning(l,d.required,g);else if(!c(l,b,i,!0))TS.ui.validation.showWarning(l,d.maxlength,g);else if(!ce(l,b))TS.ui.validation.showWarning(l,d.specials,g);else if(!U(l,b,/^[\w._-]+$/))TS.ui.validation.showWarning(l,d.specials,g);else if(!L(l,b))TS.ui.validation.showWarning(l,d.firstalphanumeric,g);else if(!ne(l,b))TS.ui.validation.showWarning(l,d.lowercase,g);else return!!O(l,g,TS.interop.constants.RESERVED_USERNAMES.join(","))}o(z,"_validateUsername");function j(l,g,b){var M=$.extend({},g,{quiet:!0});if(l.is('input[type="radio"]')||l.is('input[type="checkbox"]')||l.is("select"))return!0;if(!oe(l)){TS.error("Error: cannot validate");return}var Z=_.trim(le(l)),V=TS.interop.i18n.deburr(Z.toLowerCase()),_e=ie(b);if(_.includes(_e,"required")&&!D(l,M))return TS.ui.validation.showWarning(l,m.required,g),!1;if(!c(l,M,s,!0))return TS.ui.validation.showWarning(l,m.maxlength,g),!1;var fe=TS.interop.constants.RESERVED_USERNAMES.concat(TS.model.RESERVED_KEYWORDS).map(function(he){return TS.interop.i18n.deburr(he)});return fe.indexOf(V)!==-1?(TS.ui.validation.showWarning(l,m.reserved,g),!1):Z.charAt(0)==="@"?(TS.ui.validation.showWarning(l,m.at_sign,g),!1):U(l,M,/^[-_.'\u2018\u2019",(){}[\]/;]+$/)?(TS.ui.validation.showWarning(l,n.punctuation,g),!1):U(l,M,/[`~!@#$%^&*+=\\:"<>?|]/)?(TS.ui.validation.showWarning(l,m.specials,g),!1):TS.emoji.hasUnifiedEmoji(Z)?(TS.ui.validation.showWarning(l,I(Z),g),!1):!0}o(j,"_validateRealOrDisplayName");function X(l,g,b){if(l.is('input[type="radio"]')||l.is('input[type="checkbox"]')||l.is("select"))return!0;if(!oe(l)){TS.error("Error: cannot validate");return}var M=le(l),Z=ie(b),V=_.includes(Z,"fix");V&&(M=me(l));var _e=TS.validation.channel_name_with_errors(M);return _e!==!0?(g.should_truncate=!1,TS.ui.validation.showWarning(l,_e.error_message,g),!1):!0}o(X,"_validateChannelName");function N(l,g){g=g||{};var b=le(l).trim(),M=TS.validation.team_name(b);return M!==!0?(g.should_truncate=!1,M.error_key==="empty"?TS.ui.validation.showCustomValidation(l,M.error_message,g):TS.ui.validation.showError(l,M.error_message,g),!1):!0}o(N,"_validateTeamName");function y(l,g){if(l.is('input[type="radio"]')||l.is('input[type="checkbox"]')||l.is("select"))return!0;if(oe(l)){var b=le(l);if(!b)return!0;var M=b.match(TS.utility.email_regex);if(M&&M.length===1&&M[0]===b)return!0;TS.ui.validation.showWarning(l,p.invalid,g)}else TS.error("Error: cannot validate")}o(y,"_validateIsEmail");function U(l,g,b){var M=oe(l)?le(l):l.val();if(!b.test(M))TS.ui.validation.showWarning(l,TS.interop.i18n.t("This field contains invalid characters","ui_validation")(),g);else return!0}o(U,"_validatePattern");function h(l){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(l.is('input[type="radio"]')||l.is('input[type="checkbox"]')||l.is("select"))return!0;if(oe(l)){var b=le(l);if(!b||/((1[0-2]|0?[1-9]):([0-5][0-9]) ?([ap][m]))/i.test(b))return!0;TS.ui.validation.showWarning(l,"Try the format 10:30am",g)}}o(h,"_validateTime");var w=o(function(l){if(!isNaN(Date.parse(l))){var g=new Date(l);return!g.toISOString().indexOf(l)}},"_isValidISODate"),R=o(function(l,g,b){var M=$(document.querySelector(`label[for="${b.custom_for||l.attr("name")}"]`));if(M.length)return!(b&&b.quiet)&&g&&M.data("validation-ephemeral")===!1},"_shouldShowSuccess"),E=o(function(l,g,b,M,Z){if(M=M||{},_.isUndefined(M.should_truncate)&&(M.should_truncate=!0),!(M&&M.quiet)){var V=$(document.querySelector(`label[for="${M.custom_for||l.attr("name")}"]`));if(V.length){var _e=V.data("validation-timeout");clearTimeout(_e);var fe=V.find(".validation_message");if(fe.length||(fe=$("<span />").addClass("validation_message").toggleClass("overflow_ellipsis",M.should_truncate),l.is("select")&&V.find("select").length?fe.insertBefore(V.find("select")):fe.appendTo(V)),G(l,V,b),!g){fe.remove();return}fe.get(0).title=g,fe.fadeIn(100),V.data("validation-ephemeral",!!Z),Z&&V.data("validation-timeout",setTimeout(function(){V.removeData("validation-ephemeral").removeData("validation-timeout"),fe.fadeOut(100,function(){G(l,V),fe.remove()})},Z))}}},"_showMessage"),B=["validation_error","validation_warning","validation_success"],G=o(function(l,g,b){g.hasClass(b)||(l.removeClass(B.join(" ")),l.addClass(b),g.removeClass(B.join(" ")),g.addClass(b))},"_toggleValidationLevel"),K=o(function(l,g,b,M){b-g<=6?ae(l,g,b,M):ue(l,M)},"_countdown"),ae=o(function(l,g,b,M){var Z=document.querySelector(`label[for="${M.custom_for||l.attr("name")}"]`);if(Z){var V=[g,b].join("/");$(Z).attr("data-countdown",V).addClass("countdown");var _e=window.getComputedStyle(Z,":after"),fe=parseFloat(_e.width)||9*V.length;l.hasClass("no_validation_padding")||(l.data("countdown-padding-right")||l.data("countdown-padding-right",parseFloat(l.css("padding-right"))),l.css("padding-right",fe+parseFloat(_e.right)+l.data("countdown-padding-right")))}},"_setCountdown"),ue=o(function(l,g){var b=document.querySelector(`label[for="${g.custom_for||l.attr("name")}"]`);b&&($(b).removeClass("countdown"),l.removeData("countdown-padding-right"),l.css("padding-right",""))},"_clearCountdown"),oe=o(function(l){return TS.interop&&TS.interop.utility?l.is("input")||l.is("textarea")||TS.interop.utility.isContentEditableElement(l):l.is("input")||l.is("textarea")},"_isElementTextInput"),le=o(function(l){return TS.utility&&TS.utility.contenteditable?TS.utility.contenteditable.value(l):l.val()},"_getTextInputValue"),ie=o(function(l){return _.isString(l)?_(l).split(",").map(_.trim).compact().value():[]},"_parseParams"),me=o(function(l){var g=le(l),b=g.toLowerCase().replace(/^#+/,"");if(b=b.replace(/^\s+/,""),b=b.replace(/\s+$/,""),b=b.replace(/\s/g,"-"),b&&g!==b){var M=TS.utility.contenteditable.cursorPosition(l).start;b.length<g.length&&(M-=g.length-b.length),l.val(b),TS.utility.contenteditable.cursorPosition(l,M)}return b},"_fixChannelName"),I=o(function(l){var g=//u,b=[TS.interop.i18n.t("For all manner of complex reasons, names simply cannot contain emoji. Try again?","ui_validation")(),TS.interop.i18n.t("Using emoji for names makes some sense, but sadly, not enough. Try again?","ui_validation","29a0641ffb224418f796bb16c7f79013ec377a4c")(),TS.interop.i18n.t("For technical reasons, emoji are not allowed in names. Try again?","ui_validation")(),TS.interop.i18n.t("Of course you want a name with an emoji. Sadly, it is not to be. Try letters?","ui_validation")()];return l.match(g)?TS.interop.i18n.t("For reasons of party-pooping, names cannot contain emoji. Try again?","ui_validation")():_.sample(b)},"_getInvalidNameEmojiErrorMessage")})()},8755003389:()=>{(function(){TS.registerModule("user_groups",{updated_sig:new signals.Signal,updated_info_sig:new signals.Signal,legacyNeedsToFetchMembership(s){return s.users===void 0||_.size(s.users)!==s.user_count}})})()},4281234352:()=>{(function(){TS.registerModule("utility.contenteditable",{isActiveElement:function(i){return i=s(i),i&&r(i)?document.activeElement===i:!1},focus:function(i){i=s(i),i&&r(i)&&i.focus()},value:function(i,t){return i=s(i),i&&r(i)?(_.isString(t)&&(i.value=t),i.value):""},cursorPosition:function(i,t,n){_.isString(i)&&(i=$(i));var a={start:0,end:0,length:0};if(i=s(i),!i)return a;if(_.isNumber(t))n||(n=0),a.start=t,a.end=t+n,a.length=n,r(i)&&TS.selection.selectCharacters(i,a.start,a.end);else{if(!TS.utility.contenteditable.isActiveElement(i)){var d=$(i).data("utility-contenteditable-cursor-position");if(_.isObject(d))return d}r(i)&&(i.focus(),a.start=i.selectionStart,a.end=i.selectionEnd,a.length=Math.abs(i.selectionEnd-i.selectionStart))}return a},test:function(){var i={_normalizeInput:s,_isFormElement:r};return i}});var s=o(function(i){return!i||(i instanceof jQuery&&i[0]&&(i=i[0]),i.nodeType!==Node.ELEMENT_NODE)?!1:i.tagName.toLowerCase()==="textarea"||i.tagName.toLowerCase()==="input"?i:$(i).hasClass("ql-editor")?i.parentNode:i.hasAttribute("contenteditable")||i.tagName==="DIV"?i:!1},"_normalizeInput"),r=o(function(i){return!i||!i.tagName?!1:i.tagName.toLowerCase()==="textarea"||i.tagName.toLowerCase()==="input"},"_isFormElement")})()},3251160223:()=>{(function(){TS.registerModule("utility.date",{do24hrTime:function(){return TS.model.user&&TS.prefs.prefs_loaded&&TS.prefs.getPref("time24")}})})()},714886902:()=>{(function(){TS.registerModule("utility.enterprise",{splitQueryIntoTerms:function(s,r,i){var t=r,n;return s=s.trim(),s.length>=2&&(t=_.isArray(r)?_.slice(r):[],n=s.split(/\s+/),_.each(n,function(a){t.push({type:i||"fuzzy_with_email",value:a})})),t},getSSOProviderLabel:function(s,r){if(!s)return r;var i=_.get(s,"type",""),t=_.get(s,"name",""),n=i==="",a=i==="saml";return n||a?r:t||r},buildTeamUrl:function(s){return`https://${s||"my"}.${TS.boot_data.abs_root_url.replace(/(http:\/\/|https:\/\/)/,"")}`},buildOrgUrl:function(s){return`https://${s}.enterprise.${TS.boot_data.abs_root_url.replace(/(http:\/\/|https:\/\/)/,"")}`},formatChannelsData:function(s){var r=[];return s.private_channels&&(s.private_channels=_.isArray(s.private_channels)?s.private_channels:[s.private_channels],r=_.map(s.private_channels,function(i){var t=TS.interop.members.getMemberById(i.creator)||{};const n=i.members,a=Array.isArray(n)?n.length:i.members,d={creator_display:t.real_name?t.real_name:t.name,creator_id:i.creator,creator_username:t.name,date_created:i.created,member_count:i.member_count||a,purpose:i.purpose.value,topic:i.topic.value,private:!0};return _({}).assign(i,d).omit("members").value()})),s.channels&&(r=r.concat(_.map(s.channels,function(i){var t=TS.interop.members.getMemberById(i.creator)||{};const n=i.members,a=Array.isArray(n)?n.length:i.members,d={creator_display:t.real_name?t.real_name:t.name,creator_id:i.creator,creator_username:t.name,date_created:i.created,member_count:a||0,purpose:_.get(i,"purpose.value",""),topic:_.get(i,"topic.value",""),private:!1};return _({}).assign(i,d).omit("members").value()}))),r},buildApiOptionsForAnalyticsCSVExport:function(s){var r={};if(s.type&&(r.type=s.type),s.date_range&&(r.date_range=s.date_range),_.get(s.selected_columns,"length")&&(r.cols=s.selected_columns.join(",")),s.team_id&&(r.team_id=s.team_id),s.sort_prefix&&(r.sort_prefix=s.sort_prefix,s.sort_dir&&(r.sort_dir=s.sort_dir)),s.search_term){var i=TS.utility.enterprise.splitQueryIntoTerms(s.search_term,[],"fuzzy_with_email");if(i.length){var t=i.length===1?_.head(i):{type:"and",clauses:i};r.query=JSON.stringify(t)}}return r},recordAnalyticsPricingEvents:function(s,r,i){i=i||{};const t={};switch(r){case"overview_impression":t.action="impression",t.step="team_stats_overview";break;case"coachmark_impression":t.action="impression",t.step=`team_stats_overview_${_.get(i,"callout_module")}_coachmark`;break;case"coachmark_resolve":t.action="click",t.step=`team_stats_overview_${_.get(i,"callout_module")}_coachmark`,t.ui_element="learn_more_btn";break;case"coachmark_reject":t.action="dismiss",t.step=`team_stats_overview_${_.get(i,"callout_module")}_coachmark`,t.ui_element="skip_this";break;case"msg_files_pricing_btn_click":t.action="click",t.step="team_stats_overview",t.ui_element="msg_files_chart_link_btn";break;case"single_callout_upgrade_link_impression":t.action="impression",t.step="team_stats_overview",t.ui_element=`${_.get(i,"callout_module")}_upgrade_link`;break;case"multi_callout_upgrade_link_impression":t.action="impression",t.step="team_stats_overview",t.ui_element="multi_lim_upgrade_link";break;case"data_table_upsell_banner_impression":t.action="impression",t.step=`team_stats_${_.get(i,"report_name")}`;break;case"data_table_upsell_banner_click":t.action="click",t.step=`team_stats_${_.get(i,"report_name")}`,t.ui_element="see_pricing_plans_btn";break;default:}TS.interop.clog.track(s,{contexts:{ui_context:t}})},recordAnalyticsImpression:function(s,r,i,t,n){const a="ENTERPRISE_ANALYTICS",d={},m={};d.action="impression",d.ui_element=r,m.entity_key=i,m.tracking_code=t,m.anchor_page=s,n?m.target_team_id=n:m.target_team_id=TS.enterprise.model.get("org.enterprise.id")||_.get(TS.boot_data,"team_id"),TS.interop.clog.track(a,_.assign({},m,{contexts:{ui_context:d}}))},recordAnalyticsSearchEvent:function(s,r,i){const t="ENTERPRISE_ANALYTICS",n={},a={};n.action="impression",n.action_status=i?2:1,n.ui_element="SEARCH_BAR",a.entity_key=r,a.anchor_page=s,a.target_team_id=TS.enterprise.model.get("org.enterprise.id")||_.get(TS.boot_data,"team_id"),TS.interop.clog.track(t,_.assign({},a,{contexts:{ui_context:n}}))},convertDateRangeToThriftID:function(s){switch(s){case"28d":return"FILTER_LAST_28DAYS";case"30d":return"FILTER_LAST_30DAYS";case"all":return"FILTER_ALL_TIME";default:}},convertTimeseriesTabToClogKey:function(s){switch(s){case"active-users_weekly_active_users":return"wau_ts";case"active-users_daily_active_users":return"dau_ts";case"messages-and-files_messages_sent":return"messages_sent_ts";case"messages-and-files_files_uploaded":return"files_uploaded_ts";case"transparency_where_messages_sent":return"transparency_sent_ts";case"transparency_where_messages_read":return"transparency_read_ts";default:}}})})()},7410197218:()=>{(function(){TS.registerModule("utility.members",{checkMemberMatch:function(s,r,i){return!i&&s.profile&&s.profile.email&&s.profile.email.match(r)||s.profile&&s.profile.real_name_normalized&&s.profile.real_name_normalized.match(r)||s.profile&&s.profile.real_name&&s.profile.real_name.match(r)||s.profile&&s.profile.display_name_normalized&&s.profile.display_name_normalized.match(r)||s.profile&&s.profile.display_name&&s.profile.display_name.match(r)},isMemberRelevantToModel:function(s,r){return _.isObject(s)||(s=TS.interop.members.getMemberById(s)),s?TS.interop.rules.members.isSlackbot(s)?!0:s.deleted?!1:(_.isObject(r)||(r=TS.redux.channels.getEntityById(r)||TS.shared.legacyGetActiveModelOb()),!0):!1},isMemberEKMRevoked:function(s){return s&&s.id==="UREVOKEDU"}})})()},7467123565:()=>{(function(){TS.registerModule("utility.msgs",{setMsgs:function(s,r){for(var i=0;i<r.length;i+=1)r[i]=TS.utility.msgs.makeSureMsgObIsValid(r[i]);return TS.utility.msgs.sortMsgs(r),s.msgs=r,s.msgs},sortMsgs:function(s){function r(i,t){return i.ts<t.ts?1:i.ts>t.ts?-1:0}o(r,"compare"),s.sort(r)},makeSureMsgObIsValid:function(s){return s},ingestMessagesFromBootData:function(s){if(TS.boot_data.msgs){var r=TS.boot_data.msgs[s.id]||[],i=TS.interop.messages.preprocessImsgs(r.filter(t=>!!t.ts),s.id);TS.utility.msgs.setMsgs(s,i)}}})})()},5215436211:()=>{(function(){TS.registerModule("utility.search",{test:function(){return{_fetchMembersFromFlannel:t}},makeClause:function(a,d,m){if(!s(a,d,m)){var u={type:a.toLowerCase(),value:d};return m&&(u.field_id=m),u}},makeConjunction:function(a,d){if(!r(a,d))return{type:a.toLowerCase(),clauses:d}},promiseToSearch:function(a){if(!a)return Promise.reject(new Error("Cannot search without arguments."));if(a.all_of_org&&!TS.boot_data.page_needs_enterprise)return Promise.reject(new Error("cannot search an org when not an enterprise team"));if(!a.solr){if(!a.hasOwnProperty("raw_query"))return Promise.reject(new Error("Flannel searches require a `raw_query` to be provided"));var d=a.raw_query,m=a.count||1/0,u;if(_.isEmpty(a.raw_query)&&!a.only_admins)u=Promise.resolve([]);else{var f={};a.only_admins?f.filter="admins":a.only_local_team&&(f.filter="team"),u=t(a.raw_query,m,a.determine_membership_for_channel,f)}return u.then(function(v){var P=v.objects;if(!a.include_bots){var C=_.remove(P,{is_bot:!0});C.length&&TS.has_pri[n]&&TS.log(n,"Flannel: removed these bots from results:",C)}if(a.exclude_slackbot&&a.include_bots){var D=_.remove(P,{is_slackbot:!0});D.length&&TS.has_pri[n]&&TS.log(n,"Flannel: removed slackbot from results:",D)}if(TS.boot_data.page_needs_enterprise&&!a.all_of_org){var O=_.remove(P,function(H){var F=_.get(H,"enterprise_user.teams",[]),ee=_.includes(F,TS.model.team.id),c=a.include_profile_only_users&&H.is_profile_only_user;return!ee&&!c});O.length&&TS.has_pri[n]&&TS.log(n,"Flannel: removed these org members from results:",O)}if(!a.include_deleted){var Q=_.remove(P,{deleted:!0});Q.length&&TS.has_pri[n]&&TS.log(n,"Flannel: removed these deleted members from results:",Q)}if(!a.include_profile_only_users){var Y=_.remove(P,{is_profile_only_user:!0});Y.length&&TS.has_pri[n]&&TS.log(n,"Flannel: removed these profile-only users from results:",Y)}return P=_.intersectionBy(TS.members.getMembersForUser(),P,"id"),{ok:!0,data:{items:P.slice(0,m),next_cursor_mark:null,num_found:P.length,teams:[TS.model.team]},args:{query:d}}})}if(!a.query)return Promise.reject(new Error("Cannot search without a query."));var p={query:JSON.stringify(a.query)};["sort","sort_direction","count","cursor_mark","include_bots","include_deleted","exclude_slackbot","ignore_guest_accounts"].forEach(function(v){a.hasOwnProperty(v)&&(p[v]=a[v])});var S=a.endpoint;return S||(S=a.all_of_org?"search.enterprise":"search.team"),TS.interop.api.call(S,p).catch(i)}});var s=o(function(a,d,m){if(!a){TS.error("cannot make a clause without a type");return}if(!d){TS.error("cannot make a clause without a value");return}a==="custom"&&!m&&TS.error("cannot make a custom type clause without a field id")},"_validateClauseParameters"),r=o(function(a,d){if(!a){TS.error("cannot make a conjunction without an 'and' or 'or' type");return}(!d||d.length<2)&&TS.error("cannot make a conjunction without at least two clauses")},"_validateConjunctionParameters"),i=o(function(a){throw TS.error(`${a.data.error} error occured while searching`),TS.generic_dialog.alert(TS.interop.i18n.t("Sorry! Something went wrong. Please try again.","utility_search")()),a},"_handleError"),t=o(function(a,d,m,u){u=u||{};var f={query:a,count:d};u.filter&&(f.filter=u.filter);var p=TS.members.fetchAndUpsertMembersWithQuery(f);if(!m)return p;var S=_.assign({channels:[m]},f),v=TS.members.fetchAndUpsertMembersWithQuery(S);return Promise.join(p,v).then(function(P){var C=P[0],D=P[1],O=_.map(C.objects,"id"),Q=_.map(D.objects,"id"),Y={};return Q.forEach(function(H){Y[H]=!0}),_.difference(O,Q).forEach(function(H){Y[H]=!1}),TS.redux.dispatch(TS.interop.redux.models.membership.setChannelMembershipInfoForUsers({channelId:m,membershipInfo:Y})),C})},"_fetchMembersFromFlannel"),n=1989})()},1764849401:()=>{(function(){TS.registerModule("utility",{onStart:function(){TS.utility.makeRefererSafeLink=_.memoize(TS.utility.makeRefererSafeLink),TS.prefs&&TS.prefs.team_hide_referers_changed_sig&&TS.prefs.team_hide_referers_changed_sig.add(TS.utility.resetRefererSafeLinkCache),d=TS.utility.normalizeDevHost(`https://${document.location.hostname}/files`),m=TS.utility.normalizeDevHost(`https://${document.location.hostname}/team`)},keymap:{alt:18,ctrl:17,cmd_ff:224,cmd_other:91,cmd_right:93,esc:27,shift:16,tab:9,del:8,delete:46,enter:13,left:37,up:38,right:39,down:40,pageup:33,pagedown:34,end:35,home:36,space:32,semicolon:59,equals_sign:187,minus_sign:189,comma:188,period:190,left_square_bracket:219,right_square_bracket:221,V:86,a:65,e:69,b:66,k:75,i:73,z:90,y:89,insert:45,slash:191,f6:117,num_lock:144,insert_extended:96,caps_lock:20},email_regex:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,regexpEscape:function(u,f){return f=Math.min(f||5e5,5e5),u.length>f&&(u=u.slice(0,f)),_.escapeRegExp(u)},makeComparableVersion:function(u){var f=u.split("-")[0];return _.reduce(f.split("."),function(p,S){return p*1e3+parseInt(S,10)},0)},compareSemanticVersions:function(u,f){var p=TS.utility.makeComparableVersion(u),S=TS.utility.makeComparableVersion(f);return p===S?0:p>S?1:-1},doesRectContainRect:function(u,f,p,S){return p=p||0,f.top<u.top-p||f.bottom>u.bottom+p?!1:S?!0:!(f.left<u.left-p||f.right>u.right+p)},shouldLinksHaveTargets:function(){return!1},parseJSONOrElse:function(u,f){if(u==="")return f;try{return JSON.parse(u)}catch{return f}},removeUrlParam:function(u,f){var p=f.split("?")[0],S=f.indexOf("?")!==-1?f.split("?")[1]:"",v=[],P;if(S!==""){v=S.split("&");for(var C=v.length-1;C>=0;C-=1)P=v[C].split("=")[0],P===u&&v.splice(C,1);p=v.length?`${p}?${v.join("&")}`:p}return p},getPathFromSlackUrl:function(u){var f=u.match(a),p=f&&f[2];if(p){var S=u.split(p),v=S[1].split("?")[0];return(p+v).split("/")}},getAppliedClasses:function(u){return _.reduce(u,function(f,p,S){return p&&f.push(S),f},[]).join(" ")},numberWithK:function(u){return u>999?(u=Math.round(u/1e3*10)/10,`${TS.interop.i18n.number(u)||""}K`):TS.interop.i18n.number(u)||""},openInNewTab:function(u,f){let{dontEncodeHash:p=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(u.indexOf("/")===0&&TS.boot_data.team_url){var S=TS.boot_data.team_url;S=S.substr(0,S.length-1),u=S+u}var v=u,P="",C=v.indexOf("?"),D=TS.interop.utility.urlNeedsRefererHiding(u);if(C!==-1){D&&(u=_.escape(u.substring(0,C)));var O=v.substring(C+1,v.length);if(v=v.substring(0,C),O.length){var Q=TS.interop.url.queryStringParse(O),Y=TS.interop.url.parseUrl(u),H=!1;Y&&Y.hostname=="accounts.google.com"&&Y.pathname=="/o/oauth2/auth"&&(H=!0),_.forEach(Q,function(F,ee){D?(u=TS.interop.url.setUrlQueryStringValue(u,ee,F||"",H),p&&(u=u.replace("%23","#"))):P+=`<input type="hidden" name="${_.escape(ee)}" value="${_.escape(F||"")}">`})}}D&&(P=`<input type="hidden" name="url" value="${_.escape(u)}">`,v=`https://${TS.boot_data.redir_domain}/link`),$(`<form>${P}</form>`).attr({method:"GET",action:v,target:f}).appendTo("body").submit().remove()},isScalar:function(u){return/boolean|number|string/.test(typeof u)},sanitizeHTML:function(u,f,p,S){var v=o(function(O){var Q=O.tagName.toLowerCase();return f.indexOf(Q)<0?null:(Array.prototype.slice.apply(O.attributes).forEach(function(Y){p.indexOf(Y.name)<0&&O.attributes.removeNamedItem(Y.name)}),Array.prototype.slice.apply(O.children).forEach(function(Y){var H=v(Y);H||O.removeChild(Y)}),O)},"_sanitizeNode");s=s||new DOMParser;var P=s.parseFromString(u,"text/html")||s.parseFromString(u,"text/xml"),C=P.body;if(C.children.length!=1)return"";var D=v(C.children[0]);return C=null,P=null,D?S?D:D.outerHTML:""},getChildTextNodes:function(u){var f=[];if(!u)return f;if(u instanceof Text)return f.push(u),f;for(var p=document.createTreeWalker(u,NodeFilter.SHOW_TEXT,null,!1),S=p.nextNode();S;)f.push(S),S=p.nextNode();return f},linkify:function(u,f,p,S){return u&&(u=u.replace(TS.interop.url.URL_REGEXP,function(v){var P;if(v.toLowerCase().indexOf("www.")===0){if(!p)return v;P=`http://${v}`}else P=v;return S?`<${P}|${v}>`:`<a ${TS.utility.makeRefererSafeLink(P)} target="${f||""}">${v}</a>`}),u)},getActiveElementProp:function(u){return document.activeElement?u==="NODENAME"?document.activeElement.nodeName?document.activeElement.nodeName.toUpperCase():"":document.activeElement[u]:""},isTabCompleteShowing:function(){return!!$("#chat_input_tab_ui").length},referer_safe_url_map:{},makeRefererSafeLink:function(u){if(typeof u!="string"){TS.error(`Expected url to be a string, got: ${typeof u}`);return}u=u.replace(/\ue000/g,"").replace(/\ue001/g,""),n(u);var f=u.replace(/&amp;/g,"&");f.match(/javascript(:|&colon;)/gi)&&(f="#");var p=!0,S=TS.utility.sanitizeHTML(`<a href="${f}"></a>`,["a"],["href"],p)||null;S&&(f=S.href),f=_.escape(f).replace(/&amp;/g,"&").replace(/(%27|&#39;)/g,"'"),u&&u.lastIndexOf("/")!==u.length-1&&f&&f.lastIndexOf("/")===f.length-1&&(f=f.slice(0,-1)),f=f||"#";var v=`href="${f}"`,P="onclick",C=TS.interop.utility.getRefererPolicy();if((!TS.model||!TS.model.is_our_app)&&C&&C.rewrite_on_right_click&&(P="onmousedown"),!TS.interop.utility.urlNeedsRefererHiding(u))return v;if(TS.utility.externalURLsNeedRedirecting()){var D=encodeURIComponent(f),O=`https://${TS.boot_data.redir_domain}/link?url=${D}${C&&C.redirect_type?`&v=${C.redirect_type}`:""}`,Q=`url-${Math.random()}-${performance.now()}`;TS.utility.referer_safe_url_map[Q]=f,v+=` data-referer-safe="1" ${P}="this.href=&quot;${O}&quot;" onmouseover="this.href=TS.utility.referer_safe_url_map[&quot;${Q}&quot;]" data-referer-original-href="${f}" rel="noreferrer"`}else v+=' rel="noreferrer"';return v},resetRefererSafeLinkCache:function(){TS.utility.makeRefererSafeLink&&TS.utility.makeRefererSafeLink.cache&&TS.utility.makeRefererSafeLink.cache.clear()},makeSureAllExternalLinksAreRefererSafe:function(u){var f=[];TS.utility.externalURLsNeedRedirecting()?u.find("a[href]:not([data-referer-safe])").each(function(){var p=$(this),S=p.attr("href");if(TS.interop.utility.urlNeedsRefererHiding(S)){f.push(this.outerHTML),p.removeAttr("href");var v=this.outerHTML.replace("<a",function(){return`<a ${TS.utility.makeRefererSafeLink(S)} `});p.replaceWith(v),f[f.length-1]+=`
->
${v}`}}):u.find("a[href]:not([rel])").each(function(){var p=$(this),S=p.attr("href");S.indexOf("mailto")===0||S.indexOf("skype")===0||(S&&S!=="#"?TS.interop.utility.urlNeedsRefererHiding(S)&&(f.push(this.outerHTML),p.attr("rel","noreferrer"),f[f.length-1]+=`
->
${this.outerHTML}`):p.removeAttr("href"))})},sortTable:function(u,f,p,S,v){p=p==="desc"?"desc":"asc",v=v==="desc"?"desc":"asc";function P(Q){return function(Y,H){var F=C(Y,Q),ee=C(H,Q);return $.isNumeric(F)&&$.isNumeric(ee)?F==ee&&S?(F=C(Y,S),ee=C(H,S),$.isNumeric(F)&&$.isNumeric(ee)?v!=p?ee-F:F-ee:v!=p?TS.interop.i18n.sorter(ee,F):TS.interop.i18n.sorter(F,ee)):F-ee:TS.interop.i18n.sorter(F,ee)}}o(P,"sortFunc");function C(Q,Y){return $(Q).children("td").eq(Y).attr("data-sort-val")}o(C,"getCellValue");var D=u.find("tr:gt(0)").toArray().sort(P(f));p==="desc"&&(D=D.reverse());for(var O=0;O<D.length;O+=1)u.append(D[O])},getPercSmartly:function(u,f){if(!u||!f)return"0%";var p=u/f*100;return p!=100&&Math.round(p)==100?"99%":p<.7?"<1%":`${Math.round(p)}%`},hex2rgb:function(u){var f=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(u);return f?{r:parseInt(f[1],16),g:parseInt(f[2],16),b:parseInt(f[3],16)}:void 0},setImmediate:function(u){r(u)},debounce:function(u,f){var p;return function(){var S=this,v=arguments;clearTimeout(p),p=setTimeout(function(){u.apply(S,v)},f)}},debounceWithPromise:function(u,f){var p;return function(){var S=this,v=arguments;return p&&p.cancel(),p=new Promise(function(P){setTimeout(P,f)}).then(function(){return u.apply(S,v)}),p}},throttleFunc:function(u,f,p){var S={},v=o(function P(){var C=Array.prototype.slice.apply(arguments),D=_.some(C,_.isObject);D&&TS.error("You're passing non-scalar arguments to a function throttled with TS.utility.throttleFunc; it will likely not work as you want");var O=`f-${C.join("-")}`;if(S[O]&&S[O].context!==this)throw new Error(`Cannot use this function with different \`this\` contexts across different calls ${this} ${S[O].context}`);S[O]=S[O]||{requested:Date.now(),timeout:0,context:this},S[O].timeout||P.always_wait?S[O].requested=Date.now():u.apply(S[O].context,C),!S[O].timeout&&(S[O].timeout=setTimeout(o(function Q(){var Y=Date.now()-S[O].requested;Y>=f?(u.apply(S[O].context,C),delete S[O]):S[O].timeout=setTimeout(Q,f-Y)},"timerFunc"),f))},"funcReplacement");return v.always_wait=!!p,v},throttle:function(){var u,f;u={delay:200,timer_group:"generic"},f={timers:{},queues:{}};function p(v){var P,C;if(f.timers[v]){if(f.queues[v])for(P=0,C=f.queues[v].length;P<C;P+=1)f.queues[v][P]&&f.queues[v][P]();f.queues[v]=null,f.timers[v]=null}}o(p,"processQueue");function S(v,P,C){if(!v)return!1;P=P||u.timer_group,f.timers[P]||(C=C||u.delay,f.timers[P]=window.setTimeout(function(){p(P)},C)),f.queues[P]||(f.queues[P]=[]),f.queues[P].indexOf?f.queues[P].indexOf(v)===-1&&f.queues[P].push(v):f.queues[P].push(v)}return o(S,"method"),{method:S}}(),getImgProxyURL:function(u,f,p){return TS.utility.getImgProxyURLWithOptions(u,{width:f,height:p})},getImgProxyURLWithOptions:function(u){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return u&&TS.interop.utility.getImgProxyUrl({url:u,height:f.height,width:f.width,rotate:f.rotate,renderSvg:f.render_svg,stopAnimations:f.stop_animations,emoji:f.emoji,convertIco:f.convert_ico})},rAF:function(){var u=["ms","moz","webkit","o"],f=window.requestAnimationFrame,p;for(p=0;p<u.length&&!f;p+=1)f=window[`${u[p]}RequestAnimationFrame`];if(!f){var S=0;return function(v){var P=Date.now(),C=Math.max(0,16-(P-S)),D=window.setTimeout(function(){v(P+C)},C);return S=P+C,D}}return function(v){return f.call(window,v)}}(),getLocationHashString:function(u){u=u||document;var f=u.location.hash;return f&&f.length?f.substr(1):f},externalURLsNeedRedirecting:function(){return!!(TS.model.team&&TS.prefs.getTeamPref("hide_referers")&&!TS.model.is_our_app)},isArrowKey:function(u){var f=TS.utility.keymap;return u==f.down||u==f.up||u==f.right||u==f.left},normalizeDevHost:function(u){return u.replace(/\.dev[0-9]*.slack.com/i,".dev.slack.com").replace(/\.staging.slack.com/i,".slack.com").replace(/\.staging-master.slack.com/i,".slack.com").replace(/\.staging-sandbox.slack.com/i,".slack.com")},areSimpleObjectsEqual:o(function u(f,p){if(f===p)return!0;if(f===void 0&&p||p===void 0&&f||typeof f!=typeof p||f===null&&p||p===null&&f||f.length!==p.length)return!1;var S;for(S in p){if(typeof f[S]>"u"&&typeof p[S]<"u")return!1;if(p[S])switch(typeof p[S]){case"object":if(!u(f[S],p[S]))return!1;break;case"function":if(String(p[S])!=String(f[S]))return!1;break;default:if(p[S]!==f[S])return!1}else if(f[S])return!1}for(S in f)if(typeof p[S]>"u"&&typeof f[S]<"u")return!1;return!0},"recurse"),deepDiffObjects:function(u,f){if(_.isEmpty(u))return{};if(_.isEmpty(f))return u;var p={};return _.each(u,function(S,v){var P=f[v];if(P!==S)if(typeof S!=typeof P)p[v]=S;else if(_.isArray(S))p[v]=_.difference(S,P);else if(_.isPlainObject(S)){var C=TS.utility.deepDiffObjects(S,P);_.isEmpty(C)||(p[v]=C)}else p[v]=S}),p},makeWebWorker:function(u,f){var p=URL.createObjectURL(new Blob(["(",u,")()"],{type:"application/javascript"})),S=new Worker(p);return URL.revokeObjectURL(p),S.onmessage=f,S},truncateToNearestWordBoundary:function(u,f){if(u.string&&(u=u.string),u.length<=f)return u;var p="\u2026",S=u.substring(0,f),v=S.lastIndexOf(" ");return v>0&&v>f-15?S.substring(0,v)+p:S.substring(0,S.length-1)+p},getCachedScript:function(u,f){return f=$.extend(f||{},{dataType:"script",cache:!0,url:u}),jQuery.ajax(f)},disableElement:function(u,f){u=$(u),u.attr("disabled",f),u.attr("aria-disabled",f)},enableFeatureForUser:function(u){return u<0||u>100?(TS.warn("TS.utility.enableFeatureForUser() expects a number between 0 and 100"),!1):_.random(0,100)<u},roundToThree:function(u){return+`${Math.round(`${u}e+3`)}e-3`},exampleEmailAddress:function(u){return u==="you"?TS.interop.i18n.t("you@{example_com}","utility")({example_com:"example.com"}):TS.interop.i18n.t("name@{example_com}","utility")({example_com:"example.com"})},test:function(){var u={};return Object.defineProperty(u,"_files_url",{get:function(){return d},set:function(f){d=f}}),Object.defineProperty(u,"_team_url",{get:function(){return m},set:function(f){m=f}}),u}});var s,r=window.setImmediate;if(!r)if(window.MutationObserver){var i=document.createElement("div"),t=[];new MutationObserver(function(){var u=t.slice();t.length=0,u.forEach(function(f){f()})}).observe(i,{attributes:!0}),r=o(function(u){t.length||i.setAttribute("yes","no"),t.push(u)},"_set_immediate_fn")}else r=o(function(u){setTimeout(u,0)},"_set_immediate_fn");var n=o(function(u){var f=TS.utility.getPathFromSlackUrl(u);if(f&&f.length>1){var p={messages:!0,archives:!0}[f[0]],S=decodeURIComponent(f[1]);p&&S&&TS.interop.utility.looksLikeChannelId(S)&&!TS.interop.channels.hasChannelWithId(S)&&TS.redux.channels.getEntityById(S)}},"_fetchUnknownChannelSlackUrl"),a=/([^.:/]+)(?:\.[^.]+)?\.slack\.com\/((?:messages|archives|unreads|threads|team|page)\/)/,d=null,m=null})()},1823630129:()=>{(function(){TS.registerModule("utility.teams",{getMembersForTeam:function(s){if(_.isObject(s)&&s.id){var r=_.filter(TS.model.members,{team_id:s.id});return r}}})})()},5247437737:(s,r,i)=>{"use strict";var t=i(4260148387),n=i.n(t),a=i(9410205190),d=i.n(a),m=i(9300289889),u=i.n(m),f=i(6131426979),p=i.n(f),S=i(3706413573),v=i.n(S),P=i(3657898688),C=i.n(P),D=i(8489220238),O=i.n(D),Q=i(3404403316),Y=i.n(Q),H=i(1386085343),F=i.n(H),ee=i(4354742961),c=i.n(ee),x=i(6318582152),re=i.n(x),J=i(5790153495),te=i.n(J),q=i(638087661),ne=i.n(q),ce=i(9170865939),L=i.n(ce),z=i(1484214105),j=i.n(z),X=i(2769613328),N=i.n(X),y=i(7004812553),U=i.n(y),h=i(1496158114),w=i.n(h),R=i(603105959),E=i.n(R),B=i(1823630129),G=i.n(B),K=i(1136428304),ae=i.n(K),ue=i(5110391454),oe=i.n(ue),le=i(9331508771),ie=i.n(le),me=i(6711515563),I=i.n(me),l=i(1515948675),g=i.n(l),b=i(1182967304),M=i.n(b),Z=i(3693504700),V=i.n(Z),_e=i(3318067913),fe=i.n(_e),he=i(3251160223),ye=i.n(he),Te=i(7467123565),Be=i.n(Te),Pe=i(7410197218),Ue=i.n(Pe),Ee=i(1764849401),Ce=i.n(Ee),Me=i(7164614212),Fe=i.n(Me),xe=i(2693193630),He=i.n(xe),Ie=i(2021630798),Ne=i.n(Ie),Le=i(8200244755),We=i.n(Le),Oe=i(980335758),je=i.n(Oe),Ae=i(218669524),ze=i.n(Ae),De=i(8377622078),Ke=i.n(De),Re=i(2724016834),e=i.n(Re),T=i(5908611399),A=i.n(T),k=i(3956101715),W=i.n(k),se=i(2442635577),de=i.n(se),pe=i(8755003389),ge=i.n(pe),ve=i(4556606753),we=i.n(ve),Se=i(6940318340),$e=i.n(Se),be=i(5215436211),ke=i.n(be),Ge=i(4281234352),Qe=i.n(Ge),Ve=i(714886902),Xe=i.n(Ve),Ye=i(540370361),Ze=i.n(Ye),Je=i(4706726993),et=i.n(Je)}},s=>{var r=o(t=>s(s.s=t),"__webpack_exec__"),i=r(5247437737)}]);})();

//# sourceMappingURL=https://slack.com/source-maps/bv1-13/rollup-secondary_a_required.6eb4edc5566bb4e0219b.min.js.map